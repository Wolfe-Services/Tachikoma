{"version":3,"file":"zQag0gFB.js","sources":["../../../../../../node_modules/@sveltejs/kit/src/runtime/app/environment/index.js","../../../../../../src/lib/components/common/Icon.svelte","../../../../../../src/lib/components/ui/Spinner/Spinner.svelte","../../../../../../src/lib/components/ui/GlassPanel.svelte","../../../../../../src/lib/components/common/RelativeTime.svelte","../../../../../../src/lib/stores/persistedStore.ts","../../../../../../src/lib/ipc/errors.ts","../../../../../../src/lib/ipc/client.ts","../../../../../../src/lib/services/forgeService.ts","../../../../../../src/lib/stores/forgeSession.ts","../../../../../../src/lib/components/forge/SessionSidebar.svelte","../../../../../../src/lib/components/forge/ParticipantPanel.svelte","../../../../../../src/lib/services/deliberation.ts","../../../../../../src/lib/components/forge/DeliberationView.svelte","../../../../../../src/lib/components/forge/MainContentArea.svelte","../../../../../../src/lib/components/forge/ResultPanel.svelte","../../../../../../src/lib/components/forge/ForgeToolbar.svelte","../../../../../../src/lib/components/forge/LogPanel.svelte","../../../../../../src/lib/stores/layoutPreferences.ts","../../../../../../src/lib/components/forge/ForgeLayout.svelte","../../../../../../src/lib/services/goalRefinement.ts","../../../../../../src/lib/components/forge/GoalRefinementChat.svelte","../../../../../../src/lib/components/forge/GoalInput.svelte","../../../../../../src/lib/components/forge/ParticipantSelect.svelte","../../../../../../src/lib/components/forge/OracleConfigPanel.svelte","../../../../../../src/lib/components/forge/SessionReview.svelte","../../../../../../src/lib/components/ui/StepIndicator.svelte","../../../../../../src/lib/utils/sessionValidation.ts","../../../../../../src/lib/components/forge/SessionCreationWizard.svelte"],"sourcesContent":["import { BROWSER, DEV } from 'esm-env';\nexport { building, version } from '__sveltekit/environment';\n\nexport const browser = BROWSER;\n\nexport const dev = DEV;\n","<script lang=\"ts\">\n  export let name: string;\n  export let size: number = 20;\n  export let color: string = 'currentColor';\n  export let glow: boolean = false;\n\n  // Refined cyberpunk icons - cleaner paths for crisp rendering\n  const icons: Record<string, { path: string; viewBox?: string; strokeWidth?: number }> = {\n    // Navigation icons\n    home: {\n      path: 'M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6',\n      strokeWidth: 1.5\n    },\n    play: {\n      path: 'M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z M21 12a9 9 0 11-18 0 9 9 0 0118 0z',\n      strokeWidth: 1.5\n    },\n    'file-text': {\n      path: 'M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z',\n      strokeWidth: 1.5\n    },\n    brain: {\n      path: 'M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z',\n      strokeWidth: 1.5\n    },\n    settings: {\n      path: 'M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z M15 12a3 3 0 11-6 0 3 3 0 016 0z',\n      strokeWidth: 1.5\n    },\n    \n    // Status & UI icons\n    check: {\n      path: 'M5 13l4 4L19 7',\n      strokeWidth: 2\n    },\n    'check-circle': {\n      path: 'M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z',\n      strokeWidth: 1.5\n    },\n    x: {\n      path: 'M6 18L18 6M6 6l12 12',\n      strokeWidth: 2\n    },\n    'x-circle': {\n      path: 'M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z',\n      strokeWidth: 1.5\n    },\n    'alert-triangle': {\n      path: 'M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z',\n      strokeWidth: 1.5\n    },\n    'alert-circle': {\n      path: 'M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z',\n      strokeWidth: 1.5\n    },\n    info: {\n      path: 'M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z',\n      strokeWidth: 1.5\n    },\n    \n    // Navigation arrows\n    'chevron-up': {\n      path: 'M5 15l7-7 7 7',\n      strokeWidth: 2\n    },\n    'chevron-down': {\n      path: 'M19 9l-7 7-7-7',\n      strokeWidth: 2\n    },\n    'chevron-right': {\n      path: 'M9 5l7 7-7 7',\n      strokeWidth: 2\n    },\n    'chevron-left': {\n      path: 'M15 19l-7-7 7-7',\n      strokeWidth: 2\n    },\n    'arrow-right': {\n      path: 'M14 5l7 7m0 0l-7 7m7-7H3',\n      strokeWidth: 2\n    },\n    'arrow-left': {\n      path: 'M10 19l-7-7m0 0l7-7m-7 7h18',\n      strokeWidth: 2\n    },\n    \n    // Actions\n    search: {\n      path: 'M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z',\n      strokeWidth: 1.5\n    },\n    'refresh-cw': {\n      path: 'M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15',\n      strokeWidth: 1.5\n    },\n    loader: {\n      path: 'M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z',\n      strokeWidth: 1.5\n    },\n    \n    // User & system\n    user: {\n      path: 'M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z',\n      strokeWidth: 1.5\n    },\n    users: {\n      path: 'M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z',\n      strokeWidth: 1.5\n    },\n    bell: {\n      path: 'M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9',\n      strokeWidth: 1.5\n    },\n    'help-circle': {\n      path: 'M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z',\n      strokeWidth: 1.5\n    },\n    \n    // Tachikoma-specific\n    target: {\n      path: 'M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z',\n      strokeWidth: 1.5\n    },\n    zap: {\n      path: 'M13 10V3L4 14h7v7l9-11h-7z',\n      strokeWidth: 1.5\n    },\n    activity: {\n      path: 'M22 12h-4l-3 9L9 3l-3 9H2',\n      strokeWidth: 1.5\n    },\n    cpu: {\n      path: 'M9 3v2m6-2v2M9 19v2m6-2v2M3 9h2m14 0h2M3 14h2m14 0h2M6 6h12v12H6z',\n      strokeWidth: 1.5\n    },\n    terminal: {\n      path: 'M8 9l3 3-3 3m5 0h3M5 20h14a2 2 0 002-2V6a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z',\n      strokeWidth: 1.5\n    },\n    code: {\n      path: 'M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4',\n      strokeWidth: 1.5\n    },\n    database: {\n      path: 'M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4m0 5c0 2.21-3.582 4-8 4s-8-1.79-8-4',\n      strokeWidth: 1.5\n    },\n    \n    // Trending\n    'trending-up': {\n      path: 'M13 7h8m0 0v8m0-8l-8 8-4-4-6 6',\n      strokeWidth: 1.5\n    },\n    'trending-down': {\n      path: 'M13 17h8m0 0V9m0 8l-8-8-4 4-6-6',\n      strokeWidth: 1.5\n    },\n    minus: {\n      path: 'M20 12H4',\n      strokeWidth: 2\n    },\n    plus: {\n      path: 'M12 4v16m8-8H4',\n      strokeWidth: 2\n    },\n    \n    // Media\n    'play-circle': {\n      path: 'M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z M21 12a9 9 0 11-18 0 9 9 0 0118 0z',\n      strokeWidth: 1.5\n    },\n    'pause-circle': {\n      path: 'M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z',\n      strokeWidth: 1.5\n    },\n    'stop-circle': {\n      path: 'M21 12a9 9 0 11-18 0 9 9 0 0118 0z M9 10a1 1 0 011-1h4a1 1 0 011 1v4a1 1 0 01-1 1h-4a1 1 0 01-1-1v-4z',\n      strokeWidth: 1.5\n    },\n    \n    // Files & docs\n    folder: {\n      path: 'M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z',\n      strokeWidth: 1.5\n    },\n    'folder-open': {\n      path: 'M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z',\n      strokeWidth: 1.5\n    },\n    file: {\n      path: 'M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z',\n      strokeWidth: 1.5\n    },\n    'file-plus': {\n      path: 'M9 13h6m-3-3v6m5 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z',\n      strokeWidth: 1.5\n    },\n    \n    // Misc\n    eye: {\n      path: 'M15 12a3 3 0 11-6 0 3 3 0 016 0z M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z',\n      strokeWidth: 1.5\n    },\n    'eye-off': {\n      path: 'M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21',\n      strokeWidth: 1.5\n    },\n    clock: {\n      path: 'M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z',\n      strokeWidth: 1.5\n    },\n    calendar: {\n      path: 'M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z',\n      strokeWidth: 1.5\n    },\n    link: {\n      path: 'M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1',\n      strokeWidth: 1.5\n    },\n    upload: {\n      path: 'M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12',\n      strokeWidth: 1.5\n    },\n    download: {\n      path: 'M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4',\n      strokeWidth: 1.5\n    },\n    trash: {\n      path: 'M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16',\n      strokeWidth: 1.5\n    },\n    edit: {\n      path: 'M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z',\n      strokeWidth: 1.5\n    },\n    copy: {\n      path: 'M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z',\n      strokeWidth: 1.5\n    },\n    save: {\n      path: 'M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4',\n      strokeWidth: 1.5\n    },\n    menu: {\n      path: 'M4 6h16M4 12h16M4 18h16',\n      strokeWidth: 2\n    },\n    'more-horizontal': {\n      path: 'M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z',\n      strokeWidth: 1.5\n    },\n    'more-vertical': {\n      path: 'M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z',\n      strokeWidth: 1.5\n    },\n    \n    // GITS-specific icons\n    'neural-link': {\n      path: 'M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m3-8.803a4 4 0 11-8 0 4 4 0 018 0z M17 8l4 4m0-4l-4 4',\n      strokeWidth: 1.5\n    },\n    'cyber-eye': {\n      path: 'M15 12a3 3 0 11-6 0 3 3 0 016 0z M12 5c-4.478 0-8.268 2.943-9.542 7 1.274 4.057 5.064 7 9.542 7s8.268-2.943 9.542-7c-1.274-4.057-5.064-7-9.542-7z M12 12h.01',\n      strokeWidth: 1.5\n    },\n    robot: {\n      path: 'M9 3v2m6-2v2M12 21a9 9 0 110-18 9 9 0 010 18zM9 10h.01M15 10h.01M9 15a3 3 0 006 0',\n      strokeWidth: 1.5\n    },\n    globe: {\n      path: 'M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9',\n      strokeWidth: 1.5\n    },\n    shield: {\n      path: 'M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z',\n      strokeWidth: 1.5\n    },\n    'shield-check': {\n      path: 'M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z',\n      strokeWidth: 1.5\n    }\n  };\n\n  $: iconData = icons[name] || { path: '', strokeWidth: 1.5 };\n</script>\n\n<svg\n  width={size}\n  height={size}\n  viewBox=\"0 0 24 24\"\n  fill=\"none\"\n  stroke={color}\n  stroke-width={iconData.strokeWidth || 1.5}\n  stroke-linecap=\"round\"\n  stroke-linejoin=\"round\"\n  aria-hidden=\"true\"\n  class=\"icon\"\n  class:glow\n>\n  {#if iconData.path}\n    <path d={iconData.path} />\n  {/if}\n</svg>\n\n<style>\n  .icon {\n    flex-shrink: 0;\n    transition: all 0.2s ease;\n  }\n  \n  .glow {\n    filter: drop-shadow(0 0 4px var(--tachi-cyan-glow, rgba(78, 205, 196, 0.4)));\n  }\n  \n  .icon:hover {\n    filter: drop-shadow(0 0 6px var(--tachi-cyan-glow, rgba(78, 205, 196, 0.4)));\n  }\n</style>\n","<script lang=\"ts\">\n  export let size: number = 20;\n  export let color: string = 'currentColor';\n</script>\n\n<svg\n  class=\"spinner\"\n  width={size}\n  height={size}\n  viewBox=\"0 0 24 24\"\n  fill=\"none\"\n  xmlns=\"http://www.w3.org/2000/svg\"\n  aria-hidden=\"true\"\n>\n  <circle\n    class=\"spinner-track\"\n    cx=\"12\"\n    cy=\"12\"\n    r=\"10\"\n    stroke={color}\n    stroke-width=\"3\"\n    stroke-linecap=\"round\"\n  />\n  <circle\n    class=\"spinner-head\"\n    cx=\"12\"\n    cy=\"12\"\n    r=\"10\"\n    stroke={color}\n    stroke-width=\"3\"\n    stroke-linecap=\"round\"\n  />\n</svg>\n\n<style>\n  .spinner {\n    animation: spin 1s linear infinite;\n  }\n\n  .spinner-track {\n    opacity: 0.2;\n  }\n\n  .spinner-head {\n    stroke-dasharray: 60;\n    stroke-dashoffset: 45;\n    transform-origin: center;\n  }\n\n  @keyframes spin {\n    from {\n      transform: rotate(0deg);\n    }\n    to {\n      transform: rotate(360deg);\n    }\n  }\n</style>","<script lang=\"ts\">\n  export let as: keyof HTMLElementTagNameMap = 'section';\n  export let padded: boolean = true;\n  export let subtle: boolean = false;\n  export let accent: 'cyan' | 'red' | 'yellow' | 'green' | 'blue' | 'purple' | 'none' = 'cyan';\n  export let className: string = '';\n\n  const accents = {\n    cyan: 'var(--tachi-cyan, #4ecdc4)',\n    red: 'var(--tachi-red, #ff6b6b)',\n    yellow: 'var(--tachi-yellow, #ffd93d)',\n    green: 'var(--success-color, #3fb950)',\n    blue: 'var(--info-color, #58a6ff)',\n    purple: 'var(--color-accent, #8b5cf6)',\n    none: 'transparent'\n  } as const;\n\n  $: accentColor = accents[accent];\n</script>\n\n<svelte:element\n  this={as}\n  class={`glass-panel ${subtle ? 'subtle' : ''} ${padded ? 'padded' : ''} ${className}`.trim()}\n  style={`--glass-accent: ${accentColor};`}\n  {...$$restProps}\n>\n  <slot />\n</svelte:element>\n\n<style>\n  .glass-panel {\n    position: relative;\n    overflow: hidden;\n    border-radius: 16px;\n\n    /* Polyglass base */\n    background:\n      linear-gradient(135deg, rgba(255, 255, 255, 0.06), rgba(255, 255, 255, 0.015)),\n      rgba(22, 27, 34, 0.6);\n    border: 1px solid color-mix(in srgb, var(--glass-accent) 35%, rgba(78, 205, 196, 0.1));\n    box-shadow:\n      0 0 0 1px rgba(0, 0, 0, 0.35) inset,\n      0 10px 40px rgba(0, 0, 0, 0.35),\n      0 0 30px color-mix(in srgb, var(--glass-accent) 18%, transparent);\n\n    -webkit-backdrop-filter: blur(14px) saturate(1.25);\n    backdrop-filter: blur(14px) saturate(1.25);\n  }\n\n  .glass-panel.subtle {\n    background:\n      linear-gradient(135deg, rgba(255, 255, 255, 0.04), rgba(255, 255, 255, 0.01)),\n      rgba(13, 17, 23, 0.45);\n    border-color: rgba(78, 205, 196, 0.12);\n    box-shadow:\n      0 0 0 1px rgba(0, 0, 0, 0.35) inset,\n      0 10px 30px rgba(0, 0, 0, 0.25);\n  }\n\n  .glass-panel.padded {\n    padding: 1.25rem;\n  }\n\n  /* Top accent line */\n  .glass-panel::before {\n    content: '';\n    position: absolute;\n    left: 0;\n    right: 0;\n    top: 0;\n    height: 2px;\n    background: linear-gradient(90deg, transparent, var(--glass-accent), transparent);\n    opacity: 0.55;\n    pointer-events: none;\n  }\n\n  /* Polyglass polygon shimmer */\n  .glass-panel::after {\n    content: '';\n    position: absolute;\n    inset: -40% -20%;\n    background:\n      linear-gradient(\n        115deg,\n        transparent 0%,\n        color-mix(in srgb, var(--glass-accent) 18%, transparent) 35%,\n        rgba(255, 255, 255, 0.06) 50%,\n        transparent 65%\n      );\n    clip-path: polygon(0 10%, 60% 0, 100% 45%, 70% 100%, 10% 80%);\n    transform: translate3d(-10%, -8%, 0) rotate(-6deg);\n    opacity: 0.6;\n    pointer-events: none;\n    filter: blur(0.5px);\n    animation: glassSheen 12s linear infinite;\n  }\n\n  @keyframes glassSheen {\n    0% {\n      transform: translate3d(-14%, -10%, 0) rotate(-6deg);\n      opacity: 0.35;\n    }\n    50% {\n      transform: translate3d(4%, 2%, 0) rotate(-6deg);\n      opacity: 0.75;\n    }\n    100% {\n      transform: translate3d(18%, 10%, 0) rotate(-6deg);\n      opacity: 0.35;\n    }\n  }\n</style>\n\n","<script lang=\"ts\">\n  import { onMount } from 'svelte';\n\n  export let date: Date | string;\n  export let updateInterval: number = 60000; // Update every minute\n\n  let relativeTime = '';\n\n  function formatRelativeTime(date: Date): string {\n    const now = new Date();\n    const diff = now.getTime() - date.getTime();\n    const seconds = Math.floor(diff / 1000);\n    const minutes = Math.floor(seconds / 60);\n    const hours = Math.floor(minutes / 60);\n    const days = Math.floor(hours / 24);\n\n    if (seconds < 60) return 'just now';\n    if (minutes < 60) return `${minutes}m ago`;\n    if (hours < 24) return `${hours}h ago`;\n    if (days < 7) return `${days}d ago`;\n    \n    return date.toLocaleDateString();\n  }\n\n  function updateTime() {\n    const dateObj = date instanceof Date ? date : new Date(date);\n    relativeTime = formatRelativeTime(dateObj);\n  }\n\n  onMount(() => {\n    updateTime();\n    const interval = setInterval(updateTime, updateInterval);\n    return () => clearInterval(interval);\n  });\n\n  $: if (date) updateTime();\n</script>\n\n<time datetime={date instanceof Date ? date.toISOString() : date} {...$$restProps}>\n  {relativeTime}\n</time>","import { writable, type Writable } from 'svelte/store';\nimport { browser } from '$app/environment';\n\nexport interface PersistedStoreOptions<T> {\n  key: string;\n  storage?: 'localStorage' | 'sessionStorage';\n  serialize?: (value: T) => string;\n  deserialize?: (value: string) => T;\n  validate?: (value: unknown) => value is T;\n  migrate?: (oldValue: unknown, version: number) => T;\n  version?: number;\n}\n\nexport function createPersistedStore<T>(\n  initialValue: T,\n  options: PersistedStoreOptions<T>\n): Writable<T> {\n  const {\n    key,\n    storage = 'localStorage',\n    serialize = JSON.stringify,\n    deserialize = JSON.parse,\n    validate,\n    migrate,\n    version = 1\n  } = options;\n\n  const storageKey = `tachikoma:${key}`;\n  const versionKey = `${storageKey}:version`;\n\n  function getStoredValue(): T {\n    if (!browser) return initialValue;\n\n    try {\n      const storageApi = storage === 'localStorage' ? localStorage : sessionStorage;\n      const storedValue = storageApi.getItem(storageKey);\n      const storedVersion = parseInt(storageApi.getItem(versionKey) || '0', 10);\n\n      if (storedValue === null) {\n        return initialValue;\n      }\n\n      let parsed = deserialize(storedValue);\n\n      // Migration\n      if (migrate && storedVersion < version) {\n        parsed = migrate(parsed, storedVersion);\n        storageApi.setItem(versionKey, version.toString());\n        storageApi.setItem(storageKey, serialize(parsed));\n      }\n\n      // Validation\n      if (validate && !validate(parsed)) {\n        console.warn(`Invalid stored value for ${key}, using initial value`);\n        return initialValue;\n      }\n\n      return parsed;\n    } catch (error) {\n      console.error(`Error reading persisted store ${key}:`, error);\n      return initialValue;\n    }\n  }\n\n  const store = writable<T>(getStoredValue());\n\n  if (browser) {\n    store.subscribe(value => {\n      try {\n        const storageApi = storage === 'localStorage' ? localStorage : sessionStorage;\n        storageApi.setItem(storageKey, serialize(value));\n        storageApi.setItem(versionKey, version.toString());\n      } catch (error) {\n        console.error(`Error persisting store ${key}:`, error);\n      }\n    });\n\n    // Listen for storage changes from other tabs\n    window.addEventListener('storage', (event) => {\n      if (event.key === storageKey && event.newValue !== null) {\n        try {\n          const newValue = deserialize(event.newValue);\n          if (!validate || validate(newValue)) {\n            store.set(newValue);\n          }\n        } catch {\n          // Ignore invalid values\n        }\n      }\n    });\n  }\n\n  return store;\n}","export class IpcError extends Error {\n  constructor(\n    message: string,\n    public channel: string,\n    public originalError?: unknown\n  ) {\n    super(message);\n    this.name = 'IpcError';\n  }\n}\n\nexport function handleIpcError(channel: string, error: unknown): IpcError {\n  const message = error instanceof Error ? error.message : String(error);\n  console.error(`IPC Error on channel '${channel}':`, error);\n  return new IpcError(`IPC call failed: ${message}`, channel, error);\n}\n\nexport function isIpcAvailable(): boolean {\n  return typeof window !== 'undefined' && !!window.tachikoma;\n}","import type { IpcChannels, IpcEvents } from './types';\nimport { handleIpcError, isIpcAvailable } from './errors';\n\nclass TachikomaIpc {\n  private listeners = new Map<string, Set<Function>>();\n\n  async invoke<K extends keyof IpcChannels>(\n    channel: K,\n    request: IpcChannels[K]['request']\n  ): Promise<IpcChannels[K]['response']> {\n    if (!isIpcAvailable()) {\n      throw new Error('Tachikoma IPC not available');\n    }\n    const api = window.tachikoma;\n    if (!api) {\n      throw new Error('Tachikoma IPC not available');\n    }\n    \n    try {\n      return api.invoke(channel, request) as Promise<IpcChannels[K]['response']>;\n    } catch (error) {\n      throw handleIpcError(channel, error);\n    }\n  }\n\n  on<K extends keyof IpcEvents>(\n    channel: K,\n    callback: (data: IpcEvents[K]) => void\n  ): () => void {\n    if (!isIpcAvailable()) {\n      return () => {};\n    }\n    const api = window.tachikoma;\n    if (!api) {\n      return () => {};\n    }\n\n    if (!this.listeners.has(channel)) {\n      this.listeners.set(channel, new Set());\n    }\n    this.listeners.get(channel)!.add(callback);\n\n    api.on(channel, callback as any);\n\n    // Return unsubscribe function\n    return () => {\n      this.listeners.get(channel)?.delete(callback);\n      api.off(channel, callback as any);\n    };\n  }\n}\n\nexport const ipc = new TachikomaIpc();","/**\n * Forge Service - Unified API for forge operations\n * \n * This service provides a clean interface for forge functionality,\n * using IPC when available (in Electron) or mock mode for development.\n */\n\nimport { writable, get } from 'svelte/store';\nimport { ipc } from '$lib/ipc/client';\nimport { isIpcAvailable } from '$lib/ipc/errors';\nimport type { \n  ForgeSessionRequest, \n  ForgeSessionResponse, \n  ForgePhase,\n  ForgeOutputRequest,\n  ForgeOutputResponse,\n  ForgeMessageEvent\n} from '$lib/ipc/types';\nimport type { ForgeSession, Participant, SessionPhase } from '$lib/types/forge';\n\n// Re-export types for convenience\nexport type { ForgeOutputFormat, ForgeOutputRequest, ForgeOutputResponse } from '$lib/ipc/types';\n\n// Service state\nexport interface ForgeServiceState {\n  isConnected: boolean;\n  useMockMode: boolean;\n  activeSessionId: string | null;\n  isDeliberating: boolean;\n  currentPhase: ForgePhase;\n  error: string | null;\n}\n\nconst initialState: ForgeServiceState = {\n  isConnected: false,\n  useMockMode: true,\n  activeSessionId: null,\n  isDeliberating: false,\n  currentPhase: 'idle',\n  error: null\n};\n\nfunction createForgeService() {\n  const state = writable<ForgeServiceState>(initialState);\n  const messages = writable<ForgeMessageEvent[]>([]);\n  \n  // Check IPC availability on init\n  const ipcAvailable = isIpcAvailable();\n  if (ipcAvailable) {\n    state.update(s => ({ ...s, isConnected: true, useMockMode: false }));\n    \n    // Set up event listeners for streaming messages\n    setupEventListeners();\n  }\n\n  function setupEventListeners() {\n    // Listen for forge events from main process\n    ipc.on('forge:message', (event) => {\n      messages.update(msgs => {\n        const existingIndex = msgs.findIndex(m => m.messageId === event.messageId);\n        if (existingIndex >= 0) {\n          // Update existing message (for streaming)\n          const updated = [...msgs];\n          updated[existingIndex] = event;\n          return updated;\n        } else {\n          // Add new message\n          return [...msgs, event];\n        }\n      });\n    });\n\n    ipc.on('forge:phaseChange', (event) => {\n      state.update(s => ({ ...s, currentPhase: event.phase }));\n    });\n\n    ipc.on('forge:roundComplete', (_event) => {\n      // For now, a round completion means the active stream has finished.\n      // (When we support multi-round runs, we can keep isDeliberating true.)\n      state.update(s => ({ ...s, isDeliberating: false }));\n    });\n\n    ipc.on('forge:convergence', (_event) => {\n      state.update(s => ({ ...s, isDeliberating: false }));\n    });\n\n    ipc.on('forge:error', (event) => {\n      state.update(s => ({ ...s, error: event.error, isDeliberating: false }));\n    });\n  }\n\n  // Convert frontend types to IPC request format\n  function toSessionRequest(session: Partial<ForgeSession>): ForgeSessionRequest {\n    return {\n      name: session.name || 'Untitled Session',\n      goal: session.goal || '',\n      participants: (session.participants || []).map(p => ({\n        id: p.id,\n        name: p.name,\n        type: p.type,\n        role: p.role,\n        modelId: p.type === 'ai' ? (p.modelId || getModelId(p)) : undefined,\n        status: p.status\n      })),\n      oracle: session.oracle ? {\n        id: session.oracle.id,\n        name: session.oracle.name,\n        modelId: session.oracle.type,\n        config: session.oracle.config\n      } : null,\n      config: {\n        maxRounds: session.config?.maxRounds || 5,\n        convergenceThreshold: session.config?.convergenceThreshold || 0.8,\n        roundTimeoutMs: (session.config?.timeoutMinutes || 60) * 60000,\n        allowHumanIntervention: session.config?.allowHumanIntervention ?? true\n      }\n    };\n  }\n\n  function defaultAvatarForParticipant(p: {\n    id: string;\n    name: string;\n    type: 'human' | 'ai';\n  }): string | undefined {\n    const id = (p.id || '').toLowerCase();\n    const name = (p.name || '').toLowerCase();\n\n    const icon = (filename: string, emoji?: string) =>\n      `asset:/icons/${filename}${emoji ? `|${emoji}` : ''}`;\n\n    // Prefer explicit ids/names when available (mock + UI sessions)\n    if (id.includes('fuchikoma-blue') || name.includes('fuchikoma blue')) {\n      return icon('Iconfactory-Ghost-In-The-Shell-Fuchikoma-Blue.32.png', 'üï∑Ô∏è');\n    }\n    if (id.includes('fuchikoma-red') || name.includes('fuchikoma red')) {\n      return icon('Iconfactory-Ghost-In-The-Shell-Fuchikoma-Red.32.png', 'üî¥');\n    }\n    if (id.includes('fuchikoma-purple') || name.includes('fuchikoma purple')) {\n      return icon('Iconfactory-Ghost-In-The-Shell-Fuchikoma-Purple.32.png', 'üü£');\n    }\n    if (id.includes('arakone') || name.includes('arakone')) {\n      return icon('Iconfactory-Ghost-In-The-Shell-Arakone-Unit.32.png', 'ü¶Ç');\n    }\n    if (name.includes('laughing man')) return 'üåÄ';\n    if (name.includes('puppet master')) return 'üß¨';\n\n    // Humans (best-effort for the built-in Ghost in the Shell set)\n    if (name.includes('kusanagi') || name.includes('motoko')) {\n      return icon('Iconfactory-Ghost-In-The-Shell-Motoko-Kusanagi.32.png', 'üï∂Ô∏è');\n    }\n    if (name.includes('batou') || name.includes('bateau')) {\n      return icon('Iconfactory-Ghost-In-The-Shell-Bateau.32.png', 'ü¶æ');\n    }\n    if (name.includes('togusa')) {\n      return icon('Iconfactory-Ghost-In-The-Shell-Togusa.32.png', 'üïµÔ∏è');\n    }\n    if (name.includes('ishikawa')) {\n      return icon('Iconfactory-Ghost-In-The-Shell-Ishikawa.32.png', 'üì°');\n    }\n\n    // Default AI fallback icon\n    if (p.type === 'ai') {\n      return icon('Iconfactory-Ghost-In-The-Shell-Fuchikoma-Gray.32.png', 'ü§ñ');\n    }\n\n    return undefined;\n  }\n\n  function getModelId(participant: Participant): string {\n    // Map participant names/types to model IDs\n    const modelMap: Record<string, string> = {\n      'claude': 'claude-3-5-sonnet-20241022',\n      'gpt4': 'gpt-4-turbo',\n      'gpt-4': 'gpt-4-turbo',\n      'ollama': 'ollama/llama3:latest'\n    };\n    const key = participant.name.toLowerCase();\n    // Prefer the backend default used when model_id is omitted.\n    return modelMap[key] || 'claude-sonnet-4-20250514';\n  }\n\n  // Convert IPC response to frontend session format\n  function fromSessionResponse(response: ForgeSessionResponse): ForgeSession {\n    return {\n      id: response.id,\n      name: response.name,\n      goal: response.goal,\n      phase: response.phase as SessionPhase,\n      participants: response.participants.map(p => ({\n        id: p.id,\n        name: p.name,\n        type: p.type,\n        role: p.role,\n        modelId: p.modelId,\n        avatar: defaultAvatarForParticipant({ id: p.id, name: p.name, type: p.type }),\n        status: p.status\n      })),\n      oracle: response.oracle ? {\n        id: response.oracle.id,\n        name: response.oracle.name,\n        type: response.oracle.modelId,\n        config: response.oracle.config as Record<string, any>\n      } : null,\n      config: {\n        maxRounds: response.config.maxRounds,\n        convergenceThreshold: response.config.convergenceThreshold,\n        allowHumanIntervention: response.config.allowHumanIntervention,\n        autoSaveInterval: 30000,\n        timeoutMinutes: Math.floor(response.config.roundTimeoutMs / 60000)\n      },\n      rounds: [],\n      hasResults: response.roundCount > 0,\n      createdAt: new Date(response.createdAt),\n      updatedAt: new Date(response.updatedAt)\n    };\n  }\n\n  return {\n    state: { subscribe: state.subscribe },\n    messages: { subscribe: messages.subscribe },\n\n    /**\n     * Create a new forge session\n     */\n    async createSession(sessionData: Partial<ForgeSession>): Promise<ForgeSession> {\n      const currentState = get(state);\n      \n      if (!currentState.useMockMode) {\n        try {\n          const request = toSessionRequest(sessionData);\n          const response = await ipc.invoke('forge:createSession', request);\n          const session = fromSessionResponse(response);\n          state.update(s => ({ ...s, activeSessionId: session.id, error: null }));\n          return session;\n        } catch (error) {\n          console.warn('IPC createSession failed, falling back to mock mode:', error);\n          state.update(s => ({ ...s, useMockMode: true }));\n        }\n      }\n      \n      // Mock mode\n      const mockSession: ForgeSession = {\n        id: `session-${Date.now()}`,\n        name: sessionData.name || 'Untitled Session',\n        goal: sessionData.goal || '',\n        phase: 'configuring',\n        participants: sessionData.participants || [],\n        oracle: sessionData.oracle || null,\n        config: sessionData.config,\n        rounds: [],\n        hasResults: false,\n        createdAt: new Date(),\n        updatedAt: new Date()\n      };\n      state.update(s => ({ ...s, activeSessionId: mockSession.id }));\n      return mockSession;\n    },\n\n    /**\n     * Start deliberation for a session\n     * Returns true only if real IPC succeeded; returns false for mock mode\n     * so that callers can run their own mock logic.\n     */\n    async startDeliberation(sessionId: string, phase: ForgePhase = 'drafting'): Promise<boolean> {\n      const currentState = get(state);\n      \n      if (!currentState.useMockMode) {\n        try {\n          const result = await ipc.invoke('forge:startDeliberation', { sessionId, phase });\n          if (result.success) {\n            state.update(s => ({ \n              ...s, \n              isDeliberating: true, \n              currentPhase: phase,\n              error: null \n            }));\n            return true; // Real IPC succeeded\n          }\n        } catch (error) {\n          console.warn('IPC startDeliberation failed:', error);\n        }\n      }\n      \n      // Mock mode - update state but return false so caller runs mock logic\n      state.update(s => ({ \n        ...s, \n        isDeliberating: true, \n        currentPhase: phase \n      }));\n      return false; // Signal to caller to use mock mode\n    },\n\n    /**\n     * Stop deliberation for a session\n     */\n    async stopDeliberation(sessionId: string): Promise<boolean> {\n      const currentState = get(state);\n      \n      if (!currentState.useMockMode) {\n        try {\n          const result = await ipc.invoke('forge:stopDeliberation', { sessionId });\n          if (result.success) {\n            state.update(s => ({ ...s, isDeliberating: false }));\n          }\n          return result.success;\n        } catch (error) {\n          console.warn('IPC stopDeliberation failed:', error);\n        }\n      }\n      \n      state.update(s => ({ ...s, isDeliberating: false }));\n      return true;\n    },\n\n    /**\n     * Submit a human message to the deliberation\n     */\n    async submitMessage(sessionId: string, content: string, participantId: string): Promise<string | null> {\n      const currentState = get(state);\n      \n      if (!currentState.useMockMode) {\n        try {\n          const result = await ipc.invoke('forge:submitMessage', { \n            sessionId, \n            content, \n            participantId \n          });\n\n          // Optimistically add the message to the local stream so the UI can render Q&A.\n          // (Backend echo is not guaranteed yet.)\n          const messageId = result.messageId;\n          const humanMessage: ForgeMessageEvent = {\n            sessionId,\n            messageId,\n            participantId,\n            participantName: 'You',\n            participantType: 'human',\n            content,\n            timestamp: new Date().toISOString(),\n            type: 'proposal',\n            status: 'complete',\n          };\n          messages.update(msgs => [...msgs, humanMessage]);\n\n          return result.messageId;\n        } catch (error) {\n          console.warn('IPC submitMessage failed:', error);\n        }\n      }\n      \n      // Mock mode\n      const messageId = `msg-${Date.now()}`;\n      const mockMessage: ForgeMessageEvent = {\n        sessionId,\n        messageId,\n        participantId,\n        participantName: 'You',\n        participantType: 'human',\n        content,\n        timestamp: new Date().toISOString(),\n        type: 'proposal',\n        status: 'complete'\n      };\n      messages.update(msgs => [...msgs, mockMessage]);\n      return messageId;\n    },\n\n    /**\n     * Generate output in the specified format\n     */\n    async generateOutput(request: ForgeOutputRequest): Promise<ForgeOutputResponse> {\n      const currentState = get(state);\n      \n      if (!currentState.useMockMode) {\n        try {\n          return await ipc.invoke('forge:generateOutput', request);\n        } catch (error) {\n          console.warn('IPC generateOutput failed, using mock:', error);\n        }\n      }\n      \n      // Mock output generation\n      const mockContent = generateMockOutput(request);\n      return {\n        sessionId: request.sessionId,\n        format: request.format,\n        content: mockContent,\n        filename: `forge-output.${getExtension(request.format)}`\n      };\n    },\n\n    /**\n     * List all forge sessions\n     */\n    async listSessions(): Promise<ForgeSession[]> {\n      const currentState = get(state);\n      \n      if (!currentState.useMockMode) {\n        try {\n          const sessions = await ipc.invoke('forge:listSessions', {});\n          return sessions.map(fromSessionResponse);\n        } catch (error) {\n          console.warn('IPC listSessions failed:', error);\n        }\n      }\n      \n      return [];\n    },\n\n    /**\n     * Clear messages for a fresh start\n     */\n    clearMessages() {\n      messages.set([]);\n    },\n\n    /**\n     * Clear any error state\n     */\n    clearError() {\n      state.update(s => ({ ...s, error: null }));\n    },\n\n    /**\n     * Reset the service state\n     */\n    reset() {\n      state.set(initialState);\n      messages.set([]);\n    }\n  };\n}\n\nfunction getExtension(format: string): string {\n  const extensions: Record<string, string> = {\n    markdown: 'md',\n    json: 'json',\n    yaml: 'yaml',\n    html: 'html',\n    plain: 'txt',\n    beads: 'yaml'\n  };\n  return extensions[format] || 'txt';\n}\n\nfunction generateMockOutput(request: ForgeOutputRequest): string {\n  const { format, sessionId } = request;\n  \n  switch (format) {\n    case 'json':\n      return JSON.stringify({\n        sessionId,\n        title: 'Mock Forge Output',\n        summary: 'This is a mock output generated for development.',\n        decisions: [],\n        metadata: {\n          generated: new Date().toISOString()\n        }\n      }, null, 2);\n    \n    case 'yaml':\n    case 'beads':\n      return `# Forge Session Output\nsession_id: ${sessionId}\ntitle: Mock Forge Output\nsummary: This is a mock output generated for development.\ndecisions: []\nmetadata:\n  generated: ${new Date().toISOString()}\n`;\n    \n    case 'html':\n      return `<!DOCTYPE html>\n<html>\n<head>\n  <title>Forge Output</title>\n  <style>\n    body { font-family: system-ui; max-width: 800px; margin: 2rem auto; padding: 1rem; }\n    h1 { color: #4ecdc4; }\n  </style>\n</head>\n<body>\n  <h1>Forge Session Output</h1>\n  <p>Session: ${sessionId}</p>\n  <p>This is a mock output generated for development.</p>\n</body>\n</html>`;\n    \n    case 'markdown':\n    default:\n      return `# Forge Session Output\n\n**Session ID:** ${sessionId}\n\n## Summary\n\nThis is a mock output generated for development. \nWhen connected to the backend, this will contain the actual deliberation results.\n\n## Decisions\n\n_No decisions recorded yet._\n\n---\n\n*Generated: ${new Date().toISOString()}*\n`;\n  }\n}\n\n// Export singleton instance\nexport const forgeService = createForgeService();\n","import { derived, get } from 'svelte/store';\nimport { createPersistedStore } from '$lib/stores/persistedStore';\nimport type { ForgeSession, ForgeSessionState, SessionPhase, SessionDraft } from '$lib/types/forge';\nimport { forgeService } from '$lib/services/forgeService';\n\nfunction createForgeSessionStore() {\n  const initialState: ForgeSessionState = {\n    activeSession: null,\n    sessions: [],\n    loading: false,\n    error: null\n  };\n\n  type StoredForgeSession = Omit<ForgeSession, 'createdAt' | 'updatedAt'> & {\n    createdAt: string;\n    updatedAt: string;\n  };\n\n  type StoredForgeSessionState = Omit<ForgeSessionState, 'sessions' | 'activeSession' | 'loading' | 'error'> & {\n    sessions: StoredForgeSession[];\n    activeSession: StoredForgeSession | null;\n    loading?: boolean;\n    error?: string | null;\n  };\n\n  function toStoredSession(session: ForgeSession): StoredForgeSession {\n    return {\n      ...session,\n      createdAt: session.createdAt.toISOString(),\n      updatedAt: session.updatedAt.toISOString()\n    };\n  }\n\n  function fromStoredSession(session: StoredForgeSession): ForgeSession {\n    return {\n      ...session,\n      createdAt: new Date(session.createdAt),\n      updatedAt: new Date(session.updatedAt)\n    };\n  }\n\n  const store = createPersistedStore<ForgeSessionState>(initialState, {\n    key: 'forgeSessionState',\n    version: 1,\n    serialize: (value) => {\n      const stored: StoredForgeSessionState = {\n        activeSession: value.activeSession ? toStoredSession(value.activeSession) : null,\n        sessions: value.sessions.map(toStoredSession),\n        // Don't persist transient UI state\n        loading: false,\n        error: null\n      };\n      return JSON.stringify(stored);\n    },\n    deserialize: (raw) => {\n      const parsed = JSON.parse(raw) as StoredForgeSessionState;\n      return {\n        activeSession: parsed.activeSession ? fromStoredSession(parsed.activeSession) : null,\n        sessions: Array.isArray(parsed.sessions) ? parsed.sessions.map(fromStoredSession) : [],\n        loading: false,\n        error: null\n      };\n    }\n  });\n\n  const { subscribe, set, update } = store;\n\n  return {\n    subscribe,\n\n    async loadSessions(): Promise<void> {\n      // If we already have persisted sessions, don't clobber them with mock data.\n      const existing = get(store).sessions;\n      if (existing.length > 0) {\n        update(state => ({ ...state, loading: false, error: null }));\n        return;\n      }\n\n      update(state => ({ ...state, loading: true, error: null }));\n      \n      try {\n        // Try to load from backend first\n        const backendSessions = await forgeService.listSessions();\n        \n        if (backendSessions.length > 0) {\n          update(state => ({\n            ...state,\n            sessions: backendSessions,\n            loading: false\n          }));\n          return;\n        }\n        \n        // Fallback to mock data for demo purposes\n        const mockSessions: ForgeSession[] = [\n          {\n            id: 'session-1',\n            name: 'Product Strategy Session',\n            goal: 'Define Q4 product roadmap priorities',\n            phase: 'configuring',\n            participants: [\n              {\n                id: 'p1',\n                name: 'Alice Product',\n                type: 'human',\n                role: 'Product Manager',\n                status: 'active',\n                avatar: 'asset:/icons/Iconfactory-Ghost-In-The-Shell-Motoko-Kusanagi.32.png|üï∂Ô∏è',\n              },\n              {\n                id: 'p2',\n                name: 'Bob Engineer',\n                type: 'human',\n                role: 'Tech Lead',\n                status: 'active',\n                avatar: 'asset:/icons/Iconfactory-Ghost-In-The-Shell-Bateau.32.png|ü¶æ',\n              },\n              {\n                id: 'p3',\n                name: 'Claude Analyst',\n                type: 'ai',\n                role: 'Business Analyst',\n                status: 'active',\n                modelId: 'claude-sonnet-4-20250514',\n                avatar: 'asset:/icons/Iconfactory-Ghost-In-The-Shell-Fuchikoma-Blue.32.png|üï∑Ô∏è',\n              }\n            ],\n            oracle: {\n              id: 'oracle-1',\n              name: 'Strategic Oracle',\n              type: 'gpt-4',\n              config: { temperature: 0.7 }\n            },\n            rounds: [],\n            hasResults: false,\n            createdAt: new Date('2024-01-15T10:00:00Z'),\n            updatedAt: new Date('2024-01-15T10:30:00Z')\n          }\n        ];\n\n        update(state => ({\n          ...state,\n          sessions: mockSessions,\n          loading: false\n        }));\n      } catch (error) {\n        update(state => ({\n          ...state,\n          loading: false,\n          error: error instanceof Error ? error.message : 'Failed to load sessions'\n        }));\n      }\n    },\n\n    setActiveSession(sessionId: string): void {\n      update(state => {\n        const session = state.sessions.find(s => s.id === sessionId);\n        return {\n          ...state,\n          activeSession: session || null\n        };\n      });\n    },\n\n    clearActiveSession(): void {\n      update(state => ({ ...state, activeSession: null }));\n    },\n\n    updateSessionPhase(sessionId: string, phase: SessionPhase): void {\n      update(state => {\n        const sessions = state.sessions.map(session =>\n          session.id === sessionId\n            ? { ...session, phase, updatedAt: new Date() }\n            : session\n        );\n        \n        const activeSession = state.activeSession?.id === sessionId\n          ? sessions.find(s => s.id === sessionId) || null\n          : state.activeSession;\n\n        return {\n          ...state,\n          sessions,\n          activeSession\n        };\n      });\n    },\n\n    updateParticipantModel(sessionId: string, participantId: string, modelId: string | undefined): void {\n      update(state => {\n        const patchSession = (session: ForgeSession): ForgeSession => {\n          if (session.id !== sessionId) return session;\n          return {\n            ...session,\n            participants: session.participants.map(p =>\n              p.id === participantId ? { ...p, modelId } : p\n            ),\n            updatedAt: new Date(),\n          };\n        };\n\n        const sessions = state.sessions.map(patchSession);\n        const activeSession = state.activeSession ? patchSession(state.activeSession) : null;\n\n        return {\n          ...state,\n          sessions,\n          activeSession,\n        };\n      });\n    },\n\n    clearError(): void {\n      update(state => ({ ...state, error: null }));\n    },\n\n    async saveDraft(draft: SessionDraft): Promise<string> {\n      try {\n        // TODO: Replace with actual API call\n        const draftId = `draft-${Date.now()}`;\n        \n        // For now, just simulate saving\n        console.log('Saving draft:', draft);\n        \n        return draftId;\n      } catch (error) {\n        throw new Error(error instanceof Error ? error.message : 'Failed to save draft');\n      }\n    },\n\n    async createSession(draft: SessionDraft): Promise<string> {\n      update(state => ({ ...state, loading: true, error: null }));\n      \n      try {\n        // Use forgeService to create session (handles IPC vs mock)\n        const newSession = await forgeService.createSession({\n          name: draft.name,\n          goal: draft.goal,\n          participants: draft.participants,\n          oracle: draft.oracle,\n          config: draft.config\n        });\n\n        update(state => ({\n          ...state,\n          sessions: [...state.sessions, newSession],\n          loading: false\n        }));\n\n        return newSession.id;\n      } catch (error) {\n        update(state => ({\n          ...state,\n          loading: false,\n          error: error instanceof Error ? error.message : 'Failed to create session'\n        }));\n        throw error;\n      }\n    },\n\n    async updateSession(sessionId: string, draft: SessionDraft): Promise<string> {\n      update(state => ({ ...state, loading: true, error: null }));\n      \n      try {\n        update(state => {\n          const sessions = state.sessions.map(session =>\n            session.id === sessionId\n              ? {\n                  ...session,\n                  name: draft.name,\n                  goal: draft.goal,\n                  participants: draft.participants,\n                  oracle: draft.oracle,\n                  config: draft.config,\n                  updatedAt: new Date()\n                }\n              : session\n          );\n          \n          const activeSession = state.activeSession?.id === sessionId\n            ? sessions.find(s => s.id === sessionId) || null\n            : state.activeSession;\n\n          return {\n            ...state,\n            sessions,\n            activeSession,\n            loading: false\n          };\n        });\n\n        return sessionId;\n      } catch (error) {\n        update(state => ({\n          ...state,\n          loading: false,\n          error: error instanceof Error ? error.message : 'Failed to update session'\n        }));\n        throw error;\n      }\n    },\n\n    reset(): void {\n      set(initialState);\n    }\n  };\n}\n\nexport const forgeSessionStore = createForgeSessionStore();\n\n// Derived stores\nexport const activeSession = derived(\n  forgeSessionStore,\n  $store => $store.activeSession\n);\n\nexport const sessions = derived(\n  forgeSessionStore,\n  $store => $store.sessions\n);\n\nexport const sessionLoading = derived(\n  forgeSessionStore,\n  $store => $store.loading\n);\n\nexport const sessionError = derived(\n  forgeSessionStore,\n  $store => $store.error\n);","<script lang=\"ts\">\n  export let sessionId: string | null = null;\n  import Icon from '$lib/components/common/Icon.svelte';\n  import RelativeTime from '$lib/components/common/RelativeTime.svelte';\n  import Spinner from '$lib/components/ui/Spinner/Spinner.svelte';\n  import { forgeSessionStore, sessions, activeSession, sessionLoading, sessionError } from '$lib/stores/forgeSession';\n\n  function handleSelect(id: string) {\n    forgeSessionStore.setActiveSession(id);\n  }\n\n  $: sortedSessions = [...$sessions].sort((a, b) => b.updatedAt.getTime() - a.updatedAt.getTime());\n</script>\n\n<div class=\"session-sidebar\" data-testid=\"session-sidebar\">\n  <div class=\"sidebar-header\">\n    <div class=\"title\">\n      <img \n        src=\"/icons/Iconfactory-Ghost-In-The-Shell-Fuchikoma-Blue.32.png\" \n        alt=\"\" \n        class=\"title-tachi-icon\"\n      />\n      <h2>Sessions</h2>\n    </div>\n    {#if $sessionLoading}\n      <div class=\"loading\" aria-label=\"Loading sessions\">\n        <Spinner size={16} color=\"var(--tachi-cyan, #4ecdc4)\" />\n      </div>\n    {/if}\n  </div>\n\n  {#if $sessionError}\n    <div class=\"banner\" role=\"alert\">\n      <Icon name=\"alert-triangle\" size={16} />\n      <span class=\"banner-text\">{$sessionError}</span>\n      <button type=\"button\" class=\"banner-btn\" on:click={() => forgeSessionStore.clearError()}>\n        Dismiss\n      </button>\n    </div>\n  {/if}\n\n  {#if sortedSessions.length === 0}\n    <div class=\"empty\">\n      <p class=\"empty-title\">No sessions yet</p>\n      <p class=\"empty-subtitle\">Create a new Think Tank session to begin deliberation.</p>\n    </div>\n  {:else}\n    <ul class=\"session-list\" aria-label=\"Forge sessions\">\n      {#each sortedSessions as s (s.id)}\n        <li>\n          <button\n            type=\"button\"\n            class=\"session-row\"\n            class:active={$activeSession?.id === s.id}\n            on:click={() => handleSelect(s.id)}\n            aria-current={$activeSession?.id === s.id ? 'true' : 'false'}\n          >\n            <div class=\"row-left\">\n              <div class=\"row-title\">\n                <span class=\"name\">{s.name}</span>\n                <span class=\"phase\">{s.phase}</span>\n              </div>\n              <div class=\"row-subtitle\">{s.goal}</div>\n            </div>\n            <div class=\"row-right\">\n              <RelativeTime date={s.updatedAt} />\n              <span class=\"pill\">{s.participants.length}p</span>\n            </div>\n          </button>\n        </li>\n      {/each}\n    </ul>\n  {/if}\n</div>\n\n<style>\n  .session-sidebar {\n    height: 100%;\n    overflow-y: auto;\n    display: flex;\n    flex-direction: column;\n    gap: 0.9rem;\n    padding: 1rem;\n    border-radius: 12px;\n    background: rgba(13, 17, 23, 0.35);\n    border: 1px solid rgba(78, 205, 196, 0.12);\n    -webkit-backdrop-filter: blur(12px);\n    backdrop-filter: blur(12px);\n  }\n\n  .sidebar-header {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    gap: 0.75rem;\n  }\n\n  .title {\n    display: flex;\n    align-items: center;\n    gap: 0.6rem;\n    color: var(--tachi-cyan, #4ecdc4);\n  }\n  \n  .title-tachi-icon {\n    width: 20px;\n    height: 20px;\n    object-fit: contain;\n    filter: drop-shadow(0 0 6px var(--tachi-cyan, #4ecdc4));\n  }\n\n  .title h2 {\n    margin: 0;\n    font-size: 0.9rem;\n    letter-spacing: 1.5px;\n    text-transform: uppercase;\n  }\n\n  .banner {\n    display: flex;\n    align-items: center;\n    gap: 0.6rem;\n    padding: 0.65rem 0.75rem;\n    border-radius: 10px;\n    background: rgba(255, 107, 107, 0.08);\n    border: 1px solid rgba(255, 107, 107, 0.25);\n    color: rgba(230, 237, 243, 0.85);\n  }\n\n  .banner-text {\n    flex: 1;\n    font-size: 0.85rem;\n    color: rgba(230, 237, 243, 0.75);\n  }\n\n  .banner-btn {\n    padding: 0.35rem 0.55rem;\n    border-radius: 8px;\n    background: transparent;\n    border: 1px solid rgba(255, 107, 107, 0.35);\n    color: rgba(230, 237, 243, 0.85);\n    cursor: pointer;\n  }\n\n  .banner-btn:hover {\n    background: rgba(255, 107, 107, 0.1);\n  }\n\n  .empty {\n    padding: 1.25rem 0.75rem;\n    text-align: center;\n  }\n\n  .empty-title {\n    margin: 0 0 0.35rem;\n    font-size: 0.95rem;\n    color: rgba(230, 237, 243, 0.85);\n  }\n\n  .empty-subtitle {\n    margin: 0;\n    font-size: 0.85rem;\n    color: var(--text-muted, rgba(230, 237, 243, 0.45));\n  }\n\n  .session-list {\n    list-style: none;\n    padding: 0;\n    margin: 0;\n    display: flex;\n    flex-direction: column;\n    gap: 0.5rem;\n  }\n\n  .session-row {\n    width: 100%;\n    display: flex;\n    align-items: flex-start;\n    justify-content: space-between;\n    gap: 0.75rem;\n    padding: 0.75rem 0.75rem;\n    border-radius: 12px;\n    background: rgba(22, 27, 34, 0.45);\n    border: 1px solid rgba(78, 205, 196, 0.1);\n    cursor: pointer;\n    text-align: left;\n    transition: all 0.2s ease;\n  }\n\n  .session-row:hover {\n    border-color: rgba(78, 205, 196, 0.35);\n    background: rgba(22, 27, 34, 0.55);\n  }\n\n  .session-row.active {\n    border-color: rgba(78, 205, 196, 0.6);\n    box-shadow: 0 0 0 3px rgba(78, 205, 196, 0.12);\n  }\n\n  .row-left {\n    flex: 1;\n    min-width: 0;\n    display: flex;\n    flex-direction: column;\n    gap: 0.25rem;\n  }\n\n  .row-title {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    gap: 0.5rem;\n  }\n\n  .name {\n    font-weight: 700;\n    color: rgba(230, 237, 243, 0.9);\n    font-size: 0.9rem;\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n  }\n\n  .phase {\n    font-size: 0.65rem;\n    font-family: var(--font-display, 'Orbitron', sans-serif);\n    letter-spacing: 1px;\n    text-transform: uppercase;\n    color: rgba(78, 205, 196, 0.9);\n    border: 1px solid rgba(78, 205, 196, 0.22);\n    background: rgba(78, 205, 196, 0.08);\n    padding: 0.15rem 0.4rem;\n    border-radius: 999px;\n    flex-shrink: 0;\n  }\n\n  .row-subtitle {\n    font-size: 0.8rem;\n    color: rgba(230, 237, 243, 0.55);\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n  }\n\n  .row-right {\n    display: flex;\n    flex-direction: column;\n    align-items: flex-end;\n    gap: 0.35rem;\n    flex-shrink: 0;\n    color: rgba(230, 237, 243, 0.55);\n    font-size: 0.75rem;\n  }\n\n  .pill {\n    font-size: 0.65rem;\n    color: rgba(230, 237, 243, 0.7);\n    padding: 0.15rem 0.4rem;\n    border-radius: 999px;\n    background: rgba(78, 205, 196, 0.08);\n    border: 1px solid rgba(78, 205, 196, 0.14);\n  }\n</style>","<script lang=\"ts\">\n  import type { ForgeSession, Participant } from '$lib/types/forge';\n  import { forgeSessionStore } from '$lib/stores/forgeSession';\n\n  export let session: ForgeSession | null = null;\n\n  $: participants = session?.participants || [];\n  $: canEditModels = session?.phase === 'configuring' || session?.phase === 'paused';\n\n  const modelOptions: Array<{ id: string; label: string }> = [\n    { id: 'claude-sonnet-4-20250514', label: 'Claude Sonnet 4 (Anthropic)' },\n    { id: 'claude-3-5-sonnet-20241022', label: 'Claude 3.5 Sonnet (Anthropic)' },\n    { id: 'gpt-4-turbo', label: 'GPT-4 Turbo (OpenAI)' },\n    { id: 'ollama/llama3:latest', label: 'Llama 3 (Ollama)' },\n  ];\n\n  const brokenAvatarIds = new Set<string>();\n\n  function parseAvatar(avatar?: string): { src?: string; emoji?: string } {\n    if (!avatar) return {};\n    if (avatar.startsWith('asset:')) {\n      const raw = avatar.slice('asset:'.length);\n      const [src, emoji] = raw.split('|');\n      return { src, emoji };\n    }\n    if (avatar.startsWith('/') || avatar.startsWith('http')) {\n      return { src: avatar };\n    }\n    return { emoji: avatar };\n  }\n\n  function markAvatarBroken(id: string) {\n    brokenAvatarIds.add(id);\n  }\n\n  function setParticipantModel(participant: Participant, modelId: string) {\n    if (!session) return;\n    forgeSessionStore.updateParticipantModel(session.id, participant.id, modelId || undefined);\n  }\n</script>\n\n<div class=\"participant-panel\" data-testid=\"participant-panel\">\n  <h3>Participants</h3>\n  \n  {#if participants.length > 0}\n    <div class=\"participant-list\">\n      {#each participants as participant}\n        {@const a = parseAvatar(participant.avatar)}\n        <div\n          class=\"participant-item\"\n          class:active={participant.status === 'active'}\n          class:thinking={participant.status === 'thinking'}\n          class:contributing={participant.status === 'contributing'}\n          data-testid=\"participant-{participant.id}\"\n        >\n          <div class=\"participant-avatar\">\n            {#if a.src && !brokenAvatarIds.has(participant.id)}\n              <img\n                src={a.src}\n                alt=\"{participant.name} avatar\"\n                on:error={() => markAvatarBroken(participant.id)}\n              />\n            {:else if a.emoji}\n              <div class=\"avatar-placeholder emoji\" aria-hidden=\"true\">{a.emoji}</div>\n            {:else}\n              <div class=\"avatar-placeholder\">\n                {participant.name.charAt(0).toUpperCase()}\n              </div>\n            {/if}\n            <div class=\"status-indicator\" class:ai={participant.type === 'ai'}></div>\n          </div>\n          \n          <div class=\"participant-info\">\n            <div class=\"participant-name\">{participant.name}</div>\n            <div class=\"participant-role\">{participant.role}</div>\n            <div class=\"participant-status\">{participant.status}</div>\n            {#if participant.type === 'ai'}\n              <div class=\"participant-model\">\n                <label class=\"model-label\" for={\"model-\" + participant.id}>Model</label>\n                <select\n                  id={\"model-\" + participant.id}\n                  class=\"model-select\"\n                  value={participant.modelId || 'claude-sonnet-4-20250514'}\n                  disabled={!canEditModels}\n                  title={!canEditModels ? 'Models can be edited before starting (Configuring) or when paused.' : ''}\n                  on:change={(e) => setParticipantModel(participant, e.currentTarget.value)}\n                >\n                  {#each modelOptions as opt}\n                    <option value={opt.id}>{opt.label}</option>\n                  {/each}\n                </select>\n              </div>\n            {/if}\n          </div>\n        </div>\n      {/each}\n    </div>\n\n    {#if session?.oracle}\n      <div class=\"oracle-section\">\n        <h4>Oracle</h4>\n        <div class=\"oracle-item\">\n          <div class=\"oracle-info\">\n            <div class=\"oracle-name\">{session.oracle.name}</div>\n            <div class=\"oracle-type\">{session.oracle.type}</div>\n          </div>\n        </div>\n      </div>\n    {/if}\n  {:else}\n    <div class=\"no-participants\">\n      <p>No participants in this session</p>\n    </div>\n  {/if}\n</div>\n\n<style>\n  .participant-panel {\n    padding: 1rem;\n    height: 100%;\n    overflow-y: auto;\n    border-top: 1px solid var(--border-color, #2a2a4a);\n  }\n\n  .participant-panel h3 {\n    margin: 0 0 1rem 0;\n    font-size: 1.1rem;\n    color: var(--forge-text, #eaeaea);\n  }\n\n  .participant-list {\n    display: flex;\n    flex-direction: column;\n    gap: 0.75rem;\n  }\n\n  .participant-item {\n    display: flex;\n    align-items: center;\n    gap: 0.75rem;\n    padding: 0.75rem;\n    border-radius: 6px;\n    background: var(--panel-item-bg, rgba(255, 255, 255, 0.05));\n    transition: all 0.2s ease;\n  }\n\n  .participant-item.active {\n    background: var(--success-color, #22c55e);\n    color: var(--success-text, #ffffff);\n  }\n\n  .participant-item.thinking {\n    background: var(--warning-color, #f59e0b);\n    color: var(--warning-text, #ffffff);\n  }\n\n  .participant-item.contributing {\n    background: var(--accent-color, #4a9eff);\n    color: var(--accent-text, #ffffff);\n  }\n\n  .participant-avatar {\n    position: relative;\n    width: 40px;\n    height: 40px;\n    flex-shrink: 0;\n  }\n\n  .participant-avatar img {\n    width: 100%;\n    height: 100%;\n    border-radius: 50%;\n    object-fit: cover;\n  }\n\n  .avatar-placeholder {\n    width: 100%;\n    height: 100%;\n    border-radius: 50%;\n    background: var(--accent-color, #4a9eff);\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    font-weight: bold;\n    color: white;\n    font-size: 1.2rem;\n  }\n\n  .avatar-placeholder.emoji {\n    background: rgba(13, 17, 23, 0.55);\n    border: 1px solid rgba(78, 205, 196, 0.14);\n    color: var(--text-primary, #e6edf3);\n    font-weight: 600;\n  }\n\n  .status-indicator {\n    position: absolute;\n    bottom: -2px;\n    right: -2px;\n    width: 12px;\n    height: 12px;\n    border-radius: 50%;\n    background: var(--success-color, #22c55e);\n    border: 2px solid var(--panel-bg, #16213e);\n  }\n\n  .status-indicator.ai {\n    background: var(--info-color, #3b82f6);\n  }\n\n  .participant-info {\n    flex: 1;\n    min-width: 0;\n  }\n\n  .participant-name {\n    font-weight: 600;\n    margin-bottom: 0.25rem;\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n  }\n\n  .participant-role {\n    font-size: 0.875rem;\n    opacity: 0.8;\n    margin-bottom: 0.25rem;\n  }\n\n  .participant-status {\n    font-size: 0.75rem;\n    text-transform: capitalize;\n    opacity: 0.7;\n  }\n\n  .participant-model {\n    margin-top: 0.35rem;\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n    flex-wrap: wrap;\n  }\n\n  .model-label {\n    font-size: 0.65rem;\n    font-weight: 600;\n    letter-spacing: 0.6px;\n    text-transform: uppercase;\n    opacity: 0.75;\n  }\n\n  .model-select {\n    width: 100%;\n    max-width: 260px;\n    padding: 0.35rem 0.5rem;\n    border-radius: 8px;\n    background: rgba(13, 17, 23, 0.45);\n    border: 1px solid rgba(78, 205, 196, 0.18);\n    color: rgba(230, 237, 243, 0.9);\n    font-size: 0.8rem;\n  }\n\n  .model-select:disabled {\n    opacity: 0.65;\n    cursor: not-allowed;\n  }\n\n  .oracle-section {\n    margin-top: 1.5rem;\n    padding-top: 1rem;\n    border-top: 1px solid var(--border-color, #2a2a4a);\n  }\n\n  .oracle-section h4 {\n    margin: 0 0 0.75rem 0;\n    font-size: 1rem;\n    color: var(--forge-text, #eaeaea);\n  }\n\n  .oracle-item {\n    padding: 0.75rem;\n    border-radius: 6px;\n    background: var(--info-color, #3b82f6);\n    color: white;\n  }\n\n  .oracle-name {\n    font-weight: 600;\n    margin-bottom: 0.25rem;\n  }\n\n  .oracle-type {\n    font-size: 0.875rem;\n    opacity: 0.8;\n    text-transform: uppercase;\n  }\n\n  .no-participants {\n    text-align: center;\n    color: var(--text-muted, #999);\n    padding: 2rem 1rem;\n  }\n</style>","/**\n * Deliberation Engine Service\n * \n * Orchestrates multi-model deliberation sessions.\n * Integrates with forgeService for IPC communication, with fallback to mock mode.\n */\n\nimport { writable, get } from 'svelte/store';\nimport type { ForgeSession, Participant } from '$lib/types/forge';\nimport { forgeService } from './forgeService';\n\nexport interface DeliberationState {\n  isRunning: boolean;\n  currentRound: number;\n  activeParticipantId: string | null;\n  pendingContributions: Map<string, string>; // participantId -> partial content\n  error: string | null;\n  useMockMode: boolean;\n}\n\nexport interface DeliberationMessage {\n  id: string;\n  participantId: string;\n  participantName: string;\n  participantType: 'human' | 'ai';\n  content: string;\n  timestamp: Date;\n  type: 'proposal' | 'critique' | 'synthesis' | 'thinking';\n  status: 'pending' | 'streaming' | 'complete';\n}\n\nfunction createDeliberationStore() {\n  const state = writable<DeliberationState>({\n    isRunning: false,\n    currentRound: 0,\n    activeParticipantId: null,\n    pendingContributions: new Map(),\n    error: null,\n    useMockMode: true\n  });\n\n  const messages = writable<DeliberationMessage[]>([]);\n  // Used to safely cancel in-flight mock runs when the user hits Stop or starts a new run.\n  let runToken = 0;\n\n  // Subscribe to forge service state to detect connection mode\n  forgeService.state.subscribe(forgeState => {\n    state.update(s => ({\n      ...s,\n      useMockMode: forgeState.useMockMode,\n      // When connected to IPC, reflect backend state for a predictable UX\n      ...(forgeState.useMockMode\n        ? {}\n        : {\n            isRunning: forgeState.isDeliberating,\n            error: forgeState.error,\n          }),\n    }));\n  });\n\n  // Subscribe to forge service messages for real-time updates\n  forgeService.messages.subscribe(forgeMessages => {\n    // Convert forge messages to deliberation messages\n    const converted: DeliberationMessage[] = forgeMessages.map(fm => ({\n      id: fm.messageId,\n      participantId: fm.participantId,\n      participantName: fm.participantName,\n      participantType: fm.participantType,\n      content: fm.content,\n      timestamp: new Date(fm.timestamp),\n      type: fm.type,\n      status: fm.status\n    }));\n    \n    // Only update if we have real messages from IPC\n    if (converted.length > 0 && !get(state).useMockMode) {\n      messages.set(converted);\n\n      // Best-effort \"who is active\" indicator from streaming/pending messages\n      const active =\n        [...converted]\n          .reverse()\n          .find(m => m.status === 'streaming' || m.status === 'pending')?.participantId ?? null;\n      state.update(s => ({ ...s, activeParticipantId: active }));\n    }\n  });\n\n  // Mock responses for different participant types\n  const mockResponses: Record<string, string[]> = {\n    'drafting': [\n      \"Based on the session goal, I propose we structure this into three main components:\\n\\n1. **Core Architecture** - Define the fundamental building blocks\\n2. **Interface Layer** - How users interact with the system\\n3. **Data Flow** - Information movement between components\\n\\nThis approach allows for modular development and clear separation of concerns.\",\n      \n      \"I'll approach this from a user-centric perspective:\\n\\n**User Stories:**\\n- As a developer, I need clear APIs to integrate quickly\\n- As an operator, I want visibility into system health\\n- As an admin, I require granular access controls\\n\\n**Key Considerations:**\\n- Performance at scale\\n- Security by default\\n- Developer experience\",\n      \n      \"Looking at this systematically, the goal suggests we need:\\n\\n```\\nInput ‚Üí Processing ‚Üí Output\\n         ‚Üì\\n    Validation\\n         ‚Üì\\n    Persistence\\n```\\n\\nI recommend starting with the happy path, then adding error handling and edge cases iteratively.\"\n    ],\n    'critiquing': [\n      \"I see some strong elements in the proposals. However:\\n\\n‚ö†Ô∏è **Concern**: The modular approach may introduce unnecessary complexity for the MVP\\n\\nüí° **Suggestion**: Start with a monolithic core, then extract services as needed\\n\\n‚úì **Agreement**: The user-centric framing is valuable\",\n      \n      \"Building on the previous contributions:\\n\\n**Strengths:**\\n- Clear structure\\n- Good separation of concerns\\n\\n**Gaps identified:**\\n- No mention of testing strategy\\n- Security considerations need elaboration\\n- What about backwards compatibility?\",\n      \n      \"The systematic approach is sound, but I'd challenge:\\n\\n1. The linear flow might not capture real-world async requirements\\n2. We should consider event-driven patterns\\n3. The persistence layer needs more detail - what's our consistency model?\"\n    ],\n    'synthesis': [\n      \"**Synthesizing the discussion:**\\n\\nWe've converged on a layered architecture with:\\n- User-centric design principles\\n- Modular but pragmatic structure\\n- Event-driven core with sync interfaces\\n\\n**Action Items:**\\n1. Define core data models\\n2. Draft API specifications\\n3. Create testing framework\\n\\n**Open Questions:**\\n- Consistency vs availability trade-offs\\n- MVP scope boundaries\"\n    ]\n  };\n\n  function isCancelled(token: number) {\n    return token !== runToken || !get(state).isRunning;\n  }\n\n  function planPhases(startPhase: string): Array<'drafting' | 'critiquing' | 'synthesis'> {\n    // Keep the UI simple: when you hit Start, models run through a coherent mini-pipeline.\n    // (Backend mode emits real rounds; mock mode mirrors the intent.)\n    if (startPhase === 'critiquing') return ['critiquing', 'synthesis'];\n    if (startPhase === 'converging') return ['synthesis'];\n    // default: drafting\n    return ['drafting', 'critiquing', 'synthesis'];\n  }\n\n  function messageTypeForPhase(phase: string): DeliberationMessage['type'] {\n    if (phase === 'critiquing') return 'critique';\n    if (phase === 'synthesis') return 'synthesis';\n    return 'proposal';\n  }\n\n  function latestCompleteOfType(type: DeliberationMessage['type']): DeliberationMessage | null {\n    const current = get(messages);\n    return (\n      [...current]\n        .reverse()\n        .find(m => m.status === 'complete' && m.type === type) ?? null\n    );\n  }\n\n  async function startDeliberation(session: ForgeSession) {\n    // Cancel any in-flight mock run, then start a fresh run.\n    runToken += 1;\n    const token = runToken;\n\n    state.update(s => ({ ...s, isRunning: true, error: null, currentRound: 1, activeParticipantId: null }));\n    \n    const currentState = get(state);\n    \n    // Try to use real IPC first (only if we think IPC is available)\n    if (!currentState.useMockMode) {\n      try {\n        const phase = session.phase as import('$lib/ipc/types').ForgePhase;\n        const success = await forgeService.startDeliberation(session.id, phase);\n        if (success) {\n          // Real deliberation started - messages will come via events\n          return;\n        }\n        // If success is false, fall through to mock mode\n      } catch (error) {\n        console.warn('Failed to start real deliberation, falling back to mock:', error);\n      }\n      // Update state to use mock mode going forward\n      state.update(s => ({ ...s, useMockMode: true }));\n    }\n    \n    // Run mock mode - generate simulated AI responses\n    messages.set([]);\n    \n    const aiParticipants = session.participants.filter(p => p.type === 'ai');\n    const startPhase = String(session.phase || 'drafting');\n    const phases = planPhases(startPhase);\n\n    // Simulate a structured multi-phase run so models \"talk\" without extra user clicks.\n    for (let phaseIdx = 0; phaseIdx < phases.length; phaseIdx++) {\n      const phase = phases[phaseIdx];\n      state.update(s => ({ ...s, currentRound: phaseIdx + 1 }));\n\n      const phaseResponses = mockResponses[phase] || mockResponses['drafting'];\n\n      for (let i = 0; i < aiParticipants.length; i++) {\n        if (isCancelled(token)) return;\n        const participant = aiParticipants[i];\n\n        // Set active participant\n        state.update(s => ({ ...s, activeParticipantId: participant.id }));\n\n        // Add \"thinking\" message\n        const thinkingMsg: DeliberationMessage = {\n          id: `msg-${Date.now()}-${phaseIdx}-${i}`,\n          participantId: participant.id,\n          participantName: participant.name,\n          participantType: participant.type,\n          content: '',\n          timestamp: new Date(),\n          type: 'thinking',\n          status: 'pending'\n        };\n        messages.update(msgs => [...msgs, thinkingMsg]);\n\n        // Simulate thinking delay\n        await delay(650 + Math.random() * 900);\n        if (isCancelled(token)) return;\n\n        // Stream the response (best-effort: reference prior content to feel \"interactive\")\n        let response = phaseResponses[i % phaseResponses.length];\n        if (phase === 'critiquing') {\n          const lastProposal = latestCompleteOfType('proposal');\n          if (lastProposal?.content) {\n            response =\n              `**Critiquing (context: ${lastProposal.participantName})**\\n\\n` +\n              response +\n              `\\n\\n---\\n\\n**Snippet I‚Äôm responding to:**\\n> ${lastProposal.content.slice(0, 220).replace(/\\n/g, '\\n> ')}`;\n          }\n        } else if (phase === 'synthesis') {\n          const lastCritique = latestCompleteOfType('critique');\n          if (lastCritique?.content) {\n            response =\n              response +\n              `\\n\\n---\\n\\n**Incorporating critique from ${lastCritique.participantName}:**\\n> ${lastCritique.content.slice(0, 220).replace(/\\n/g, '\\n> ')}`;\n          }\n        }\n\n        await streamResponse(thinkingMsg.id, response, participant, messageTypeForPhase(phase));\n      }\n    }\n\n    if (!isCancelled(token)) {\n      state.update(s => ({ ...s, isRunning: false, activeParticipantId: null }));\n    }\n  }\n\n  async function streamResponse(\n    messageId: string,\n    fullResponse: string,\n    _participant: Participant,\n    finalType: DeliberationMessage['type']\n  ) {\n    const words = fullResponse.split(' ');\n    let current = '';\n\n    messages.update(msgs => \n      msgs.map(m => m.id === messageId \n        ? { ...m, type: finalType, status: 'streaming' as const } \n        : m\n      )\n    );\n\n    for (let i = 0; i < words.length; i++) {\n      current += (i > 0 ? ' ' : '') + words[i];\n      \n      messages.update(msgs => \n        msgs.map(m => m.id === messageId ? { ...m, content: current } : m)\n      );\n\n      // Variable delay for natural feel\n      await delay(20 + Math.random() * 40);\n    }\n\n    // Mark as complete\n    messages.update(msgs => \n      msgs.map(m => m.id === messageId ? { ...m, status: 'complete' as const } : m)\n    );\n  }\n\n  async function stopDeliberation(sessionId?: string) {\n    const currentState = get(state);\n    \n    if (!currentState.useMockMode && sessionId) {\n      try {\n        await forgeService.stopDeliberation(sessionId);\n      } catch (error) {\n        console.warn('Failed to stop real deliberation:', error);\n      }\n    }\n    \n    // Cancel any in-flight mock work.\n    runToken += 1;\n    state.update(s => ({ ...s, isRunning: false, activeParticipantId: null }));\n  }\n\n  function clearMessages() {\n    messages.set([]);\n    forgeService.clearMessages();\n  }\n\n  return {\n    state: { subscribe: state.subscribe },\n    messages: { subscribe: messages.subscribe },\n    startDeliberation,\n    stopDeliberation,\n    clearMessages\n  };\n}\n\nfunction delay(ms: number): Promise<void> {\n  return new Promise(resolve => setTimeout(resolve, ms));\n}\n\nexport const deliberationStore = createDeliberationStore();\n","<script lang=\"ts\">\n  import { marked } from 'marked';\n  import Icon from '$lib/components/common/Icon.svelte';\n  import Spinner from '$lib/components/ui/Spinner/Spinner.svelte';\n  import { deliberationStore } from '$lib/services/deliberation';\n  import { forgeService } from '$lib/services/forgeService';\n  import type { ForgeSession, SessionPhase } from '$lib/types/forge';\n\n  export let session: ForgeSession | null;\n  export let phase: SessionPhase;\n\n  let messagesContainer: HTMLElement;\n  let prompt = '';\n  let selectedHumanId: string | null = null;\n  let isSending = false;\n\n  let artifactLoading = false;\n  let artifactError: string | null = null;\n  let artifactMarkdown: string | null = null;\n  let latestDraft: string | null = null;\n\n  let viewMode: 'feed' | 'artifacts' = 'feed';\n\n  // Subscribe to the nested stores\n  const deliberationState = deliberationStore.state;\n  const messagesStore = deliberationStore.messages;\n\n  // Always keep a safe array here; reactive assignments can run before store values settle.\n  let messages: any[] = [];\n\n  $: isRunning = $deliberationState.isRunning;\n  $: activeParticipantId = $deliberationState.activeParticipantId;\n  $: error = $deliberationState.error;\n  $: useMockMode = $deliberationState.useMockMode;\n  $: messages = Array.isArray($messagesStore) ? $messagesStore : [];\n\n  $: aiCount = session?.participants?.filter(p => p.type === 'ai')?.length ?? 0;\n  $: humans = session?.participants?.filter(p => p.type === 'human') ?? [];\n  $: if (humans.length > 0 && !selectedHumanId) selectedHumanId = humans[0].id;\n\n  function handleStartDeliberation() {\n    if (!session) return;\n    if (aiCount === 0) return;\n\n    deliberationStore.clearMessages();\n    // In mock mode, this will run a structured multi-phase pipeline; in IPC mode, the backend emits rounds.\n    deliberationStore.startDeliberation({ ...session, phase });\n  }\n\n  function handleStop() {\n    deliberationStore.stopDeliberation(session?.id);\n  }\n\n  async function handleSendPrompt() {\n    if (!session) return;\n    if (!prompt.trim()) return;\n    if (!selectedHumanId) return;\n    isSending = true;\n    try {\n      await forgeService.submitMessage(session.id, prompt.trim(), selectedHumanId);\n      prompt = '';\n    } finally {\n      isSending = false;\n    }\n  }\n\n  function getLatestDraft(): string | null {\n    if (!Array.isArray(messages)) return null;\n    const candidates = [...messages]\n      .filter(m => m.status === 'complete' && (m.type === 'proposal' || m.type === 'synthesis'))\n      .reverse();\n    return candidates[0]?.content ?? null;\n  }\n\n  $: latestDraft = getLatestDraft();\n\n  async function refreshArtifacts() {\n    if (!session) return;\n    artifactLoading = true;\n    artifactError = null;\n    try {\n      const out = await forgeService.generateOutput({\n        sessionId: session.id,\n        format: 'markdown',\n        includeMetadata: false,\n      });\n      artifactMarkdown = out.content;\n    } catch (e) {\n      artifactError = e instanceof Error ? e.message : String(e);\n    } finally {\n      artifactLoading = false;\n    }\n  }\n\n  // Auto-scroll to bottom when new messages arrive\n  $: if (messages.length && messagesContainer) {\n    setTimeout(() => {\n      messagesContainer.scrollTop = messagesContainer.scrollHeight;\n    }, 50);\n  }\n\n  function renderMarkdown(content: string): string {\n    return marked(content) as string;\n  }\n\n  const brokenAvatarIds = new Set<string>();\n\n  function parseAvatar(avatar?: string): { src?: string; emoji?: string } {\n    if (!avatar) return {};\n    if (avatar.startsWith('asset:')) {\n      const raw = avatar.slice('asset:'.length);\n      const [src, emoji] = raw.split('|');\n      return { src, emoji };\n    }\n    if (avatar.startsWith('/') || avatar.startsWith('http')) {\n      return { src: avatar };\n    }\n    return { emoji: avatar };\n  }\n\n  function getParticipantAvatar(message: any): { src?: string; emoji?: string } {\n    const byId = session?.participants?.find(p => p.id === message.participantId);\n    const byName = session?.participants?.find(\n      p => (p.name || '').toLowerCase() === (message.participantName || '').toLowerCase()\n    );\n    const p = byId || byName;\n    return parseAvatar(p?.avatar);\n  }\n\n  function markAvatarBroken(id: string) {\n    brokenAvatarIds.add(id);\n  }\n</script>\n\n<div class=\"deliberation-view\">\n  <div class=\"topbar\">\n    <div class=\"topbar-left\">\n      <div class=\"title\">\n        <span class=\"title-kicker\">Deliberation</span>\n        <span class=\"title-main\">Workspace</span>\n      </div>\n      <div class=\"badges\">\n        {#if useMockMode}\n          <span class=\"chip chip-warn\">Mock</span>\n        {:else}\n          <span class=\"chip chip-ok\">IPC</span>\n        {/if}\n        <span class=\"chip chip-run\">{phase}</span>\n        {#if isRunning}\n          <span class=\"chip chip-live\">Running</span>\n        {/if}\n      </div>\n    </div>\n\n    <div class=\"topbar-right\">\n      {#if isRunning}\n        <button type=\"button\" class=\"btn btn-danger\" on:click={handleStop}>\n          <Icon name=\"square\" size={16} />\n          Stop\n        </button>\n      {:else if session && aiCount === 0}\n        <button type=\"button\" class=\"btn btn-secondary\" disabled title=\"Add at least one AI agent to run a round\">\n          <Icon name=\"user-plus\" size={16} />\n          Add AI agents\n        </button>\n      {:else}\n        <button\n          type=\"button\"\n          class=\"btn btn-primary\"\n          disabled={!session || aiCount === 0}\n          on:click={handleStartDeliberation}\n        >\n          <Icon name=\"zap\" size={16} />\n          Start deliberation\n        </button>\n      {/if}\n    </div>\n  </div>\n\n  {#if error}\n    <div class=\"error-banner\" role=\"alert\">\n      <Icon name=\"alert-triangle\" size={16} />\n      <div class=\"error-text\">\n        <div class=\"error-title\">Deliberation error</div>\n        <div class=\"error-msg\">{error}</div>\n      </div>\n    </div>\n  {/if}\n\n  <div class=\"workspace\">\n    <div class=\"workspace-header\">\n      <div class=\"workspace-tabs\" role=\"tablist\" aria-label=\"Workspace view\">\n        <button type=\"button\" class=\"wt\" class:active={viewMode === 'feed'} on:click={() => (viewMode = 'feed')}>\n          <Icon name=\"message-circle\" size={14} />\n          Feed\n        </button>\n        <button type=\"button\" class=\"wt\" class:active={viewMode === 'artifacts'} on:click={() => (viewMode = 'artifacts')}>\n          <Icon name=\"file-text\" size={14} />\n          Artifacts\n        </button>\n      </div>\n      <div class=\"workspace-actions\">\n        <button type=\"button\" class=\"btn btn-secondary\" on:click={refreshArtifacts} disabled={!session || artifactLoading}>\n          {#if artifactLoading}\n            <Spinner size={14} color=\"var(--tachi-cyan)\" />\n          {:else}\n            <Icon name=\"refresh-cw\" size={14} />\n          {/if}\n          Refresh artifacts\n        </button>\n      </div>\n    </div>\n\n    {#if viewMode === 'feed'}\n      <div class=\"messages-container\" bind:this={messagesContainer}>\n        {#if messages.length === 0 && isRunning}\n          <div class=\"starting-state\" aria-live=\"polite\">\n            <Spinner size={18} color=\"var(--tachi-cyan)\" />\n            <div class=\"starting-text\">\n              <div class=\"starting-title\">Starting round‚Ä¶</div>\n              <div class=\"starting-subtitle\">\n                {#if useMockMode}\n                  Mock mode: simulating events.\n                {:else}\n                  Waiting for the first streaming event from the backend.\n                {/if}\n              </div>\n            </div>\n          </div>\n        {:else if messages.length === 0 && session && aiCount === 0}\n          <div class=\"empty-state\">\n            <div class=\"empty-icon\">\n              <Icon name=\"users\" size={48} />\n            </div>\n            <p>This session has no AI agents.</p>\n            <small>Add one or more AI participants to generate drafts.</small>\n          </div>\n        {:else if messages.length === 0}\n          <div class=\"empty-state\">\n            <div class=\"empty-icon\">\n              <Icon name=\"message-circle\" size={48} />\n            </div>\n            <p>Click ‚ÄúStart deliberation‚Äù to let the agents run.</p>\n            <small>Use the prompt box below to add constraints or ask follow-ups.</small>\n          </div>\n        {:else}\n          {#each messages as message (message.id)}\n            {@const a = getParticipantAvatar(message)}\n            <div\n              class=\"message-card\"\n              class:streaming={message.status === 'streaming'}\n              class:thinking={message.type === 'thinking'}\n              data-participant-type={message.participantType}\n            >\n              <div class=\"message-header\">\n                <div class=\"participant-avatar\" class:ai={message.participantType === 'ai'}>\n                  {#if a.src && !brokenAvatarIds.has(message.participantId)}\n                    <img\n                      src={a.src}\n                      alt=\"{message.participantName} avatar\"\n                      on:error={() => markAvatarBroken(message.participantId)}\n                    />\n                  {:else if a.emoji}\n                    <span class=\"avatar-emoji\" aria-hidden=\"true\">{a.emoji}</span>\n                  {:else}\n                    {message.participantName.charAt(0).toUpperCase()}\n                  {/if}\n                </div>\n                <div class=\"participant-info\">\n                  <span class=\"participant-name\">{message.participantName}</span>\n                  <span class=\"message-time\">\n                    {message.timestamp.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}\n                  </span>\n                </div>\n                <div class=\"message-status\">\n                  {#if message.status === 'streaming'}\n                    <Spinner size={14} color=\"var(--tachi-cyan)\" />\n                    <span>Streaming‚Ä¶</span>\n                  {:else if message.status === 'complete'}\n                    <Icon name=\"check-circle\" size={14} />\n                  {:else}\n                    <Spinner size={14} color=\"var(--tachi-cyan)\" />\n                    <span>Thinking‚Ä¶</span>\n                  {/if}\n                </div>\n              </div>\n\n              <div class=\"message-content\">\n                {#if message.content}\n                  {@html renderMarkdown(message.content)}\n                {:else}\n                  <div class=\"thinking-indicator\">\n                    <span class=\"dot\"></span>\n                    <span class=\"dot\"></span>\n                    <span class=\"dot\"></span>\n                  </div>\n                {/if}\n              </div>\n            </div>\n          {/each}\n\n          {#if isRunning && activeParticipantId}\n            <div class=\"typing-indicator\">\n              <Spinner size={12} color=\"var(--tachi-cyan)\" />\n              <span>Participant is responding‚Ä¶</span>\n            </div>\n          {/if}\n        {/if}\n      </div>\n    {:else}\n      <div class=\"artifacts-panel\">\n        {#if artifactError}\n          <div class=\"artifact-error\">\n            <Icon name=\"alert-triangle\" size={14} />\n            <span>{artifactError}</span>\n          </div>\n        {/if}\n\n        <section class=\"artifact-card\">\n          <div class=\"artifact-head\">\n            <div class=\"artifact-title\">\n              <Icon name=\"file-text\" size={16} />\n              <span>Latest draft (from feed)</span>\n            </div>\n          </div>\n          <div class=\"artifact-body\">\n            {#if latestDraft}\n              {@html renderMarkdown(latestDraft)}\n            {:else}\n              <div class=\"artifact-empty\">No completed draft yet.</div>\n            {/if}\n          </div>\n        </section>\n\n        <section class=\"artifact-card\">\n          <div class=\"artifact-head\">\n            <div class=\"artifact-title\">\n              <Icon name=\"package\" size={16} />\n              <span>Generated output (markdown)</span>\n            </div>\n          </div>\n          <div class=\"artifact-body\">\n            {#if artifactMarkdown}\n              {@html renderMarkdown(artifactMarkdown)}\n            {:else}\n              <div class=\"artifact-empty\">Click ‚ÄúRefresh artifacts‚Äù to generate output.</div>\n            {/if}\n          </div>\n        </section>\n      </div>\n    {/if}\n\n    <div class=\"prompt-bar\" role=\"group\" aria-label=\"Prompt input\">\n      <div class=\"prompt-left\">\n        <div class=\"prompt-label\">\n          <Icon name=\"corner-down-right\" size={14} />\n          <span>Prompt</span>\n        </div>\n        {#if humans.length > 0}\n          <select class=\"prompt-select\" bind:value={selectedHumanId} aria-label=\"Select human participant\">\n            {#each humans as h}\n              <option value={h.id}>{h.name}</option>\n            {/each}\n          </select>\n        {:else}\n          <span class=\"prompt-hint\">No human participant in this session.</span>\n        {/if}\n      </div>\n      <div class=\"prompt-right\">\n        <textarea\n          class=\"prompt-input\"\n          bind:value={prompt}\n          rows=\"2\"\n          placeholder=\"Ask a question, add constraints, or provide feedback‚Ä¶\"\n        />\n        <button\n          type=\"button\"\n          class=\"btn btn-primary\"\n          disabled={!session || !selectedHumanId || !prompt.trim() || isSending}\n          on:click={handleSendPrompt}\n        >\n          {#if isSending}\n            <Spinner size={14} color=\"var(--bg-primary, #0d1117)\" />\n          {:else}\n            <Icon name=\"send\" size={14} />\n          {/if}\n          Send\n        </button>\n      </div>\n    </div>\n  </div>\n</div>\n\n<style>\n  .deliberation-view {\n    display: flex;\n    flex-direction: column;\n    min-height: 560px;\n    background: rgba(13, 17, 23, 0.35);\n    border: 1px solid rgba(78, 205, 196, 0.18);\n    border-radius: 16px;\n    overflow: hidden;\n  }\n\n  .topbar {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    gap: 1rem;\n    padding: 0.9rem 1.1rem;\n    background: rgba(78, 205, 196, 0.06);\n    border-bottom: 1px solid rgba(78, 205, 196, 0.14);\n  }\n\n  .topbar-left {\n    display: flex;\n    align-items: baseline;\n    gap: 1rem;\n    min-width: 0;\n  }\n\n  .title {\n    display: flex;\n    align-items: baseline;\n    gap: 0.5rem;\n    min-width: 0;\n  }\n\n  .title-kicker {\n    font-family: var(--font-display, \"Orbitron\", sans-serif);\n    letter-spacing: 1px;\n    text-transform: uppercase;\n    color: rgba(78, 205, 196, 0.85);\n    font-size: 0.85rem;\n    font-weight: 700;\n  }\n\n  .title-main {\n    font-family: var(--font-display, \"Orbitron\", sans-serif);\n    letter-spacing: 1px;\n    text-transform: uppercase;\n    color: rgba(230, 237, 243, 0.9);\n    font-size: 0.85rem;\n    font-weight: 600;\n    opacity: 0.9;\n  }\n\n  .badges {\n    display: inline-flex;\n    align-items: center;\n    gap: 0.4rem;\n    flex-wrap: wrap;\n  }\n\n  .chip {\n    font-size: 0.65rem;\n    font-weight: 600;\n    padding: 0.15rem 0.45rem;\n    border-radius: 999px;\n    border: 1px solid transparent;\n    letter-spacing: 0.4px;\n    text-transform: uppercase;\n  }\n\n  .chip-ok {\n    color: rgba(63, 185, 80, 0.95);\n    background: rgba(63, 185, 80, 0.12);\n    border-color: rgba(63, 185, 80, 0.22);\n  }\n\n  .chip-warn {\n    color: rgba(243, 156, 18, 0.95);\n    background: rgba(243, 156, 18, 0.12);\n    border-color: rgba(243, 156, 18, 0.22);\n  }\n\n  .chip-run {\n    color: rgba(78, 205, 196, 0.95);\n    background: rgba(78, 205, 196, 0.12);\n    border-color: rgba(78, 205, 196, 0.22);\n  }\n\n  .chip-live {\n    color: rgba(88, 166, 255, 0.95);\n    background: rgba(88, 166, 255, 0.12);\n    border-color: rgba(88, 166, 255, 0.22);\n  }\n\n  .topbar-right {\n    display: inline-flex;\n    align-items: center;\n    gap: 0.5rem;\n    flex-shrink: 0;\n  }\n\n  .btn {\n    display: inline-flex;\n    align-items: center;\n    gap: 0.5rem;\n    padding: 0.5rem 0.9rem;\n    border-radius: 8px;\n    font-size: 0.8rem;\n    font-weight: 500;\n    cursor: pointer;\n    transition: all 0.15s ease;\n    border: 1px solid transparent;\n  }\n\n  .btn-primary {\n    background: linear-gradient(135deg, var(--tachi-cyan-dark, #2d7a7a), var(--tachi-cyan, #4ecdc4));\n    color: var(--bg-primary, #0d1117);\n    border-color: rgba(78, 205, 196, 0.5);\n  }\n\n  .btn-primary:hover {\n    box-shadow: 0 0 20px rgba(78, 205, 196, 0.3);\n  }\n\n  .btn-secondary {\n    background: rgba(13, 17, 23, 0.35);\n    color: rgba(230, 237, 243, 0.85);\n    border-color: rgba(78, 205, 196, 0.18);\n  }\n\n  .btn-secondary:hover:enabled {\n    background: rgba(78, 205, 196, 0.1);\n    border-color: rgba(78, 205, 196, 0.35);\n  }\n\n  .btn-danger {\n    background: rgba(255, 107, 107, 0.15);\n    color: rgba(255, 107, 107, 0.95);\n    border-color: rgba(255, 107, 107, 0.35);\n  }\n\n  .btn-danger:hover {\n    background: rgba(255, 107, 107, 0.25);\n  }\n\n  .round-tabs {\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n    padding: 0.75rem 1rem;\n    border-bottom: 1px solid rgba(78, 205, 196, 0.12);\n    background: rgba(13, 17, 23, 0.25);\n  }\n\n  .tab {\n    display: inline-flex;\n    align-items: center;\n    gap: 0.45rem;\n    padding: 0.45rem 0.7rem;\n    border-radius: 999px;\n    border: 1px solid rgba(78, 205, 196, 0.16);\n    background: rgba(13, 17, 23, 0.35);\n    color: rgba(230, 237, 243, 0.85);\n    cursor: pointer;\n    transition: all 0.15s ease;\n    font-size: 0.8rem;\n  }\n\n  .tab:hover:enabled {\n    border-color: rgba(78, 205, 196, 0.35);\n    background: rgba(78, 205, 196, 0.08);\n  }\n\n  .tab:disabled {\n    opacity: 0.5;\n    cursor: not-allowed;\n  }\n\n  .tab.active {\n    border-color: rgba(78, 205, 196, 0.55);\n    background: rgba(78, 205, 196, 0.12);\n    color: var(--tachi-cyan, #4ecdc4);\n  }\n\n  .workspace {\n    flex: 1;\n    display: flex;\n    flex-direction: column;\n    min-height: 0;\n  }\n\n  .workspace-header {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    gap: 0.75rem;\n    padding: 0.65rem 1rem;\n    border-bottom: 1px solid rgba(78, 205, 196, 0.12);\n    background: rgba(13, 17, 23, 0.22);\n  }\n\n  .workspace-tabs {\n    display: inline-flex;\n    gap: 0.4rem;\n  }\n\n  .wt {\n    display: inline-flex;\n    align-items: center;\n    gap: 0.45rem;\n    padding: 0.45rem 0.75rem;\n    border-radius: 10px;\n    border: 1px solid rgba(78, 205, 196, 0.14);\n    background: rgba(13, 17, 23, 0.35);\n    color: rgba(230, 237, 243, 0.85);\n    cursor: pointer;\n  }\n\n  .wt.active {\n    border-color: rgba(78, 205, 196, 0.5);\n    background: rgba(78, 205, 196, 0.12);\n    color: var(--tachi-cyan, #4ecdc4);\n  }\n\n  .workspace-actions {\n    display: inline-flex;\n    gap: 0.4rem;\n    align-items: center;\n  }\n\n  .messages-container {\n    flex: 1;\n    overflow-y: auto;\n    padding: 1.25rem;\n    display: flex;\n    flex-direction: column;\n    gap: 1rem;\n    min-height: 260px;\n  }\n\n  .error-banner {\n    display: flex;\n    gap: 0.75rem;\n    align-items: flex-start;\n    padding: 0.75rem 1rem;\n    background: rgba(255, 107, 107, 0.12);\n    border-bottom: 1px solid rgba(255, 107, 107, 0.25);\n    color: rgba(255, 107, 107, 0.95);\n  }\n\n  .error-text {\n    display: flex;\n    flex-direction: column;\n    gap: 0.15rem;\n  }\n\n  .error-title {\n    font-weight: 600;\n    font-size: 0.85rem;\n  }\n\n  .error-msg {\n    font-size: 0.8rem;\n    opacity: 0.9;\n  }\n\n  .starting-state {\n    display: flex;\n    align-items: center;\n    gap: 0.75rem;\n    padding: 1rem;\n    border-radius: 12px;\n    background: rgba(78, 205, 196, 0.06);\n    border: 1px solid rgba(78, 205, 196, 0.14);\n    color: rgba(230, 237, 243, 0.85);\n    min-height: 96px;\n  }\n\n  .starting-text {\n    display: flex;\n    flex-direction: column;\n    gap: 0.2rem;\n  }\n\n  .starting-title {\n    font-weight: 600;\n    letter-spacing: 0.2px;\n  }\n\n  .starting-subtitle {\n    font-size: 0.85rem;\n    color: rgba(230, 237, 243, 0.6);\n  }\n\n  .empty-state {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    height: 100%;\n    gap: 1rem;\n    color: rgba(230, 237, 243, 0.4);\n  }\n\n  .empty-icon {\n    opacity: 0.4;\n  }\n\n  .empty-state p {\n    margin: 0;\n    font-size: 0.9rem;\n  }\n\n  .message-card {\n    background: rgba(22, 27, 34, 0.6);\n    border: 1px solid rgba(78, 205, 196, 0.12);\n    border-radius: 12px;\n    overflow: hidden;\n    animation: fadeIn 0.3s ease;\n  }\n\n  @keyframes fadeIn {\n    from { opacity: 0; transform: translateY(10px); }\n    to { opacity: 1; transform: translateY(0); }\n  }\n\n  .message-card.streaming {\n    border-color: rgba(78, 205, 196, 0.35);\n    box-shadow: 0 0 15px rgba(78, 205, 196, 0.1);\n  }\n\n  .message-card.thinking .message-content {\n    padding: 1rem;\n  }\n\n  .message-header {\n    display: flex;\n    align-items: center;\n    gap: 0.75rem;\n    padding: 0.75rem 1rem;\n    background: rgba(78, 205, 196, 0.04);\n    border-bottom: 1px solid rgba(78, 205, 196, 0.08);\n  }\n\n  .participant-avatar {\n    width: 32px;\n    height: 32px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    border-radius: 50%;\n    background: linear-gradient(135deg, rgba(63, 185, 80, 0.25), rgba(63, 185, 80, 0.08));\n    border: 1px solid rgba(63, 185, 80, 0.35);\n    color: rgba(63, 185, 80, 0.95);\n    font-weight: 600;\n    font-size: 0.85rem;\n    overflow: hidden;\n  }\n\n  .participant-avatar.ai {\n    background: linear-gradient(135deg, rgba(88, 166, 255, 0.25), rgba(88, 166, 255, 0.08));\n    border-color: rgba(88, 166, 255, 0.35);\n    color: rgba(88, 166, 255, 0.95);\n  }\n\n  .participant-avatar img {\n    width: 100%;\n    height: 100%;\n    object-fit: cover;\n  }\n\n  .avatar-emoji {\n    line-height: 1;\n    font-size: 1rem;\n  }\n\n  .participant-info {\n    flex: 1;\n    display: flex;\n    align-items: center;\n    gap: 0.75rem;\n  }\n\n  .participant-name {\n    font-weight: 600;\n    color: rgba(230, 237, 243, 0.9);\n    font-size: 0.85rem;\n  }\n\n  .message-time {\n    font-size: 0.75rem;\n    color: rgba(230, 237, 243, 0.4);\n  }\n\n  .message-status {\n    display: flex;\n    align-items: center;\n    gap: 0.4rem;\n    font-size: 0.7rem;\n    color: var(--tachi-cyan, #4ecdc4);\n  }\n\n  .message-content {\n    padding: 1rem 1.25rem;\n    color: rgba(230, 237, 243, 0.9);\n    font-size: 0.9rem;\n    line-height: 1.65;\n  }\n\n  :global(.message-content p) {\n    margin: 0 0 0.75rem 0;\n  }\n\n  :global(.message-content p:last-child) {\n    margin-bottom: 0;\n  }\n\n  :global(.message-content h1),\n  :global(.message-content h2),\n  :global(.message-content h3),\n  :global(.message-content h4) {\n    margin: 1rem 0 0.5rem 0;\n    color: var(--text-primary, #e6edf3);\n    font-weight: 600;\n  }\n\n  :global(.message-content h1:first-child),\n  :global(.message-content h2:first-child),\n  :global(.message-content h3:first-child) {\n    margin-top: 0;\n  }\n\n  :global(.message-content strong) {\n    color: var(--text-primary, #e6edf3);\n    font-weight: 600;\n  }\n\n  :global(.message-content ul),\n  :global(.message-content ol) {\n    margin: 0.5rem 0;\n    padding-left: 1.5rem;\n  }\n\n  :global(.message-content li) {\n    margin-bottom: 0.35rem;\n  }\n\n  :global(.message-content code) {\n    background: rgba(78, 205, 196, 0.12);\n    padding: 0.15rem 0.35rem;\n    border-radius: 4px;\n    font-size: 0.85rem;\n    font-family: 'JetBrains Mono', monospace;\n    color: var(--tachi-cyan, #4ecdc4);\n  }\n\n  :global(.message-content pre) {\n    background: rgba(13, 17, 23, 0.6);\n    padding: 0.9rem 1rem;\n    border-radius: 8px;\n    overflow-x: auto;\n    margin: 0.75rem 0;\n    border: 1px solid rgba(78, 205, 196, 0.14);\n  }\n\n  :global(.message-content pre code) {\n    background: none;\n    padding: 0;\n    color: rgba(230, 237, 243, 0.85);\n  }\n\n  :global(.message-content blockquote) {\n    margin: 0.75rem 0;\n    padding-left: 1rem;\n    border-left: 3px solid rgba(78, 205, 196, 0.4);\n    color: rgba(230, 237, 243, 0.7);\n    font-style: italic;\n  }\n\n  .thinking-indicator {\n    display: flex;\n    align-items: center;\n    gap: 0.3rem;\n  }\n\n  .thinking-indicator .dot {\n    width: 6px;\n    height: 6px;\n    border-radius: 50%;\n    background: var(--tachi-cyan, #4ecdc4);\n    animation: thinking 1.4s infinite ease-in-out;\n  }\n\n  .thinking-indicator .dot:nth-child(2) {\n    animation-delay: 0.2s;\n  }\n\n  .thinking-indicator .dot:nth-child(3) {\n    animation-delay: 0.4s;\n  }\n\n  @keyframes thinking {\n    0%, 80%, 100% { opacity: 0.3; transform: scale(0.8); }\n    40% { opacity: 1; transform: scale(1); }\n  }\n\n  .typing-indicator {\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n    padding: 0.6rem 1rem;\n    background: rgba(78, 205, 196, 0.08);\n    border: 1px solid rgba(78, 205, 196, 0.15);\n    border-radius: 8px;\n    color: var(--tachi-cyan, #4ecdc4);\n    font-size: 0.8rem;\n  }\n\n  .artifacts-panel {\n    flex: 1;\n    overflow: auto;\n    padding: 1rem;\n    display: flex;\n    flex-direction: column;\n    gap: 0.9rem;\n  }\n\n  .artifact-card {\n    background: rgba(22, 27, 34, 0.55);\n    border: 1px solid rgba(78, 205, 196, 0.12);\n    border-radius: 12px;\n    overflow: hidden;\n  }\n\n  .artifact-head {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    padding: 0.7rem 0.9rem;\n    border-bottom: 1px solid rgba(78, 205, 196, 0.1);\n    background: rgba(78, 205, 196, 0.04);\n  }\n\n  .artifact-title {\n    display: inline-flex;\n    align-items: center;\n    gap: 0.5rem;\n    color: var(--tachi-cyan, #4ecdc4);\n    font-weight: 600;\n    font-size: 0.8rem;\n    letter-spacing: 0.4px;\n    text-transform: uppercase;\n  }\n\n  .artifact-body {\n    padding: 0.9rem 1rem;\n    color: rgba(230, 237, 243, 0.9);\n    line-height: 1.65;\n    font-size: 0.9rem;\n  }\n\n  .artifact-empty {\n    color: rgba(230, 237, 243, 0.5);\n    font-style: italic;\n  }\n\n  .artifact-error {\n    display: flex;\n    gap: 0.5rem;\n    align-items: center;\n    padding: 0.6rem 0.75rem;\n    border: 1px solid rgba(255, 107, 107, 0.2);\n    background: rgba(255, 107, 107, 0.08);\n    border-radius: 10px;\n    color: rgba(255, 107, 107, 0.95);\n    font-size: 0.85rem;\n  }\n\n  .prompt-bar {\n    display: flex;\n    flex-direction: column;\n    gap: 0.5rem;\n    padding: 0.75rem 1rem;\n    border-top: 1px solid rgba(78, 205, 196, 0.14);\n    background: rgba(13, 17, 23, 0.55);\n  }\n\n  .prompt-left {\n    display: flex;\n    align-items: center;\n    gap: 0.75rem;\n    justify-content: space-between;\n  }\n\n  .prompt-label {\n    display: inline-flex;\n    align-items: center;\n    gap: 0.45rem;\n    color: rgba(230, 237, 243, 0.75);\n    font-weight: 600;\n    font-size: 0.75rem;\n    text-transform: uppercase;\n    letter-spacing: 0.5px;\n  }\n\n  .prompt-select {\n    background: rgba(13, 17, 23, 0.35);\n    border: 1px solid rgba(78, 205, 196, 0.18);\n    color: rgba(230, 237, 243, 0.85);\n    border-radius: 10px;\n    padding: 0.35rem 0.6rem;\n    font-size: 0.85rem;\n  }\n\n  .prompt-hint {\n    font-size: 0.8rem;\n    color: rgba(230, 237, 243, 0.5);\n  }\n\n  .prompt-right {\n    display: grid;\n    grid-template-columns: 1fr auto;\n    gap: 0.75rem;\n    align-items: flex-start;\n  }\n\n  .prompt-input {\n    width: 100%;\n    resize: vertical;\n    min-height: 56px;\n    background: rgba(13, 17, 23, 0.35);\n    border: 1px solid rgba(78, 205, 196, 0.18);\n    border-radius: 12px;\n    padding: 0.6rem 0.75rem;\n    color: rgba(230, 237, 243, 0.9);\n    font-size: 0.9rem;\n    line-height: 1.5;\n  }\n\n  @media (max-width: 860px) {\n    .prompt-right {\n      grid-template-columns: 1fr;\n    }\n  }\n</style>\n","<script lang=\"ts\">\n  import { createEventDispatcher } from 'svelte';\n  import type { SessionPhase, ForgeSession } from '$lib/types/forge';\n  import { marked } from 'marked';\n  import { forgeSessionStore } from '$lib/stores/forgeSession';\n  import { deliberationStore } from '$lib/services/deliberation';\n  import Icon from '$lib/components/common/Icon.svelte';\n  import GlassPanel from '$lib/components/ui/GlassPanel.svelte';\n  import DeliberationView from './DeliberationView.svelte';\n\n  export let sessionId: string | null = null;\n  export let phase: SessionPhase = 'idle';\n\n  // Get the active session from the store\n  $: session = $forgeSessionStore.activeSession;\n  $: goalHtml = session?.goal ? marked(session.goal) : '';\n  $: participantCount = session?.participants?.length || 0;\n  $: aiCount = session?.participants?.filter(p => p.type === 'ai').length || 0;\n  $: humanCount = participantCount - aiCount;\n\n  function getPhaseConfig(phase: SessionPhase) {\n    const configs: Record<SessionPhase, { icon: string; label: string; color: string; description: string }> = {\n      idle: { icon: '‚è∏Ô∏è', label: 'READY', color: 'slate', description: 'Select or create a session' },\n      configuring: { icon: '‚öôÔ∏è', label: 'CONFIGURING', color: 'cyan', description: 'Session ready to begin deliberation' },\n      drafting: { icon: '‚úèÔ∏è', label: 'DRAFTING', color: 'blue', description: 'Participants are creating initial proposals' },\n      critiquing: { icon: 'üîç', label: 'CRITIQUE', color: 'amber', description: 'Reviewing and providing feedback' },\n      deliberating: { icon: 'üí¨', label: 'DELIBERATING', color: 'purple', description: 'Structured debate in progress' },\n      converging: { icon: 'üéØ', label: 'CONVERGING', color: 'green', description: 'Working towards consensus' },\n      completed: { icon: '‚úÖ', label: 'COMPLETE', color: 'emerald', description: 'Session concluded successfully' },\n      paused: { icon: '‚è∏Ô∏è', label: 'PAUSED', color: 'yellow', description: 'Session paused - resume when ready' },\n      error: { icon: '‚ö†Ô∏è', label: 'ERROR', color: 'red', description: 'An error occurred' }\n    };\n    return configs[phase] || configs.idle;\n  }\n\n  $: phaseConfig = getPhaseConfig(phase);\n\n  const dispatch = createEventDispatcher<{\n    startDeliberation: { sessionId: string };\n    editSession: { sessionId: string };\n  }>();\n\n  function handleStartDeliberation() {\n    if (!sessionId) return;\n    // Single-action flow: move to drafting AND immediately start the run.\n    forgeSessionStore.updateSessionPhase(sessionId, 'drafting');\n    if (session) {\n      deliberationStore.clearMessages();\n      // Ensure the session object we pass reflects the new phase\n      deliberationStore.startDeliberation({ ...session, phase: 'drafting' });\n    }\n  }\n\n  function handleEditSession() {\n    if (!sessionId) return;\n    dispatch('editSession', { sessionId });\n  }\n\n  function formatDate(date: Date | undefined): string {\n    if (!date) return 'Unknown';\n    return new Intl.DateTimeFormat('en-US', {\n      month: 'short',\n      day: 'numeric',\n      year: 'numeric',\n      hour: 'numeric',\n      minute: '2-digit'\n    }).format(date);\n  }\n</script>\n\n<div class=\"main-content-area\" data-testid=\"main-content-area\" data-phase={phase}>\n  {#if session && phase !== 'idle'}\n    <!-- Active Session View -->\n    <div class=\"session-view\">\n      <!-- Session Header -->\n      <header class=\"session-header\">\n        <div class=\"header-left\">\n          <div class=\"session-icon\">\n            <img \n              src=\"/icons/Iconfactory-Ghost-In-The-Shell-Fuchikoma-Blue.32.png\" \n              alt=\"Tachikoma\" \n              class=\"session-tachi-icon\"\n            />\n          </div>\n          <div class=\"session-meta\">\n            <h1 class=\"session-title\">{session.name || 'Untitled Session'}</h1>\n            <div class=\"session-details\">\n              <span class=\"phase-badge\" data-color={phaseConfig.color}>\n                {phaseConfig.icon} {phaseConfig.label}\n              </span>\n              <span class=\"meta-divider\">‚Ä¢</span>\n              <span class=\"meta-item\">{humanCount} human{humanCount !== 1 ? 's' : ''}</span>\n              <span class=\"meta-divider\">‚Ä¢</span>\n              <span class=\"meta-item\">{aiCount} AI agent{aiCount !== 1 ? 's' : ''}</span>\n              {#if session.createdAt}\n                <span class=\"meta-divider\">‚Ä¢</span>\n                <span class=\"meta-item\">Created {formatDate(session.createdAt)}</span>\n              {/if}\n            </div>\n          </div>\n        </div>\n        <div class=\"header-actions\">\n          {#if phase === 'configuring'}\n            <button type=\"button\" class=\"btn btn-secondary\" on:click={handleEditSession}>\n              <Icon name=\"settings\" size={16} />\n              Edit\n            </button>\n            <button type=\"button\" class=\"btn btn-primary\" on:click={handleStartDeliberation}>\n              <Icon name=\"zap\" size={16} />\n              Run Initial Drafts\n            </button>\n          {:else if phase === 'paused'}\n            <button type=\"button\" class=\"btn btn-primary\" on:click={handleStartDeliberation}>\n              <Icon name=\"play\" size={16} />\n              Resume (Drafts)\n            </button>\n          {/if}\n        </div>\n      </header>\n\n      <!-- Main Content -->\n      <div class=\"session-content\">\n        <!-- Goal Section - Hero -->\n        <section class=\"goal-section\">\n          <div class=\"section-header\">\n            <div class=\"section-title\">\n              <span class=\"section-icon\">üéØ</span>\n              <h2>Session Goal</h2>\n            </div>\n            <span class=\"section-tag\">OBJECTIVE</span>\n          </div>\n          <div class=\"goal-body\">\n            {#if goalHtml}\n              <div class=\"goal-text\" data-testid=\"session-goal\">\n                {@html goalHtml}\n              </div>\n            {:else}\n              <p class=\"goal-empty\">No goal defined for this session.</p>\n            {/if}\n          </div>\n        </section>\n\n        <!-- Session Info Grid -->\n        <div class=\"info-grid\">\n          <!-- Participants Summary -->\n          <section class=\"info-card participants-card\">\n            <div class=\"card-header\">\n              <Icon name=\"users\" size={18} />\n              <h3>Participants</h3>\n              <span class=\"card-count\">{participantCount}</span>\n            </div>\n            <div class=\"card-body\">\n              {#if session.participants && session.participants.length > 0}\n                <ul class=\"participant-list\">\n                  {#each session.participants.slice(0, 6) as participant}\n                    <li class=\"participant-row\">\n                      <span class=\"participant-avatar\" class:ai={participant.type === 'ai'}>\n                        {participant.name.charAt(0).toUpperCase()}\n                      </span>\n                      <div class=\"participant-info\">\n                        <span class=\"participant-name\">{participant.name}</span>\n                        <span class=\"participant-role\">{participant.role}</span>\n                      </div>\n                      <span class=\"participant-type\" class:ai={participant.type === 'ai'}>\n                        {participant.type.toUpperCase()}\n                      </span>\n                    </li>\n                  {/each}\n                  {#if session.participants.length > 6}\n                    <li class=\"participant-more\">\n                      +{session.participants.length - 6} more participants\n                    </li>\n                  {/if}\n                </ul>\n              {:else}\n                <p class=\"card-empty\">No participants configured</p>\n              {/if}\n            </div>\n          </section>\n\n          <!-- Oracle -->\n          <section class=\"info-card oracle-card\">\n            <div class=\"card-header\">\n              <Icon name=\"brain\" size={18} />\n              <h3>Oracle</h3>\n            </div>\n            <div class=\"card-body\">\n              {#if session.oracle}\n                <div class=\"oracle-info\">\n                  <div class=\"oracle-name\">{session.oracle.name}</div>\n                  <div class=\"oracle-type\">{session.oracle.type}</div>\n                  {#if session.oracle.estimatedCostPerRound}\n                    <div class=\"oracle-cost\">\n                      ~${session.oracle.estimatedCostPerRound.toFixed(4)}/round\n                    </div>\n                  {/if}\n                </div>\n              {:else}\n                <p class=\"card-empty\">No oracle selected</p>\n              {/if}\n            </div>\n          </section>\n\n          <!-- Session Config -->\n          <section class=\"info-card config-card\">\n            <div class=\"card-header\">\n              <Icon name=\"settings\" size={18} />\n              <h3>Configuration</h3>\n            </div>\n            <div class=\"card-body\">\n              {#if session.config}\n                <dl class=\"config-list\">\n                  <div class=\"config-item\">\n                    <dt>Max Rounds</dt>\n                    <dd>{session.config.maxRounds || 5}</dd>\n                  </div>\n                  <div class=\"config-item\">\n                    <dt>Convergence</dt>\n                    <dd>{((session.config.convergenceThreshold || 0.8) * 100).toFixed(0)}%</dd>\n                  </div>\n                  <div class=\"config-item\">\n                    <dt>Timeout</dt>\n                    <dd>{session.config.timeoutMinutes || 60}min</dd>\n                  </div>\n                  <div class=\"config-item\">\n                    <dt>Human Override</dt>\n                    <dd>{session.config.allowHumanIntervention ? 'Enabled' : 'Disabled'}</dd>\n                  </div>\n                </dl>\n              {:else}\n                <p class=\"card-empty\">Default configuration</p>\n              {/if}\n            </div>\n          </section>\n        </div>\n\n        <!-- Phase-specific content: Deliberation View -->\n        {#if phase === 'drafting' || phase === 'critiquing' || phase === 'deliberating' || phase === 'converging'}\n          <DeliberationView {session} {phase} />\n        {/if}\n\n        {#if phase === 'completed'}\n          <section class=\"results-section\">\n            <div class=\"section-header\">\n              <div class=\"section-title\">\n                <span class=\"section-icon\">üìã</span>\n                <h2>Session Results</h2>\n              </div>\n              <span class=\"section-tag\">COMPLETE</span>\n            </div>\n            <div class=\"results-body\">\n              <p>Review the outcomes and decisions from this deliberation session.</p>\n              <div class=\"results-placeholder\">\n                <Icon name=\"file-text\" size={48} />\n                <p>Results display coming soon</p>\n              </div>\n            </div>\n          </section>\n        {/if}\n      </div>\n    </div>\n  {:else}\n    <!-- Welcome / Empty State -->\n    <div class=\"welcome-view\">\n      <div class=\"welcome-content\">\n        <div class=\"welcome-icon\">üî•</div>\n        <h1>Spec Forge</h1>\n        <p class=\"welcome-tagline\">Multi-model deliberation engine for spec creation and refinement</p>\n        \n        <div class=\"welcome-actions\">\n          <button type=\"button\" class=\"btn btn-primary btn-large\">\n            <Icon name=\"zap\" size={20} />\n            Create New Session\n          </button>\n        </div>\n\n        <div class=\"welcome-features\">\n          <div class=\"feature-card\">\n            <div class=\"feature-icon\">üë•</div>\n            <h3>Multi-Agent</h3>\n            <p>Bring together AI models with different perspectives</p>\n          </div>\n          <div class=\"feature-card\">\n            <div class=\"feature-icon\">üéØ</div>\n            <h3>Goal-Driven</h3>\n            <p>Define objectives and let agents deliberate solutions</p>\n          </div>\n          <div class=\"feature-card\">\n            <div class=\"feature-icon\">‚ö°</div>\n            <h3>Convergence</h3>\n            <p>Structured rounds to reach consensus on complex topics</p>\n          </div>\n        </div>\n      </div>\n    </div>\n  {/if}\n</div>\n\n<style>\n  .main-content-area {\n    display: flex;\n    flex-direction: column;\n    height: 100%;\n    overflow: hidden;\n    background: linear-gradient(180deg, rgba(13, 17, 23, 0.02) 0%, rgba(13, 17, 23, 0.08) 100%);\n  }\n\n  /* Session View */\n  .session-view {\n    display: flex;\n    flex-direction: column;\n    height: 100%;\n    overflow: hidden;\n  }\n\n  .session-header {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    gap: 1.5rem;\n    padding: 1.25rem 1.75rem;\n    background: rgba(13, 17, 23, 0.45);\n    border-bottom: 1px solid rgba(78, 205, 196, 0.14);\n    flex-shrink: 0;\n  }\n\n  .header-left {\n    display: flex;\n    align-items: center;\n    gap: 1rem;\n    min-width: 0;\n  }\n\n  .session-icon {\n    width: 48px;\n    height: 48px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    border-radius: 12px;\n    background: linear-gradient(135deg, rgba(78, 205, 196, 0.18), rgba(78, 205, 196, 0.05));\n    border: 1px solid rgba(78, 205, 196, 0.28);\n    color: var(--tachi-cyan, #4ecdc4);\n    flex-shrink: 0;\n  }\n  \n  .session-tachi-icon {\n    width: 32px;\n    height: 32px;\n    object-fit: contain;\n    filter: drop-shadow(0 0 8px var(--tachi-cyan, #4ecdc4));\n    transition: filter 0.3s ease;\n  }\n  \n  .session-icon:hover .session-tachi-icon {\n    filter: drop-shadow(0 0 12px var(--tachi-cyan, #4ecdc4)) drop-shadow(0 0 4px var(--tachi-cyan, #4ecdc4));\n  }\n\n  .session-meta {\n    min-width: 0;\n  }\n\n  .session-title {\n    margin: 0 0 0.35rem 0;\n    font-size: 1.35rem;\n    font-weight: 700;\n    color: var(--text-primary, #e6edf3);\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n  }\n\n  .session-details {\n    display: flex;\n    align-items: center;\n    gap: 0.6rem;\n    flex-wrap: wrap;\n    font-size: 0.8rem;\n    color: rgba(230, 237, 243, 0.6);\n  }\n\n  .phase-badge {\n    display: inline-flex;\n    align-items: center;\n    gap: 0.35rem;\n    padding: 0.2rem 0.6rem;\n    border-radius: 999px;\n    font-size: 0.7rem;\n    font-weight: 600;\n    letter-spacing: 0.5px;\n    text-transform: uppercase;\n    background: rgba(78, 205, 196, 0.12);\n    color: var(--tachi-cyan, #4ecdc4);\n    border: 1px solid rgba(78, 205, 196, 0.22);\n  }\n\n  .meta-divider {\n    opacity: 0.4;\n  }\n\n  .header-actions {\n    display: flex;\n    gap: 0.75rem;\n    flex-shrink: 0;\n  }\n\n  .btn {\n    display: inline-flex;\n    align-items: center;\n    gap: 0.5rem;\n    padding: 0.6rem 1rem;\n    border-radius: 10px;\n    font-size: 0.85rem;\n    font-weight: 500;\n    cursor: pointer;\n    transition: all 0.15s ease;\n    border: 1px solid transparent;\n  }\n\n  .btn-primary {\n    background: linear-gradient(135deg, var(--tachi-cyan-dark, #2d7a7a), var(--tachi-cyan, #4ecdc4));\n    color: var(--bg-primary, #0d1117);\n    border-color: rgba(78, 205, 196, 0.5);\n  }\n\n  .btn-primary:hover {\n    background: linear-gradient(135deg, var(--tachi-cyan, #4ecdc4), var(--tachi-cyan-bright, #6ee7df));\n    box-shadow: 0 0 20px rgba(78, 205, 196, 0.25);\n  }\n\n  .btn-secondary {\n    background: rgba(13, 17, 23, 0.35);\n    color: rgba(230, 237, 243, 0.85);\n    border-color: rgba(78, 205, 196, 0.18);\n  }\n\n  .btn-secondary:hover {\n    background: rgba(78, 205, 196, 0.1);\n    border-color: rgba(78, 205, 196, 0.35);\n  }\n\n  .btn-large {\n    padding: 0.9rem 1.5rem;\n    font-size: 0.95rem;\n  }\n\n  /* Session Content */\n  .session-content {\n    flex: 1;\n    overflow-y: auto;\n    padding: 1.75rem;\n    display: flex;\n    flex-direction: column;\n    gap: 1.5rem;\n  }\n\n  /* Goal Section */\n  .goal-section {\n    background: rgba(13, 17, 23, 0.45);\n    border: 1px solid rgba(78, 205, 196, 0.22);\n    border-radius: 16px;\n    overflow: hidden;\n  }\n\n  .section-header {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    padding: 1rem 1.25rem;\n    background: rgba(78, 205, 196, 0.06);\n    border-bottom: 1px solid rgba(78, 205, 196, 0.14);\n  }\n\n  .section-title {\n    display: flex;\n    align-items: center;\n    gap: 0.6rem;\n  }\n\n  .section-icon {\n    font-size: 1.1rem;\n  }\n\n  .section-title h2 {\n    margin: 0;\n    font-size: 0.95rem;\n    font-weight: 600;\n    color: var(--tachi-cyan, #4ecdc4);\n    letter-spacing: 0.5px;\n    text-transform: uppercase;\n  }\n\n  .section-tag {\n    font-size: 0.65rem;\n    font-weight: 600;\n    letter-spacing: 1px;\n    color: rgba(78, 205, 196, 0.7);\n    padding: 0.2rem 0.5rem;\n    background: rgba(78, 205, 196, 0.1);\n    border-radius: 4px;\n  }\n\n  .goal-body {\n    padding: 1.25rem 1.5rem;\n  }\n\n  .goal-text {\n    color: rgba(230, 237, 243, 0.9);\n    line-height: 1.75;\n    font-size: 1rem;\n  }\n\n  :global(.goal-text p) {\n    margin: 0 0 1rem 0;\n  }\n\n  :global(.goal-text p:last-child) {\n    margin-bottom: 0;\n  }\n\n  :global(.goal-text h1),\n  :global(.goal-text h2),\n  :global(.goal-text h3) {\n    margin: 1.5rem 0 0.75rem 0;\n    color: var(--text-primary, #e6edf3);\n  }\n\n  :global(.goal-text h1:first-child),\n  :global(.goal-text h2:first-child),\n  :global(.goal-text h3:first-child) {\n    margin-top: 0;\n  }\n\n  :global(.goal-text ul),\n  :global(.goal-text ol) {\n    margin: 0.75rem 0;\n    padding-left: 1.5rem;\n  }\n\n  :global(.goal-text li) {\n    margin-bottom: 0.4rem;\n  }\n\n  :global(.goal-text code) {\n    background: rgba(78, 205, 196, 0.12);\n    padding: 0.15rem 0.4rem;\n    border-radius: 4px;\n    font-size: 0.9rem;\n    font-family: 'JetBrains Mono', ui-monospace, monospace;\n    color: var(--tachi-cyan, #4ecdc4);\n  }\n\n  :global(.goal-text pre) {\n    background: rgba(13, 17, 23, 0.6);\n    padding: 1rem;\n    border-radius: 8px;\n    overflow-x: auto;\n    margin: 1rem 0;\n    border: 1px solid rgba(78, 205, 196, 0.14);\n  }\n\n  :global(.goal-text pre code) {\n    background: none;\n    padding: 0;\n    color: rgba(230, 237, 243, 0.85);\n  }\n\n  :global(.goal-text strong) {\n    color: var(--text-primary, #e6edf3);\n    font-weight: 600;\n  }\n\n  .goal-empty {\n    color: rgba(230, 237, 243, 0.45);\n    font-style: italic;\n  }\n\n  /* Info Grid */\n  .info-grid {\n    display: grid;\n    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));\n    gap: 1rem;\n  }\n\n  .info-card {\n    background: rgba(13, 17, 23, 0.35);\n    border: 1px solid rgba(78, 205, 196, 0.14);\n    border-radius: 14px;\n    overflow: hidden;\n  }\n\n  .card-header {\n    display: flex;\n    align-items: center;\n    gap: 0.6rem;\n    padding: 0.9rem 1rem;\n    background: rgba(78, 205, 196, 0.04);\n    border-bottom: 1px solid rgba(78, 205, 196, 0.1);\n    color: var(--tachi-cyan, #4ecdc4);\n  }\n\n  .card-header h3 {\n    margin: 0;\n    font-size: 0.85rem;\n    font-weight: 600;\n    letter-spacing: 0.5px;\n    text-transform: uppercase;\n    flex: 1;\n  }\n\n  .card-count {\n    font-size: 0.75rem;\n    font-weight: 600;\n    padding: 0.15rem 0.5rem;\n    background: rgba(78, 205, 196, 0.15);\n    border-radius: 999px;\n  }\n\n  .card-body {\n    padding: 1rem;\n  }\n\n  .card-empty {\n    color: rgba(230, 237, 243, 0.4);\n    font-size: 0.85rem;\n    margin: 0;\n  }\n\n  /* Participants */\n  .participant-list {\n    list-style: none;\n    margin: 0;\n    padding: 0;\n    display: flex;\n    flex-direction: column;\n    gap: 0.6rem;\n  }\n\n  .participant-row {\n    display: flex;\n    align-items: center;\n    gap: 0.75rem;\n    padding: 0.5rem 0.6rem;\n    background: rgba(22, 27, 34, 0.4);\n    border-radius: 10px;\n  }\n\n  .participant-avatar {\n    width: 32px;\n    height: 32px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    border-radius: 50%;\n    background: linear-gradient(135deg, rgba(63, 185, 80, 0.3), rgba(63, 185, 80, 0.1));\n    border: 1px solid rgba(63, 185, 80, 0.3);\n    color: rgba(63, 185, 80, 0.95);\n    font-size: 0.8rem;\n    font-weight: 600;\n  }\n\n  .participant-avatar.ai {\n    background: linear-gradient(135deg, rgba(88, 166, 255, 0.3), rgba(88, 166, 255, 0.1));\n    border-color: rgba(88, 166, 255, 0.3);\n    color: rgba(88, 166, 255, 0.95);\n  }\n\n  .participant-info {\n    flex: 1;\n    min-width: 0;\n  }\n\n  .participant-name {\n    display: block;\n    font-size: 0.85rem;\n    font-weight: 500;\n    color: rgba(230, 237, 243, 0.9);\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n  }\n\n  .participant-role {\n    display: block;\n    font-size: 0.75rem;\n    color: rgba(230, 237, 243, 0.5);\n  }\n\n  .participant-type {\n    font-size: 0.6rem;\n    font-weight: 600;\n    letter-spacing: 0.5px;\n    padding: 0.15rem 0.4rem;\n    border-radius: 4px;\n    background: rgba(63, 185, 80, 0.12);\n    color: rgba(63, 185, 80, 0.9);\n  }\n\n  .participant-type.ai {\n    background: rgba(88, 166, 255, 0.12);\n    color: rgba(88, 166, 255, 0.9);\n  }\n\n  .participant-more {\n    text-align: center;\n    font-size: 0.8rem;\n    color: rgba(230, 237, 243, 0.5);\n    padding: 0.5rem;\n  }\n\n  /* Oracle */\n  .oracle-info {\n    display: flex;\n    flex-direction: column;\n    gap: 0.35rem;\n  }\n\n  .oracle-name {\n    font-size: 1rem;\n    font-weight: 600;\n    color: rgba(230, 237, 243, 0.9);\n  }\n\n  .oracle-type {\n    font-size: 0.8rem;\n    color: var(--tachi-cyan, #4ecdc4);\n    text-transform: uppercase;\n    letter-spacing: 0.5px;\n  }\n\n  .oracle-cost {\n    font-size: 0.8rem;\n    color: rgba(230, 237, 243, 0.5);\n    font-family: 'JetBrains Mono', monospace;\n  }\n\n  /* Config */\n  .config-list {\n    margin: 0;\n    display: grid;\n    grid-template-columns: 1fr 1fr;\n    gap: 0.6rem;\n  }\n\n  .config-item {\n    display: flex;\n    flex-direction: column;\n    gap: 0.15rem;\n  }\n\n  .config-item dt {\n    font-size: 0.7rem;\n    color: rgba(230, 237, 243, 0.5);\n    text-transform: uppercase;\n    letter-spacing: 0.5px;\n  }\n\n  .config-item dd {\n    margin: 0;\n    font-size: 0.9rem;\n    font-weight: 500;\n    color: rgba(230, 237, 243, 0.85);\n  }\n\n  /* Activity/Results Sections */\n  .activity-section,\n  .results-section {\n    background: rgba(13, 17, 23, 0.35);\n    border: 1px solid rgba(78, 205, 196, 0.14);\n    border-radius: 14px;\n    overflow: hidden;\n  }\n\n  .activity-body,\n  .results-body {\n    padding: 1.5rem;\n    text-align: center;\n  }\n\n  .activity-description {\n    color: rgba(230, 237, 243, 0.7);\n    margin-bottom: 1.5rem;\n  }\n\n  .activity-placeholder,\n  .results-placeholder {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    gap: 1rem;\n    padding: 2rem;\n    color: rgba(230, 237, 243, 0.4);\n  }\n\n  /* Welcome View */\n  .welcome-view {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    height: 100%;\n    padding: 2rem;\n  }\n\n  .welcome-content {\n    max-width: 700px;\n    text-align: center;\n  }\n\n  .welcome-icon {\n    font-size: 4rem;\n    margin-bottom: 1rem;\n  }\n\n  .welcome-content h1 {\n    margin: 0 0 0.5rem 0;\n    font-size: 2.5rem;\n    font-weight: 700;\n    color: var(--text-primary, #e6edf3);\n    letter-spacing: 2px;\n    text-transform: uppercase;\n  }\n\n  .welcome-tagline {\n    font-size: 1rem;\n    color: rgba(230, 237, 243, 0.6);\n    margin-bottom: 2rem;\n  }\n\n  .welcome-actions {\n    margin-bottom: 3rem;\n  }\n\n  .welcome-features {\n    display: grid;\n    grid-template-columns: repeat(3, 1fr);\n    gap: 1.5rem;\n  }\n\n  .feature-card {\n    padding: 1.5rem;\n    background: rgba(13, 17, 23, 0.35);\n    border: 1px solid rgba(78, 205, 196, 0.14);\n    border-radius: 14px;\n    text-align: center;\n  }\n\n  .feature-card .feature-icon {\n    font-size: 2rem;\n    margin-bottom: 0.75rem;\n  }\n\n  .feature-card h3 {\n    margin: 0 0 0.5rem 0;\n    font-size: 1rem;\n    color: var(--text-primary, #e6edf3);\n  }\n\n  .feature-card p {\n    margin: 0;\n    font-size: 0.85rem;\n    color: rgba(230, 237, 243, 0.6);\n    line-height: 1.4;\n  }\n\n  @media (max-width: 768px) {\n    .session-header {\n      flex-direction: column;\n      align-items: flex-start;\n    }\n\n    .header-actions {\n      width: 100%;\n    }\n\n    .header-actions .btn {\n      flex: 1;\n    }\n\n    .info-grid {\n      grid-template-columns: 1fr;\n    }\n\n    .welcome-features {\n      grid-template-columns: 1fr;\n    }\n\n    .config-list {\n      grid-template-columns: 1fr;\n    }\n  }\n</style>\n","<script lang=\"ts\">\n  import type { ForgeSession } from '$lib/types/forge';\n  import { forgeService, type ForgeOutputFormat } from '$lib/services/forgeService';\n  import Icon from '$lib/components/common/Icon.svelte';\n  import Spinner from '$lib/components/ui/Spinner/Spinner.svelte';\n\n  export let session: ForgeSession | null = null;\n  export let visible: boolean = false;\n\n  let isExporting = false;\n  let exportError: string | null = null;\n  let previewContent: string | null = null;\n  let previewFormat: ForgeOutputFormat | null = null;\n\n  $: hasResults = session?.hasResults ?? false;\n  $: completedRounds = session?.rounds.filter(r => r.status === 'completed') ?? [];\n  $: totalContributions = completedRounds.reduce((sum, round) => sum + round.contributions.length, 0);\n  $: totalCritiques = completedRounds.reduce((sum, round) => sum + round.critiques.length, 0);\n\n  const outputFormats: { value: ForgeOutputFormat; label: string; icon: string }[] = [\n    { value: 'markdown', label: 'Markdown', icon: 'file-text' },\n    { value: 'json', label: 'JSON', icon: 'code' },\n    { value: 'yaml', label: 'YAML', icon: 'file' },\n    { value: 'html', label: 'HTML', icon: 'globe' },\n    { value: 'beads', label: 'Beads Issue', icon: 'circle' }\n  ];\n\n  async function handleExport(format: ForgeOutputFormat) {\n    if (!session) return;\n    \n    isExporting = true;\n    exportError = null;\n    \n    try {\n      const result = await forgeService.generateOutput({\n        sessionId: session.id,\n        format,\n        includeMetadata: true,\n        includeHistory: true,\n        includeMetrics: true\n      });\n      \n      // Download the file\n      downloadFile(result.content, result.filename, getMimeType(format));\n    } catch (error) {\n      exportError = error instanceof Error ? error.message : 'Export failed';\n    } finally {\n      isExporting = false;\n    }\n  }\n\n  async function handlePreview(format: ForgeOutputFormat) {\n    if (!session) return;\n    \n    isExporting = true;\n    exportError = null;\n    \n    try {\n      const result = await forgeService.generateOutput({\n        sessionId: session.id,\n        format,\n        includeMetadata: true\n      });\n      \n      previewContent = result.content;\n      previewFormat = format;\n    } catch (error) {\n      exportError = error instanceof Error ? error.message : 'Preview failed';\n    } finally {\n      isExporting = false;\n    }\n  }\n\n  function closePreview() {\n    previewContent = null;\n    previewFormat = null;\n  }\n\n  function downloadFile(content: string, filename: string, mimeType: string) {\n    const blob = new Blob([content], { type: mimeType });\n    const url = URL.createObjectURL(blob);\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = filename;\n    document.body.appendChild(a);\n    a.click();\n    document.body.removeChild(a);\n    URL.revokeObjectURL(url);\n  }\n\n  function getMimeType(format: ForgeOutputFormat): string {\n    const mimeTypes: Record<ForgeOutputFormat, string> = {\n      markdown: 'text/markdown',\n      json: 'application/json',\n      yaml: 'text/yaml',\n      html: 'text/html',\n      plain: 'text/plain',\n      beads: 'text/yaml'\n    };\n    return mimeTypes[format] || 'text/plain';\n  }\n\n  function formatTimestamp(date: Date): string {\n    return new Intl.DateTimeFormat('en-US', {\n      hour: '2-digit',\n      minute: '2-digit',\n      second: '2-digit'\n    }).format(date);\n  }\n\n  function getContributionTypeColor(type: string): string {\n    switch (type) {\n      case 'proposal': return '#4a9eff';\n      case 'refinement': return '#f39c12';\n      case 'alternative': return '#e74c3c';\n      default: return '#95a5a6';\n    }\n  }\n\n  function getCritiqueColor(severity: string): string {\n    switch (severity) {\n      case 'critical': return '#e74c3c';\n      case 'concern': return '#f39c12';\n      case 'suggestion': return '#3498db';\n      case 'info': return '#95a5a6';\n      default: return '#95a5a6';\n    }\n  }\n</script>\n\n<div class=\"result-panel\" class:visible>\n  <header class=\"panel-header\">\n    <h2>Session Results</h2>\n    {#if session}\n      <div class=\"session-status\">\n        <span class=\"phase-badge phase-{session.phase}\">{session.phase}</span>\n      </div>\n    {/if}\n  </header>\n\n  <div class=\"panel-content\">\n    {#if !session}\n      <div class=\"empty-state\">\n        <p>No active session</p>\n      </div>\n    {:else if !hasResults}\n      <div class=\"empty-state\">\n        <p>No results yet</p>\n        <small>Results will appear as the session progresses</small>\n      </div>\n    {:else}\n      <div class=\"results-summary\">\n        <div class=\"stat-card\">\n          <div class=\"stat-value\">{completedRounds.length}</div>\n          <div class=\"stat-label\">Rounds Completed</div>\n        </div>\n        <div class=\"stat-card\">\n          <div class=\"stat-value\">{totalContributions}</div>\n          <div class=\"stat-label\">Contributions</div>\n        </div>\n        <div class=\"stat-card\">\n          <div class=\"stat-value\">{totalCritiques}</div>\n          <div class=\"stat-label\">Critiques</div>\n        </div>\n      </div>\n\n      <div class=\"results-sections\">\n        <section class=\"rounds-section\">\n          <h3>Round History</h3>\n          <div class=\"rounds-list\">\n            {#each completedRounds as round (round.id)}\n              <div class=\"round-item\">\n                <div class=\"round-header\">\n                  <span class=\"round-number\">Round {round.number}</span>\n                  <span class=\"round-duration\">\n                    {#if round.endTime}\n                      {Math.round((round.endTime.getTime() - round.startTime.getTime()) / 60000)}m\n                    {/if}\n                  </span>\n                </div>\n                \n                <div class=\"round-contributions\">\n                  {#each round.contributions as contribution (contribution.id)}\n                    <div class=\"contribution-item\">\n                      <div class=\"contribution-header\">\n                        <div \n                          class=\"contribution-type\"\n                          style=\"background-color: {getContributionTypeColor(contribution.type)}\"\n                        >\n                          {contribution.type}\n                        </div>\n                        <span class=\"timestamp\">\n                          {formatTimestamp(contribution.timestamp)}\n                        </span>\n                      </div>\n                      <div class=\"contribution-content\">\n                        {contribution.content.substring(0, 100)}...\n                      </div>\n                    </div>\n                  {/each}\n                </div>\n\n                <div class=\"round-critiques\">\n                  {#each round.critiques as critique (critique.id)}\n                    <div class=\"critique-item\">\n                      <div class=\"critique-header\">\n                        <div \n                          class=\"critique-severity\"\n                          style=\"background-color: {getCritiqueColor(critique.severity)}\"\n                        >\n                          {critique.severity}\n                        </div>\n                        <span class=\"timestamp\">\n                          {formatTimestamp(critique.timestamp)}\n                        </span>\n                      </div>\n                      <div class=\"critique-content\">\n                        {critique.content.substring(0, 80)}...\n                      </div>\n                    </div>\n                  {/each}\n                </div>\n              </div>\n            {/each}\n          </div>\n        </section>\n\n        <section class=\"insights-section\">\n          <h3>Key Insights</h3>\n          <div class=\"insights-placeholder\">\n            <p>Insights will be generated automatically as the session progresses.</p>\n          </div>\n        </section>\n\n        <!-- Export Section -->\n        <section class=\"export-section\">\n          <h3>Export Results</h3>\n          {#if exportError}\n            <div class=\"export-error\">\n              <Icon name=\"alert-triangle\" size={14} />\n              <span>{exportError}</span>\n            </div>\n          {/if}\n          \n          <div class=\"export-buttons\">\n            {#each outputFormats as format}\n              <div class=\"export-button-group\">\n                <button\n                  class=\"export-btn\"\n                  on:click={() => handleExport(format.value)}\n                  disabled={isExporting}\n                  title=\"Download as {format.label}\"\n                >\n                  {#if isExporting}\n                    <Spinner size={14} />\n                  {:else}\n                    <Icon name={format.icon} size={16} />\n                  {/if}\n                  <span>{format.label}</span>\n                </button>\n                <button\n                  class=\"preview-btn\"\n                  on:click={() => handlePreview(format.value)}\n                  disabled={isExporting}\n                  title=\"Preview {format.label}\"\n                >\n                  <Icon name=\"eye\" size={14} />\n                </button>\n              </div>\n            {/each}\n          </div>\n        </section>\n      </div>\n    {/if}\n  </div>\n\n  <!-- Preview Modal -->\n  {#if previewContent && previewFormat}\n    <!-- svelte-ignore a11y-click-events-have-key-events -->\n    <div class=\"preview-overlay\" on:click={closePreview}>\n      <!-- svelte-ignore a11y-click-events-have-key-events a11y-no-static-element-interactions -->\n      <div class=\"preview-modal\" on:click|stopPropagation={() => {}} role=\"dialog\" aria-modal=\"true\">\n        <div class=\"preview-header\">\n          <h3>Preview: {previewFormat.toUpperCase()}</h3>\n          <button class=\"close-btn\" on:click={closePreview} aria-label=\"Close preview\">\n            <Icon name=\"x\" size={18} />\n          </button>\n        </div>\n        <div class=\"preview-content\">\n          <pre><code>{previewContent}</code></pre>\n        </div>\n        <div class=\"preview-actions\">\n          <button class=\"btn-secondary\" on:click={closePreview}>Close</button>\n          <button class=\"btn-primary\" on:click={() => previewFormat && handleExport(previewFormat)}>\n            <Icon name=\"download\" size={16} />\n            Download\n          </button>\n        </div>\n      </div>\n    </div>\n  {/if}\n</div>\n\n<style>\n  .result-panel {\n    display: flex;\n    flex-direction: column;\n    height: 100%;\n    overflow: hidden;\n  }\n\n  .panel-header {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    padding: 1rem;\n    border-bottom: 1px solid var(--border-color, #2a2a4a);\n    background: var(--panel-header-bg, #1a1a2e);\n  }\n\n  .panel-header h2 {\n    font-size: 1.1rem;\n    font-weight: 600;\n    color: var(--forge-text, #eaeaea);\n    margin: 0;\n  }\n\n  .session-status {\n    display: flex;\n    gap: 0.5rem;\n    align-items: center;\n  }\n\n  .phase-badge {\n    padding: 0.25rem 0.5rem;\n    border-radius: 12px;\n    font-size: 0.75rem;\n    font-weight: 500;\n    text-transform: capitalize;\n  }\n\n  .phase-idle { background: #374151; color: #9CA3AF; }\n  .phase-configuring { background: #1E40AF; color: #DBEAFE; }\n  .phase-drafting { background: #059669; color: #D1FAE5; }\n  .phase-critiquing { background: #DC2626; color: #FEE2E2; }\n  .phase-deliberating { background: #7C2D12; color: #FED7AA; }\n  .phase-converging { background: #7C3AED; color: #EDE9FE; }\n  .phase-completed { background: #166534; color: #DCFCE7; }\n  .phase-paused { background: #CA8A04; color: #FEF3C7; }\n  .phase-error { background: #DC2626; color: #FEE2E2; }\n\n  .panel-content {\n    flex: 1;\n    overflow-y: auto;\n    padding: 1rem;\n  }\n\n  .empty-state {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    text-align: center;\n    padding: 2rem;\n    color: var(--text-muted, #6b7280);\n  }\n\n  .empty-state small {\n    margin-top: 0.5rem;\n    font-size: 0.875rem;\n    opacity: 0.7;\n  }\n\n  .results-summary {\n    display: flex;\n    gap: 1rem;\n    margin-bottom: 2rem;\n  }\n\n  .stat-card {\n    flex: 1;\n    background: var(--card-bg, #1e293b);\n    border: 1px solid var(--border-color, #2a2a4a);\n    border-radius: 8px;\n    padding: 1rem;\n    text-align: center;\n  }\n\n  .stat-value {\n    font-size: 1.5rem;\n    font-weight: 600;\n    color: var(--accent-color, #4a9eff);\n    margin-bottom: 0.25rem;\n  }\n\n  .stat-label {\n    font-size: 0.75rem;\n    color: var(--text-muted, #6b7280);\n    text-transform: uppercase;\n    letter-spacing: 0.05em;\n  }\n\n  .results-sections {\n    display: flex;\n    flex-direction: column;\n    gap: 2rem;\n  }\n\n  .rounds-section h3,\n  .insights-section h3 {\n    font-size: 1rem;\n    font-weight: 600;\n    color: var(--forge-text, #eaeaea);\n    margin: 0 0 1rem 0;\n  }\n\n  .rounds-list {\n    display: flex;\n    flex-direction: column;\n    gap: 1rem;\n  }\n\n  .round-item {\n    background: var(--card-bg, #1e293b);\n    border: 1px solid var(--border-color, #2a2a4a);\n    border-radius: 8px;\n    padding: 1rem;\n  }\n\n  .round-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 0.75rem;\n  }\n\n  .round-number {\n    font-weight: 600;\n    color: var(--forge-text, #eaeaea);\n  }\n\n  .round-duration {\n    font-size: 0.875rem;\n    color: var(--text-muted, #6b7280);\n  }\n\n  .round-contributions,\n  .round-critiques {\n    display: flex;\n    flex-direction: column;\n    gap: 0.5rem;\n    margin-bottom: 0.75rem;\n  }\n\n  .contribution-item,\n  .critique-item {\n    background: var(--sub-card-bg, #0f172a);\n    border-radius: 6px;\n    padding: 0.75rem;\n  }\n\n  .contribution-header,\n  .critique-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 0.5rem;\n  }\n\n  .contribution-type,\n  .critique-severity {\n    padding: 0.125rem 0.5rem;\n    border-radius: 4px;\n    font-size: 0.75rem;\n    font-weight: 500;\n    text-transform: capitalize;\n    color: white;\n  }\n\n  .timestamp {\n    font-size: 0.75rem;\n    color: var(--text-muted, #6b7280);\n  }\n\n  .contribution-content,\n  .critique-content {\n    font-size: 0.875rem;\n    color: var(--forge-text, #eaeaea);\n    line-height: 1.4;\n  }\n\n  .insights-placeholder {\n    background: var(--card-bg, #1e293b);\n    border: 1px dashed var(--border-color, #2a2a4a);\n    border-radius: 8px;\n    padding: 2rem;\n    text-align: center;\n    color: var(--text-muted, #6b7280);\n  }\n\n  /* Export Section */\n  .export-section h3 {\n    font-size: 1rem;\n    font-weight: 600;\n    color: var(--forge-text, #eaeaea);\n    margin: 0 0 1rem 0;\n  }\n\n  .export-error {\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n    padding: 0.75rem;\n    background: rgba(220, 38, 38, 0.15);\n    border: 1px solid rgba(220, 38, 38, 0.3);\n    border-radius: 8px;\n    color: #fca5a5;\n    font-size: 0.875rem;\n    margin-bottom: 1rem;\n  }\n\n  .export-buttons {\n    display: flex;\n    flex-direction: column;\n    gap: 0.5rem;\n  }\n\n  .export-button-group {\n    display: flex;\n    gap: 0.25rem;\n  }\n\n  .export-btn {\n    flex: 1;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    gap: 0.5rem;\n    padding: 0.75rem 1rem;\n    background: rgba(78, 205, 196, 0.1);\n    border: 1px solid rgba(78, 205, 196, 0.25);\n    border-radius: 8px 0 0 8px;\n    color: var(--tachi-cyan, #4ecdc4);\n    font-size: 0.875rem;\n    font-weight: 500;\n    cursor: pointer;\n    transition: all 0.15s ease;\n  }\n\n  .export-btn:hover:not(:disabled) {\n    background: rgba(78, 205, 196, 0.2);\n    border-color: rgba(78, 205, 196, 0.4);\n  }\n\n  .export-btn:disabled {\n    opacity: 0.5;\n    cursor: not-allowed;\n  }\n\n  .preview-btn {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    padding: 0.75rem;\n    background: rgba(78, 205, 196, 0.1);\n    border: 1px solid rgba(78, 205, 196, 0.25);\n    border-left: none;\n    border-radius: 0 8px 8px 0;\n    color: var(--tachi-cyan, #4ecdc4);\n    cursor: pointer;\n    transition: all 0.15s ease;\n  }\n\n  .preview-btn:hover:not(:disabled) {\n    background: rgba(78, 205, 196, 0.2);\n  }\n\n  .preview-btn:disabled {\n    opacity: 0.5;\n    cursor: not-allowed;\n  }\n\n  /* Preview Modal */\n  .preview-overlay {\n    position: fixed;\n    inset: 0;\n    background: rgba(0, 0, 0, 0.75);\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    z-index: 1000;\n    padding: 2rem;\n  }\n\n  .preview-modal {\n    width: 100%;\n    max-width: 800px;\n    max-height: 80vh;\n    background: var(--bg-secondary, #161b22);\n    border: 1px solid rgba(78, 205, 196, 0.25);\n    border-radius: 16px;\n    display: flex;\n    flex-direction: column;\n    overflow: hidden;\n    box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);\n  }\n\n  .preview-header {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    padding: 1rem 1.25rem;\n    background: rgba(78, 205, 196, 0.06);\n    border-bottom: 1px solid rgba(78, 205, 196, 0.15);\n  }\n\n  .preview-header h3 {\n    margin: 0;\n    font-size: 1rem;\n    font-weight: 600;\n    color: var(--tachi-cyan, #4ecdc4);\n    letter-spacing: 0.5px;\n  }\n\n  .close-btn {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    width: 32px;\n    height: 32px;\n    background: transparent;\n    border: none;\n    border-radius: 6px;\n    color: rgba(230, 237, 243, 0.6);\n    cursor: pointer;\n    transition: all 0.15s ease;\n  }\n\n  .close-btn:hover {\n    background: rgba(255, 255, 255, 0.1);\n    color: rgba(230, 237, 243, 0.9);\n  }\n\n  .preview-content {\n    flex: 1;\n    overflow: auto;\n    padding: 1rem;\n  }\n\n  .preview-content pre {\n    margin: 0;\n    padding: 1rem;\n    background: rgba(13, 17, 23, 0.6);\n    border-radius: 8px;\n    overflow-x: auto;\n  }\n\n  .preview-content code {\n    font-family: 'JetBrains Mono', 'Fira Code', monospace;\n    font-size: 0.85rem;\n    line-height: 1.5;\n    color: rgba(230, 237, 243, 0.9);\n    white-space: pre-wrap;\n    word-break: break-word;\n  }\n\n  .preview-actions {\n    display: flex;\n    gap: 0.75rem;\n    justify-content: flex-end;\n    padding: 1rem 1.25rem;\n    border-top: 1px solid rgba(78, 205, 196, 0.15);\n  }\n\n  .btn-secondary {\n    display: inline-flex;\n    align-items: center;\n    gap: 0.5rem;\n    padding: 0.6rem 1rem;\n    background: rgba(13, 17, 23, 0.35);\n    border: 1px solid rgba(78, 205, 196, 0.18);\n    border-radius: 8px;\n    color: rgba(230, 237, 243, 0.85);\n    font-size: 0.875rem;\n    font-weight: 500;\n    cursor: pointer;\n    transition: all 0.15s ease;\n  }\n\n  .btn-secondary:hover {\n    background: rgba(78, 205, 196, 0.1);\n    border-color: rgba(78, 205, 196, 0.35);\n  }\n\n  .btn-primary {\n    display: inline-flex;\n    align-items: center;\n    gap: 0.5rem;\n    padding: 0.6rem 1rem;\n    background: linear-gradient(135deg, var(--tachi-cyan-dark, #2d7a7a), var(--tachi-cyan, #4ecdc4));\n    border: 1px solid rgba(78, 205, 196, 0.5);\n    border-radius: 8px;\n    color: var(--bg-primary, #0d1117);\n    font-size: 0.875rem;\n    font-weight: 500;\n    cursor: pointer;\n    transition: all 0.15s ease;\n  }\n\n  .btn-primary:hover {\n    box-shadow: 0 0 20px rgba(78, 205, 196, 0.3);\n  }\n\n  @media (max-width: 768px) {\n    .results-summary {\n      flex-direction: column;\n      gap: 0.5rem;\n    }\n\n    .stat-card {\n      padding: 0.75rem;\n    }\n\n    .stat-value {\n      font-size: 1.25rem;\n    }\n\n    .preview-modal {\n      max-height: 90vh;\n    }\n  }\n</style>","<script lang=\"ts\">\n  import { createEventDispatcher } from 'svelte';\n  import Icon from '$lib/components/common/Icon.svelte';\n  import { activeSession } from '$lib/stores/forgeSession';\n  import type { ForgeLayoutConfig } from '$lib/types/forge';\n\n  export let sessionId: string | null = null;\n  export let layoutConfig: ForgeLayoutConfig;\n\n  const dispatch = createEventDispatcher<{\n    togglePanel: 'left' | 'right' | 'bottom';\n    newSession: void;\n  }>();\n\n  function togglePanel(panel: 'left' | 'right' | 'bottom') {\n    dispatch('togglePanel', panel);\n  }\n\n  function requestNewSession() {\n    dispatch('newSession');\n  }\n\n  function handleKeydown(event: KeyboardEvent) {\n    // Keyboard shortcuts are handled by parent component\n    // This is just for accessibility on button focus\n    if (event.key === 'Enter' || event.key === ' ') {\n      event.preventDefault();\n      const target = event.target as HTMLButtonElement;\n      target.click();\n    }\n  }\n</script>\n\n<header class=\"forge-toolbar\" role=\"banner\">\n  <div class=\"toolbar-section left\">\n    <h1 class=\"forge-title\">\n      Think Tank\n      {#if sessionId}\n        <span class=\"session-indicator\">{$activeSession?.name ?? 'Session Active'}</span>\n      {/if}\n    </h1>\n  </div>\n\n  <div class=\"toolbar-section center\">\n    <nav class=\"panel-controls\" role=\"navigation\" aria-label=\"Panel controls\">\n      <button\n        type=\"button\"\n        class=\"panel-toggle\"\n        class:active={layoutConfig.leftSidebarVisible}\n        on:click={() => togglePanel('left')}\n        on:keydown={handleKeydown}\n        title=\"Toggle left sidebar (Ctrl+B)\"\n        aria-label=\"Toggle left sidebar\"\n        aria-pressed={layoutConfig.leftSidebarVisible}\n      >\n        <svg width=\"16\" height=\"16\" viewBox=\"0 0 16 16\" fill=\"currentColor\" aria-hidden=\"true\">\n          <path d=\"M2 2h4v12H2V2zm6 0h6v12H8V2z\" />\n        </svg>\n        Sidebar\n      </button>\n\n      <button\n        type=\"button\"\n        class=\"panel-toggle\"\n        class:active={layoutConfig.rightPanelVisible}\n        on:click={() => togglePanel('right')}\n        on:keydown={handleKeydown}\n        title=\"Toggle right panel (Ctrl+\\)\"\n        aria-label=\"Toggle right panel\"\n        aria-pressed={layoutConfig.rightPanelVisible}\n      >\n        <svg width=\"16\" height=\"16\" viewBox=\"0 0 16 16\" fill=\"currentColor\" aria-hidden=\"true\">\n          <path d=\"M2 2h6v12H2V2zm8 0h4v12h-4V2z\" />\n        </svg>\n        Results\n      </button>\n\n      <button\n        type=\"button\"\n        class=\"panel-toggle\"\n        class:active={layoutConfig.bottomPanelVisible}\n        on:click={() => togglePanel('bottom')}\n        on:keydown={handleKeydown}\n        title=\"Toggle bottom panel (Ctrl+J)\"\n        aria-label=\"Toggle bottom panel\"\n        aria-pressed={layoutConfig.bottomPanelVisible}\n      >\n        <svg width=\"16\" height=\"16\" viewBox=\"0 0 16 16\" fill=\"currentColor\" aria-hidden=\"true\">\n          <path d=\"M2 2h12v6H2V2zm0 8h12v4H2v-4z\" />\n        </svg>\n        Logs\n      </button>\n    </nav>\n  </div>\n\n  <div class=\"toolbar-section right\">\n    <div class=\"session-status\">\n      {#if sessionId}\n        <span class=\"status-dot active\" aria-label=\"Session active\"></span>\n        <span class=\"status-text\">Active</span>\n      {:else}\n        <span class=\"status-dot inactive\" aria-label=\"No active session\"></span>\n        <span class=\"status-text\">Idle</span>\n      {/if}\n    </div>\n\n    <button type=\"button\" class=\"new-session\" on:click={requestNewSession} title=\"Start a new Think Tank session\">\n      <Icon name=\"zap\" size={16} />\n      <span>New</span>\n    </button>\n  </div>\n</header>\n\n<style>\n  .forge-toolbar {\n    display: flex;\n    align-items: center;\n    height: 48px;\n    padding: 0 16px;\n    background: rgba(13, 17, 23, 0.7);\n    border-bottom: 1px solid rgba(78, 205, 196, 0.14);\n    color: var(--text-primary, #e6edf3);\n    -webkit-backdrop-filter: blur(14px) saturate(1.25);\n    backdrop-filter: blur(14px) saturate(1.25);\n    user-select: none;\n  }\n\n  .toolbar-section {\n    display: flex;\n    align-items: center;\n  }\n\n  .toolbar-section.left {\n    flex: 0 0 auto;\n  }\n\n  .toolbar-section.center {\n    flex: 1 1 auto;\n    justify-content: center;\n  }\n\n  .toolbar-section.right {\n    flex: 0 0 auto;\n    gap: 0.75rem;\n  }\n\n  .forge-title {\n    font-size: 18px;\n    font-weight: 600;\n    margin: 0;\n    color: var(--tachi-cyan, #4ecdc4);\n    font-family: var(--font-display, 'Orbitron', sans-serif);\n    letter-spacing: 1.5px;\n    text-transform: uppercase;\n  }\n\n  .session-indicator {\n    font-size: 12px;\n    font-weight: 500;\n    color: rgba(230, 237, 243, 0.65);\n    margin-left: 8px;\n    font-family: var(--font-body, 'Rajdhani', sans-serif);\n    letter-spacing: 0.2px;\n    text-transform: none;\n  }\n\n  .panel-controls {\n    display: flex;\n    gap: 4px;\n    padding: 0 16px;\n  }\n\n  .panel-toggle {\n    display: flex;\n    align-items: center;\n    gap: 6px;\n    padding: 6px 12px;\n    background: transparent;\n    border: 1px solid transparent;\n    border-radius: 4px;\n    color: var(--forge-text, #eaeaea);\n    font-size: 12px;\n    font-weight: 500;\n    cursor: pointer;\n    transition: all 0.2s ease;\n  }\n\n  .panel-toggle:hover {\n    background: var(--hover-bg, rgba(78, 205, 196, 0.08));\n    border-color: rgba(78, 205, 196, 0.18);\n  }\n\n  .panel-toggle:focus {\n    outline: 2px solid var(--tachi-cyan, #4ecdc4);\n    outline-offset: 2px;\n  }\n\n  .panel-toggle.active {\n    background: rgba(78, 205, 196, 0.15);\n    color: var(--tachi-cyan, #4ecdc4);\n    border-color: rgba(78, 205, 196, 0.55);\n  }\n\n  .panel-toggle svg {\n    flex-shrink: 0;\n  }\n\n  .session-status {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    font-size: 12px;\n    font-weight: 500;\n  }\n\n  .status-dot {\n    width: 8px;\n    height: 8px;\n    border-radius: 50%;\n    display: block;\n  }\n\n  .status-dot.active {\n    background: var(--success-color, #3fb950);\n    box-shadow: 0 0 6px rgba(63, 185, 80, 0.6);\n  }\n\n  .status-dot.inactive {\n    background: var(--muted-color, #6b7280);\n  }\n\n  .status-text {\n    color: var(--muted-color, #6b7280);\n  }\n\n  .new-session {\n    display: inline-flex;\n    align-items: center;\n    gap: 0.4rem;\n    padding: 0.4rem 0.65rem;\n    border-radius: 10px;\n    background: rgba(78, 205, 196, 0.12);\n    border: 1px solid rgba(78, 205, 196, 0.22);\n    color: var(--tachi-cyan, #4ecdc4);\n    cursor: pointer;\n    transition: all 0.2s ease;\n    font-family: var(--font-display, 'Orbitron', sans-serif);\n    letter-spacing: 0.8px;\n    text-transform: uppercase;\n    font-size: 0.7rem;\n  }\n\n  .new-session:hover {\n    border-color: rgba(78, 205, 196, 0.5);\n    background: rgba(78, 205, 196, 0.16);\n    box-shadow: 0 0 18px rgba(78, 205, 196, 0.22);\n  }\n\n  @media (max-width: 768px) {\n    .forge-toolbar {\n      padding: 0 12px;\n    }\n\n    .panel-controls {\n      padding: 0 8px;\n      gap: 2px;\n    }\n\n    .panel-toggle {\n      padding: 6px 8px;\n      font-size: 11px;\n    }\n\n    .panel-toggle span:not(.sr-only) {\n      display: none;\n    }\n\n    .forge-title {\n      font-size: 16px;\n    }\n\n    .session-indicator {\n      display: none;\n    }\n\n    .new-session span {\n      display: none;\n    }\n  }\n</style>","<script lang=\"ts\">\n  import { derived } from 'svelte/store';\n  import Icon from '$lib/components/common/Icon.svelte';\n  import { forgeService } from '$lib/services/forgeService';\n  import type { ForgeSession } from '$lib/types/forge';\n\n  export let session: ForgeSession | null = null;\n\n  const forgeState = forgeService.state;\n  const forgeMessages = forgeService.messages;\n\n  const filtered = derived([forgeMessages], ([$msgs]) => {\n    if (!session) return $msgs;\n    return $msgs.filter(m => m.sessionId === session.id);\n  });\n</script>\n\n<div class=\"log-panel\">\n  <header class=\"log-header\">\n    <div class=\"title\">\n      <Icon name=\"terminal\" size={16} />\n      <span>Forge Logs</span>\n    </div>\n    <div class=\"meta\">\n      {#if $forgeState.useMockMode}\n        <span class=\"chip chip-warn\">Mock</span>\n      {:else}\n        <span class=\"chip chip-ok\">IPC</span>\n      {/if}\n      {#if $forgeState.isDeliberating}\n        <span class=\"chip chip-run\">Running</span>\n      {/if}\n      {#if $forgeState.error}\n        <span class=\"chip chip-err\">Error</span>\n      {/if}\n    </div>\n  </header>\n\n  <div class=\"log-body\">\n    {#if $forgeState.error}\n      <div class=\"error-row\">\n        <Icon name=\"alert-triangle\" size={14} />\n        <span>{$forgeState.error}</span>\n      </div>\n    {/if}\n\n    {#if $filtered.length === 0}\n      <div class=\"empty\">\n        <div class=\"empty-title\">No log events yet</div>\n        <div class=\"empty-subtitle\">Start a deliberation to see the raw event stream.</div>\n      </div>\n    {:else}\n      <ul class=\"log-list\">\n        {#each $filtered as m (m.messageId)}\n          <li class=\"log-item\">\n            <span class=\"ts\">{new Date(m.timestamp).toLocaleTimeString()}</span>\n            <span class=\"who\">{m.participantName}</span>\n            <span class=\"type\">{m.type}/{m.status}</span>\n            <span class=\"msg\">{(m.contentDelta ?? m.content ?? '').replaceAll('\\n', ' ').slice(0, 160)}</span>\n          </li>\n        {/each}\n      </ul>\n    {/if}\n  </div>\n</div>\n\n<style>\n  .log-panel {\n    height: 100%;\n    display: flex;\n    flex-direction: column;\n    background: rgba(13, 17, 23, 0.45);\n    border-top: 1px solid rgba(78, 205, 196, 0.14);\n  }\n\n  .log-header {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    padding: 0.65rem 0.9rem;\n    border-bottom: 1px solid rgba(78, 205, 196, 0.12);\n    background: rgba(78, 205, 196, 0.04);\n  }\n\n  .title {\n    display: inline-flex;\n    align-items: center;\n    gap: 0.5rem;\n    color: var(--tachi-cyan, #4ecdc4);\n    font-weight: 600;\n    letter-spacing: 0.5px;\n    text-transform: uppercase;\n    font-size: 0.75rem;\n  }\n\n  .meta {\n    display: inline-flex;\n    align-items: center;\n    gap: 0.4rem;\n  }\n\n  .chip {\n    font-size: 0.65rem;\n    font-weight: 600;\n    padding: 0.15rem 0.45rem;\n    border-radius: 999px;\n    border: 1px solid transparent;\n    letter-spacing: 0.4px;\n    text-transform: uppercase;\n  }\n\n  .chip-ok {\n    color: rgba(63, 185, 80, 0.95);\n    background: rgba(63, 185, 80, 0.12);\n    border-color: rgba(63, 185, 80, 0.22);\n  }\n\n  .chip-warn {\n    color: rgba(243, 156, 18, 0.95);\n    background: rgba(243, 156, 18, 0.12);\n    border-color: rgba(243, 156, 18, 0.22);\n  }\n\n  .chip-run {\n    color: rgba(78, 205, 196, 0.95);\n    background: rgba(78, 205, 196, 0.12);\n    border-color: rgba(78, 205, 196, 0.22);\n  }\n\n  .chip-err {\n    color: rgba(255, 107, 107, 0.95);\n    background: rgba(255, 107, 107, 0.12);\n    border-color: rgba(255, 107, 107, 0.22);\n  }\n\n  .log-body {\n    flex: 1;\n    overflow: auto;\n    font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace;\n    font-size: 0.78rem;\n    color: rgba(230, 237, 243, 0.78);\n  }\n\n  .error-row {\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n    padding: 0.55rem 0.75rem;\n    color: rgba(255, 107, 107, 0.95);\n    border-bottom: 1px solid rgba(255, 107, 107, 0.2);\n    background: rgba(255, 107, 107, 0.06);\n  }\n\n  .empty {\n    padding: 0.9rem;\n    color: rgba(230, 237, 243, 0.55);\n  }\n\n  .empty-title {\n    font-weight: 600;\n    margin-bottom: 0.2rem;\n  }\n\n  .empty-subtitle {\n    font-size: 0.75rem;\n    color: rgba(230, 237, 243, 0.45);\n  }\n\n  .log-list {\n    list-style: none;\n    margin: 0;\n    padding: 0;\n  }\n\n  .log-item {\n    display: grid;\n    grid-template-columns: 90px 160px 130px 1fr;\n    gap: 0.75rem;\n    padding: 0.4rem 0.75rem;\n    border-bottom: 1px solid rgba(78, 205, 196, 0.08);\n  }\n\n  .log-item:hover {\n    background: rgba(78, 205, 196, 0.05);\n  }\n\n  .ts {\n    color: rgba(230, 237, 243, 0.45);\n  }\n\n  .who {\n    color: rgba(230, 237, 243, 0.85);\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n  }\n\n  .type {\n    color: rgba(78, 205, 196, 0.9);\n  }\n\n  .msg {\n    color: rgba(230, 237, 243, 0.72);\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n  }\n</style>\n","import { createPersistedStore } from './persistedStore';\nimport type { ForgeLayoutConfig } from '$lib/types/forge';\n\ninterface LayoutPreferences {\n  forge?: ForgeLayoutConfig;\n  [key: string]: any;\n}\n\nconst defaultPreferences: LayoutPreferences = {};\n\nfunction createLayoutPreferencesStore() {\n  const store = createPersistedStore<LayoutPreferences>(defaultPreferences, {\n    key: 'layout-preferences',\n    storage: 'localStorage',\n    version: 1\n  });\n\n  return {\n    ...store,\n    \n    async save(layoutType: string, config: any): Promise<void> {\n      store.update(prefs => ({\n        ...prefs,\n        [layoutType]: config\n      }));\n    },\n\n    async load(layoutType: string): Promise<any | null> {\n      return new Promise((resolve) => {\n        const unsubscribe = store.subscribe(prefs => {\n          resolve(prefs[layoutType] || null);\n          unsubscribe();\n        });\n      });\n    }\n  };\n}\n\nexport const layoutPreferencesStore = createLayoutPreferencesStore();","<script lang=\"ts\">\n  import { createEventDispatcher } from 'svelte';\n  import { onMount, onDestroy } from 'svelte';\n  import { writable, derived } from 'svelte/store';\n  import SessionSidebar from './SessionSidebar.svelte';\n  import ParticipantPanel from './ParticipantPanel.svelte';\n  import MainContentArea from './MainContentArea.svelte';\n  import ResultPanel from './ResultPanel.svelte';\n  import ForgeToolbar from './ForgeToolbar.svelte';\n  import LogPanel from './LogPanel.svelte';\n  import { forgeSessionStore } from '$lib/stores/forgeSession';\n  import { layoutPreferencesStore } from '$lib/stores/layoutPreferences';\n  import type { ForgeLayoutConfig, PanelState } from '$lib/types/forge';\n\n  export let sessionId: string | null = null;\n\n  const dispatch = createEventDispatcher<{\n    newSession: void;\n    editSession: { sessionId: string };\n  }>();\n\n  const defaultConfig: ForgeLayoutConfig = {\n    leftSidebarWidth: 280,\n    rightPanelWidth: 320,\n    leftSidebarVisible: true,\n    rightPanelVisible: true,\n    bottomPanelVisible: false,\n    bottomPanelHeight: 200\n  };\n\n  let layoutConfig = writable<ForgeLayoutConfig>(defaultConfig);\n  let isResizing = writable<string | null>(null);\n  let containerRef: HTMLElement;\n  let didAutoOpenRunPanels = false;\n\n  const panelStates = derived(\n    [layoutConfig, forgeSessionStore],\n    ([$config, $session]) => ({\n      hasActiveSession: !!$session?.activeSession,\n      showParticipants: $config.leftSidebarVisible && !!$session?.activeSession,\n      // Always allow the Results panel to render; it has a useful empty-state during runs.\n      showResults: $config.rightPanelVisible && !!$session?.activeSession,\n      sessionPhase: $session?.activeSession?.phase ?? 'idle'\n    })\n  );\n\n  function handleResizeStart(panel: string) {\n    return (event: MouseEvent) => {\n      event.preventDefault();\n      isResizing.set(panel);\n      document.addEventListener('mousemove', handleResizeMove);\n      document.addEventListener('mouseup', handleResizeEnd);\n    };\n  }\n\n  function handleResizeMove(event: MouseEvent) {\n    const resizingPanel = $isResizing;\n    if (!resizingPanel || !containerRef) return;\n\n    const containerRect = containerRef.getBoundingClientRect();\n\n    layoutConfig.update(config => {\n      if (resizingPanel === 'left') {\n        const newWidth = Math.max(200, Math.min(400, event.clientX - containerRect.left));\n        return { ...config, leftSidebarWidth: newWidth };\n      } else if (resizingPanel === 'right') {\n        const newWidth = Math.max(250, Math.min(500, containerRect.right - event.clientX));\n        return { ...config, rightPanelWidth: newWidth };\n      } else if (resizingPanel === 'bottom') {\n        const newHeight = Math.max(150, Math.min(400, containerRect.bottom - event.clientY));\n        return { ...config, bottomPanelHeight: newHeight };\n      }\n      return config;\n    });\n  }\n\n  function handleResizeEnd() {\n    isResizing.set(null);\n    document.removeEventListener('mousemove', handleResizeMove);\n    document.removeEventListener('mouseup', handleResizeEnd);\n    saveLayoutPreferences();\n  }\n\n  function togglePanel(panel: 'left' | 'right' | 'bottom') {\n    layoutConfig.update(config => {\n      switch (panel) {\n        case 'left':\n          return { ...config, leftSidebarVisible: !config.leftSidebarVisible };\n        case 'right':\n          return { ...config, rightPanelVisible: !config.rightPanelVisible };\n        case 'bottom':\n          return { ...config, bottomPanelVisible: !config.bottomPanelVisible };\n      }\n    });\n    saveLayoutPreferences();\n  }\n\n  function saveLayoutPreferences() {\n    layoutPreferencesStore.save('forge', $layoutConfig);\n  }\n\n  function handleKeydown(event: KeyboardEvent) {\n    if (event.ctrlKey || event.metaKey) {\n      switch (event.key) {\n        case 'b':\n          event.preventDefault();\n          togglePanel('left');\n          break;\n        case '\\\\':\n          event.preventDefault();\n          togglePanel('right');\n          break;\n        case 'j':\n          event.preventDefault();\n          togglePanel('bottom');\n          break;\n      }\n    }\n  }\n\n  onMount(async () => {\n    const savedPrefs = await layoutPreferencesStore.load('forge');\n    if (savedPrefs) {\n      layoutConfig.set({ ...defaultConfig, ...savedPrefs });\n    }\n    window.addEventListener('keydown', handleKeydown);\n  });\n\n  onDestroy(() => {\n    window.removeEventListener('keydown', handleKeydown);\n  });\n\n  // Auto-open Logs (and ensure Results is visible) on the first run so output is never \"invisible\".\n  $: if (!didAutoOpenRunPanels && $panelStates.sessionPhase === 'drafting') {\n    didAutoOpenRunPanels = true;\n    layoutConfig.update((c) => ({\n      ...c,\n      rightPanelVisible: true,\n      bottomPanelVisible: true,\n    }));\n  }\n</script>\n\n<div\n  class=\"forge-layout\"\n  bind:this={containerRef}\n  class:resizing={$isResizing !== null}\n  data-testid=\"forge-layout\"\n>\n  <ForgeToolbar\n    {sessionId}\n    on:togglePanel={(e) => togglePanel(e.detail)}\n    on:newSession={() => dispatch('newSession')}\n    layoutConfig={$layoutConfig}\n  />\n\n  <div class=\"forge-content\">\n    {#if $layoutConfig.leftSidebarVisible}\n      <aside\n        class=\"left-sidebar\"\n        style=\"width: {$layoutConfig.leftSidebarWidth}px\"\n        aria-label=\"Session sidebar\"\n        data-visible={$layoutConfig.leftSidebarVisible}\n      >\n        <SessionSidebar {sessionId} />\n\n        {#if $panelStates.showParticipants}\n          <ParticipantPanel session={$forgeSessionStore.activeSession} />\n        {/if}\n\n        <div\n          class=\"resize-handle vertical\"\n          on:mousedown={handleResizeStart('left')}\n          role=\"separator\"\n          aria-orientation=\"vertical\"\n          aria-label=\"Resize left sidebar\"\n          tabindex=\"0\"\n        />\n      </aside>\n    {/if}\n\n    <main class=\"main-content\" role=\"main\" aria-label=\"Forge session content\">\n      <MainContentArea\n        {sessionId}\n        phase={$panelStates.sessionPhase}\n        on:editSession={(e) => dispatch('editSession', e.detail)}\n      />\n\n      {#if $layoutConfig.bottomPanelVisible}\n        <div\n          class=\"resize-handle horizontal\"\n          on:mousedown={handleResizeStart('bottom')}\n          role=\"separator\"\n          aria-orientation=\"horizontal\"\n          aria-label=\"Resize bottom panel\"\n          tabindex=\"0\"\n        />\n        <div\n          class=\"bottom-panel\"\n          style=\"height: {$layoutConfig.bottomPanelHeight}px\"\n          aria-label=\"Session logs\"\n        >\n          <slot name=\"bottom-panel\">\n            <LogPanel session={$forgeSessionStore.activeSession} />\n          </slot>\n        </div>\n      {/if}\n    </main>\n\n    {#if $layoutConfig.rightPanelVisible}\n      <aside\n        class=\"right-panel\"\n        style=\"width: {$layoutConfig.rightPanelWidth}px\"\n        aria-label=\"Results panel\"\n        data-visible={$layoutConfig.rightPanelVisible}\n      >\n        <div\n          class=\"resize-handle vertical\"\n          on:mousedown={handleResizeStart('right')}\n          role=\"separator\"\n          aria-orientation=\"vertical\"\n          aria-label=\"Resize right panel\"\n          tabindex=\"0\"\n        />\n\n        <ResultPanel session={$forgeSessionStore.activeSession} visible={$panelStates.showResults} />\n      </aside>\n    {/if}\n  </div>\n</div>\n\n<style>\n  .forge-layout {\n    display: flex;\n    flex-direction: column;\n    height: 100vh;\n    background: var(--bg-primary, #0d1117);\n    color: var(--text-primary, #e6edf3);\n  }\n\n  .forge-layout.resizing {\n    cursor: col-resize;\n    user-select: none;\n  }\n\n  .forge-content {\n    display: flex;\n    flex: 1;\n    overflow: hidden;\n  }\n\n  .left-sidebar {\n    display: flex;\n    flex-direction: column;\n    background: rgba(13, 17, 23, 0.35);\n    border-right: 1px solid rgba(78, 205, 196, 0.12);\n    position: relative;\n    overflow: hidden;\n    transition: transform 0.3s ease;\n  }\n\n  .main-content {\n    flex: 1;\n    display: flex;\n    flex-direction: column;\n    overflow: hidden;\n    min-width: 400px;\n  }\n\n  .right-panel {\n    display: flex;\n    flex-direction: column;\n    background: rgba(13, 17, 23, 0.35);\n    border-left: 1px solid rgba(78, 205, 196, 0.12);\n    position: relative;\n    overflow: hidden;\n    transition: transform 0.3s ease;\n  }\n\n  .bottom-panel {\n    background: var(--panel-bg, #16213e);\n    border-top: 1px solid var(--border-color, #2a2a4a);\n    overflow: auto;\n  }\n\n  .resize-handle {\n    position: absolute;\n    background: transparent;\n    z-index: 10;\n  }\n\n  .resize-handle.vertical {\n    width: 4px;\n    height: 100%;\n    top: 0;\n    cursor: col-resize;\n  }\n\n  .left-sidebar .resize-handle.vertical {\n    right: 0;\n  }\n\n  .right-panel .resize-handle.vertical {\n    left: 0;\n  }\n\n  .resize-handle.horizontal {\n    height: 4px;\n    width: 100%;\n    cursor: row-resize;\n  }\n\n  .resize-handle:hover,\n  .resize-handle:focus {\n    background: var(--accent-color, #4a9eff);\n  }\n\n  @media (max-width: 768px) {\n    .left-sidebar,\n    .right-panel {\n      position: absolute;\n      z-index: 100;\n      height: 100%;\n    }\n\n    .left-sidebar {\n      left: 0;\n      transform: translateX(-100%);\n    }\n\n    .left-sidebar[data-visible=\"true\"] {\n      transform: translateX(0);\n    }\n\n    .right-panel {\n      right: 0;\n      transform: translateX(100%);\n    }\n\n    .right-panel[data-visible=\"true\"] {\n      transform: translateX(0);\n    }\n  }\n</style>","/**\n * Goal Refinement Service\n * \n * Provides AI-assisted goal refinement through intelligent context-gap analysis.\n * \n * Analyzes the user's ACTUAL prompt content to ask RELEVANT questions,\n * not generic stakeholder/constraint garbage.\n */\n\nimport { writable, get } from 'svelte/store';\n\nexport interface RefinementMessage {\n  id: string;\n  role: 'assistant' | 'user' | 'system';\n  content: string;\n  timestamp: Date;\n  status: 'pending' | 'streaming' | 'complete';\n}\n\nexport interface ContextGap {\n  category: string;\n  question: string;\n  priority: 'high' | 'medium' | 'low';\n  filled: boolean;\n}\n\nexport interface RefinementState {\n  isActive: boolean;\n  isStreaming: boolean;\n  initialGoal: string;\n  contextGaps: ContextGap[];\n  currentGapIndex: number;\n  refinedGoal: string;\n  error: string | null;\n}\n\nexport interface ConversationContext {\n  initialGoal: string;\n  exchanges: { question: string; answer: string }[];\n}\n\n/**\n * Topic patterns to detect what the user is actually talking about.\n */\nconst topicPatterns: { pattern: RegExp; topic: string; questions: string[] }[] = [\n  // Code/Repo related\n  {\n    pattern: /\\b(repo|repository|repositories|git|code\\s*base|codebase)\\b/i,\n    topic: 'repositories',\n    questions: [\n      'Which repository providers do you need to support? (GitHub, GitLab, Bitbucket, local file system, etc.)',\n      'Should this work with private repos that require authentication?',\n      'Do you need to track multiple branches, or just main/default?'\n    ]\n  },\n  // Indexing related\n  {\n    pattern: /\\b(index|indexing|search|find|lookup)\\b/i,\n    topic: 'indexing',\n    questions: [\n      'What do you want to index? (file contents, symbols/functions, dependencies, commit history?)',\n      'How should search work - full text, semantic/meaning-based, or symbol lookup?',\n      'Should the index update automatically when code changes, or on-demand?'\n    ]\n  },\n  // Connection related\n  {\n    pattern: /\\b(connect|connection|sync|pull|fetch|clone)\\b/i,\n    topic: 'connection',\n    questions: [\n      'For remote connections, what authentication methods should be supported? (SSH keys, tokens, OAuth?)',\n      'Should it handle large repos efficiently, or is size not a concern?',\n      'Do you need offline support when remote is unavailable?'\n    ]\n  },\n  // Local vs Remote\n  {\n    pattern: /\\b(local|remote|both)\\b/i,\n    topic: 'locality',\n    questions: [\n      'For local repos, should it scan for repos automatically or require manual paths?',\n      'Should local and remote repos be treated the same, or have different capabilities?'\n    ]\n  },\n  // API related\n  {\n    pattern: /\\b(api|endpoint|service|backend)\\b/i,\n    topic: 'api',\n    questions: [\n      'What kind of API - REST, GraphQL, or CLI commands?',\n      'Are there rate limits or quotas to consider?',\n      'Does it need to integrate with existing Tachikoma services?'\n    ]\n  },\n  // Database/Storage\n  {\n    pattern: /\\b(database|storage|persist|save|store)\\b/i,\n    topic: 'storage',\n    questions: [\n      'What storage backend - SQLite, PostgreSQL, file-based?',\n      'How much data are we talking about? Rough estimate of repo count/size?'\n    ]\n  },\n  // UI related\n  {\n    pattern: /\\b(ui|interface|display|show|view|screen)\\b/i,\n    topic: 'interface',\n    questions: [\n      'Where should this appear in the Tachikoma UI?',\n      'Any specific interactions or workflows you envision?'\n    ]\n  },\n  // Performance\n  {\n    pattern: /\\b(fast|performance|speed|efficient|scale)\\b/i,\n    topic: 'performance',\n    questions: [\n      'What scale are we dealing with? Number of repos, lines of code?',\n      'Are there specific performance targets to hit?'\n    ]\n  },\n  // Configuration\n  {\n    pattern: /\\b(config|configure|settings|options)\\b/i,\n    topic: 'configuration',\n    questions: [\n      'What should be configurable by the user vs hardcoded?',\n      'Should config be per-project, per-workspace, or global?'\n    ]\n  }\n];\n\n/**\n * Analyzes the user's actual prompt to extract relevant topics and generate\n * questions that are SPECIFIC to what they're asking about.\n */\nfunction analyzePromptForQuestions(initialGoal: string): ContextGap[] {\n  const text = initialGoal.toLowerCase();\n  const gaps: ContextGap[] = [];\n  const usedQuestions = new Set<string>();\n  const detectedTopics = new Set<string>();\n\n  // Find all matching topics\n  for (const { pattern, topic, questions } of topicPatterns) {\n    if (pattern.test(text)) {\n      detectedTopics.add(topic);\n      \n      // Pick the most relevant question for this topic (first one not used)\n      for (const q of questions) {\n        if (!usedQuestions.has(q) && gaps.length < 4) {\n          usedQuestions.add(q);\n          gaps.push({\n            category: topic,\n            question: q,\n            priority: gaps.length === 0 ? 'high' : 'medium',\n            filled: false\n          });\n          break; // Only one question per topic initially\n        }\n      }\n    }\n  }\n\n  // If prompt is very short, ask for elaboration first\n  if (initialGoal.trim().length < 50 && gaps.length === 0) {\n    gaps.unshift({\n      category: 'clarity',\n      question: `You mentioned: \"${initialGoal.trim()}\"\\n\\nCan you expand on this? What specifically are you trying to accomplish?`,\n      priority: 'high',\n      filled: false\n    });\n  }\n\n  // If we found topics but have room for more questions, add second-tier questions\n  if (gaps.length < 3 && detectedTopics.size > 0) {\n    for (const { pattern, topic, questions } of topicPatterns) {\n      if (pattern.test(text) && detectedTopics.has(topic)) {\n        for (const q of questions) {\n          if (!usedQuestions.has(q) && gaps.length < 4) {\n            usedQuestions.add(q);\n            gaps.push({\n              category: topic,\n              question: q,\n              priority: 'low',\n              filled: false\n            });\n          }\n        }\n      }\n    }\n  }\n\n  // Fallback if we couldn't detect any topics\n  if (gaps.length === 0) {\n    gaps.push({\n      category: 'scope',\n      question: `I want to make sure I understand correctly.\\n\\nWhat's the main outcome you're looking for from this session? What would success look like?`,\n      priority: 'high',\n      filled: false\n    });\n  }\n\n  return gaps.slice(0, 4);\n}\n\n/**\n * Synthesizes the conversation into a refined goal.\n */\nfunction synthesizeRefinedGoal(context: ConversationContext): string {\n  const { initialGoal, exchanges } = context;\n  \n  let markdown = `## Objective\\n${initialGoal}`;\n  \n  if (exchanges.length > 0) {\n    markdown += `\\n\\n## Details\\n`;\n    \n    for (const { question, answer } of exchanges) {\n      // Extract the essence of the question for a heading\n      const shortQ = question.split('\\n')[0].replace(/[?:]+$/, '').trim();\n      markdown += `\\n**${shortQ}**\\n${answer}\\n`;\n    }\n  }\n\n  return markdown;\n}\n\nfunction createGoalRefinementStore() {\n  const state = writable<RefinementState>({\n    isActive: false,\n    isStreaming: false,\n    initialGoal: '',\n    contextGaps: [],\n    currentGapIndex: 0,\n    refinedGoal: '',\n    error: null\n  });\n\n  const messages = writable<RefinementMessage[]>([]);\n  const conversationContext = writable<ConversationContext>({\n    initialGoal: '',\n    exchanges: []\n  });\n\n  function startRefinement(initialGoal: string) {\n    // Analyze what the user ACTUALLY wrote\n    const gaps = analyzePromptForQuestions(initialGoal);\n    \n    state.update(s => ({\n      ...s,\n      isActive: true,\n      initialGoal,\n      contextGaps: gaps,\n      currentGapIndex: 0,\n      error: null\n    }));\n    \n    messages.set([]);\n    conversationContext.set({\n      initialGoal,\n      exchanges: []\n    });\n\n    if (gaps.length > 0) {\n      askQuestion(gaps[0].question);\n    } else {\n      addAssistantMessage(`Your goal looks clear. Proceed when ready, or ask me to clarify anything.`);\n    }\n  }\n\n  async function askQuestion(question: string) {\n    const messageId = addPendingMessage();\n    await delay(200 + Math.random() * 150);\n    state.update(s => ({ ...s, isStreaming: true }));\n    await streamMessage(messageId, question);\n    state.update(s => ({ ...s, isStreaming: false }));\n  }\n\n  async function submitAnswer(answer: string) {\n    const currentState = get(state);\n    const currentGap = currentState.contextGaps[currentState.currentGapIndex];\n\n    // Add user message\n    messages.update(msgs => [...msgs, {\n      id: `user-${Date.now()}`,\n      role: 'user',\n      content: answer,\n      timestamp: new Date(),\n      status: 'complete'\n    }]);\n\n    // Record the exchange\n    conversationContext.update(ctx => ({\n      ...ctx,\n      exchanges: [...ctx.exchanges, { \n        question: currentGap?.question || '', \n        answer \n      }]\n    }));\n\n    // Mark current gap as filled\n    state.update(s => {\n      const gaps = [...s.contextGaps];\n      if (gaps[s.currentGapIndex]) {\n        gaps[s.currentGapIndex].filled = true;\n      }\n      return { ...s, contextGaps: gaps };\n    });\n\n    await delay(150);\n\n    // Check for more questions\n    const updatedState = get(state);\n    const nextGapIndex = updatedState.currentGapIndex + 1;\n\n    if (nextGapIndex < updatedState.contextGaps.length) {\n      state.update(s => ({ ...s, currentGapIndex: nextGapIndex }));\n      \n      const nextQuestion = updatedState.contextGaps[nextGapIndex].question;\n      await askQuestion(nextQuestion);\n    } else {\n      await synthesizeAndPresent();\n    }\n  }\n\n  async function synthesizeAndPresent() {\n    const context = get(conversationContext);\n    \n    const messageId = addPendingMessage();\n    await delay(300);\n    \n    state.update(s => ({ ...s, isStreaming: true }));\n\n    const refinedGoal = synthesizeRefinedGoal(context);\n    state.update(s => ({ ...s, refinedGoal }));\n\n    const msg = `Here's your refined goal:\\n\\n---\\n\\n${refinedGoal}\\n\\n---\\n\\nClick **Apply to Goal** to use this, or keep chatting to refine further.`;\n\n    await streamMessage(messageId, msg);\n    state.update(s => ({ ...s, isStreaming: false }));\n  }\n\n  function addPendingMessage(): string {\n    const messageId = `msg-${Date.now()}`;\n    messages.update(msgs => [...msgs, {\n      id: messageId,\n      role: 'assistant',\n      content: '',\n      timestamp: new Date(),\n      status: 'pending'\n    }]);\n    return messageId;\n  }\n\n  async function addAssistantMessage(content: string) {\n    const messageId = addPendingMessage();\n    await delay(150);\n    state.update(s => ({ ...s, isStreaming: true }));\n    await streamMessage(messageId, content);\n    state.update(s => ({ ...s, isStreaming: false }));\n  }\n\n  async function streamMessage(messageId: string, fullContent: string) {\n    const words = fullContent.split(' ');\n    let current = '';\n\n    messages.update(msgs => \n      msgs.map(m => m.id === messageId \n        ? { ...m, status: 'streaming' as const } \n        : m\n      )\n    );\n\n    for (let i = 0; i < words.length; i++) {\n      current += (i > 0 ? ' ' : '') + words[i];\n      \n      messages.update(msgs => \n        msgs.map(m => m.id === messageId ? { ...m, content: current } : m)\n      );\n\n      await delay(10 + Math.random() * 15);\n    }\n\n    messages.update(msgs => \n      msgs.map(m => m.id === messageId ? { ...m, status: 'complete' as const } : m)\n    );\n  }\n\n  function getRefinedGoalMarkdown(): string {\n    return get(state).refinedGoal;\n  }\n\n  function stopRefinement() {\n    state.update(s => ({\n      ...s,\n      isActive: false,\n      isStreaming: false,\n      error: null\n    }));\n  }\n\n  function reset() {\n    state.set({\n      isActive: false,\n      isStreaming: false,\n      initialGoal: '',\n      contextGaps: [],\n      currentGapIndex: 0,\n      refinedGoal: '',\n      error: null\n    });\n    messages.set([]);\n    conversationContext.set({\n      initialGoal: '',\n      exchanges: []\n    });\n  }\n\n  return {\n    state: { subscribe: state.subscribe },\n    messages: { subscribe: messages.subscribe },\n    startRefinement,\n    submitAnswer,\n    stopRefinement,\n    getRefinedGoalMarkdown,\n    reset\n  };\n}\n\nfunction delay(ms: number): Promise<void> {\n  return new Promise(resolve => setTimeout(resolve, ms));\n}\n\nexport const goalRefinementStore = createGoalRefinementStore();\n","<script lang=\"ts\">\n  import { createEventDispatcher, onMount, onDestroy } from 'svelte';\n  import { marked } from 'marked';\n  import { goalRefinementStore } from '$lib/services/goalRefinement';\n  import type { RefinementMessage } from '$lib/services/goalRefinement';\n  import Icon from '$lib/components/common/Icon.svelte';\n\n  export let currentGoal: string = '';\n\n  const dispatch = createEventDispatcher<{\n    close: void;\n    applySuggestions: string;\n  }>();\n\n  let inputValue = '';\n  let messagesContainer: HTMLDivElement;\n  let inputElement: HTMLInputElement;\n\n  // Subscribe to stores\n  let messages: RefinementMessage[] = [];\n  let refinementState = {\n    isActive: false,\n    isStreaming: false,\n    initialGoal: '',\n    contextGaps: [] as { category: string; description: string; question: string; priority: string; filled: boolean }[],\n    currentGapIndex: 0,\n    refinedGoal: '',\n    error: null as string | null\n  };\n\n  const unsubMessages = goalRefinementStore.messages.subscribe(m => {\n    messages = m;\n    setTimeout(scrollToBottom, 50);\n  });\n\n  const unsubState = goalRefinementStore.state.subscribe(s => {\n    refinementState = s;\n  });\n\n  onMount(() => {\n    goalRefinementStore.startRefinement(currentGoal);\n    inputElement?.focus();\n  });\n\n  onDestroy(() => {\n    unsubMessages();\n    unsubState();\n    goalRefinementStore.reset();\n  });\n\n  function scrollToBottom() {\n    if (messagesContainer) {\n      messagesContainer.scrollTop = messagesContainer.scrollHeight;\n    }\n  }\n\n  function handleSubmit() {\n    if (!inputValue.trim() || refinementState.isStreaming) return;\n    goalRefinementStore.submitAnswer(inputValue.trim());\n    inputValue = '';\n  }\n\n  function handleKeydown(event: KeyboardEvent) {\n    if (event.key === 'Enter' && !event.shiftKey) {\n      event.preventDefault();\n      handleSubmit();\n    }\n  }\n\n  function handleClose() {\n    goalRefinementStore.stopRefinement();\n    dispatch('close');\n  }\n\n  function handleApplySuggestions() {\n    const markdown = goalRefinementStore.getRefinedGoalMarkdown();\n    dispatch('applySuggestions', markdown);\n  }\n\n  function renderMarkdown(content: string): string {\n    try {\n      return marked(content) as string;\n    } catch {\n      return content;\n    }\n  }\n\n  $: hasRefinedGoal = refinementState.refinedGoal.length > 0;\n  $: filledCount = refinementState.contextGaps.filter(g => g.filled).length;\n  $: totalGaps = refinementState.contextGaps.length;\n</script>\n\n<div class=\"refinement-panel\" data-testid=\"goal-refinement-chat\">\n  <!-- Panel Header -->\n  <header class=\"panel-header\">\n    <div class=\"header-title\">\n      <Icon name=\"message-circle\" size={16} />\n      <span>Q&A REFINEMENT</span>\n    </div>\n    {#if totalGaps > 0}\n      <div class=\"progress-badge\">\n        {filledCount}/{totalGaps}\n      </div>\n    {/if}\n    <button \n      type=\"button\" \n      class=\"close-btn\" \n      on:click={handleClose}\n      aria-label=\"Close\"\n    >\n      <Icon name=\"x\" size={14} />\n    </button>\n  </header>\n\n  <!-- Progress Track -->\n  {#if totalGaps > 0}\n    <div class=\"progress-track\">\n      <div class=\"progress-fill\" style=\"width: {(filledCount / totalGaps) * 100}%\"></div>\n    </div>\n  {/if}\n\n  <!-- Messages Area -->\n  <div class=\"messages-area\" bind:this={messagesContainer}>\n    {#each messages as message (message.id)}\n      <div class=\"message\" class:is-user={message.role === 'user'}>\n        <div class=\"message-indicator\">\n          {#if message.role === 'assistant'}\n            <Icon name=\"cpu\" size={14} />\n          {:else}\n            <Icon name=\"user\" size={14} />\n          {/if}\n        </div>\n        <div class=\"message-content\">\n          {#if message.status === 'pending'}\n            <div class=\"typing-dots\">\n              <span></span><span></span><span></span>\n            </div>\n          {:else if message.content}\n            <div class=\"message-text\">\n              {@html renderMarkdown(message.content)}\n            </div>\n          {/if}\n        </div>\n      </div>\n    {/each}\n  </div>\n\n  <!-- Input Area -->\n  <div class=\"input-area\">\n    <input\n      bind:this={inputElement}\n      bind:value={inputValue}\n      type=\"text\"\n      class=\"chat-input\"\n      placeholder=\"Type your response...\"\n      disabled={refinementState.isStreaming}\n      on:keydown={handleKeydown}\n      data-testid=\"refinement-input\"\n    />\n    <button\n      type=\"button\"\n      class=\"send-btn\"\n      disabled={!inputValue.trim() || refinementState.isStreaming}\n      on:click={handleSubmit}\n      aria-label=\"Send\"\n    >\n      <Icon name=\"send\" size={14} />\n    </button>\n  </div>\n\n  <!-- Actions -->\n  {#if hasRefinedGoal}\n    <div class=\"actions-bar\">\n      <button type=\"button\" class=\"btn-secondary\" on:click={() => inputElement?.focus()}>\n        Continue\n      </button>\n      <button type=\"button\" class=\"btn-primary\" on:click={handleApplySuggestions}>\n        <Icon name=\"check\" size={14} />\n        Apply to Goal\n      </button>\n    </div>\n  {/if}\n</div>\n\n<style>\n  .refinement-panel {\n    display: flex;\n    flex-direction: column;\n    background: rgba(22, 27, 34, 0.75);\n    border: 1px solid var(--border-color, rgba(78, 205, 196, 0.15));\n    border-radius: 12px;\n    overflow: hidden;\n    margin-top: 1rem;\n    max-height: 480px;\n    backdrop-filter: blur(8px);\n  }\n\n  /* Header */\n  .panel-header {\n    display: flex;\n    align-items: center;\n    gap: 0.75rem;\n    padding: 0.75rem 1rem;\n    background: linear-gradient(90deg, rgba(78, 205, 196, 0.08), transparent);\n    border-bottom: 1px solid var(--border-color, rgba(78, 205, 196, 0.15));\n  }\n\n  .header-title {\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n    font-family: var(--font-display, 'Orbitron', sans-serif);\n    font-size: 0.7rem;\n    font-weight: 600;\n    color: var(--tachi-cyan, #4ecdc4);\n    letter-spacing: 1.5px;\n  }\n\n  .progress-badge {\n    font-family: var(--font-display, 'Orbitron', sans-serif);\n    font-size: 0.6rem;\n    font-weight: 600;\n    padding: 0.2rem 0.5rem;\n    background: rgba(78, 205, 196, 0.1);\n    border: 1px solid rgba(78, 205, 196, 0.2);\n    border-radius: 4px;\n    color: var(--text-muted, rgba(230, 237, 243, 0.5));\n    letter-spacing: 0.5px;\n  }\n\n  .close-btn {\n    margin-left: auto;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    width: 24px;\n    height: 24px;\n    background: transparent;\n    border: 1px solid var(--border-color, rgba(78, 205, 196, 0.15));\n    border-radius: 4px;\n    color: var(--text-muted, rgba(230, 237, 243, 0.5));\n    cursor: pointer;\n    transition: all 0.15s ease;\n  }\n\n  .close-btn:hover {\n    background: rgba(255, 107, 107, 0.1);\n    border-color: rgba(255, 107, 107, 0.3);\n    color: var(--tachi-red, #ff6b6b);\n  }\n\n  /* Progress Track */\n  .progress-track {\n    height: 2px;\n    background: var(--bg-tertiary, #1c2128);\n  }\n\n  .progress-fill {\n    height: 100%;\n    background: var(--tachi-cyan, #4ecdc4);\n    transition: width 0.4s ease;\n  }\n\n  /* Messages */\n  .messages-area {\n    flex: 1;\n    overflow-y: auto;\n    padding: 1rem 1.25rem;\n    display: flex;\n    flex-direction: column;\n    gap: 0.75rem;\n    min-height: 200px;\n    max-height: 320px;\n  }\n\n  .message {\n    display: flex;\n    align-items: flex-start;\n    gap: 0.625rem;\n  }\n\n  .message.is-user {\n    flex-direction: row-reverse;\n  }\n\n  .message-indicator {\n    width: 28px;\n    height: 28px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    border-radius: 6px;\n    flex-shrink: 0;\n    background: var(--bg-tertiary, #1c2128);\n    border: 1px solid var(--border-color, rgba(78, 205, 196, 0.1));\n    color: var(--text-muted, rgba(230, 237, 243, 0.5));\n  }\n\n  .message.is-user .message-indicator {\n    background: rgba(78, 205, 196, 0.1);\n    border-color: rgba(78, 205, 196, 0.2);\n    color: var(--tachi-cyan, #4ecdc4);\n  }\n\n  .message-content {\n    max-width: 85%;\n    padding: 0.625rem 0.875rem;\n    border-radius: 8px;\n    font-size: 0.85rem;\n    line-height: 1.5;\n    background: var(--bg-tertiary, #1c2128);\n    border: 1px solid var(--border-color, rgba(78, 205, 196, 0.1));\n    color: var(--text-secondary, rgba(230, 237, 243, 0.8));\n  }\n\n  .message.is-user .message-content {\n    background: rgba(78, 205, 196, 0.08);\n    border-color: rgba(78, 205, 196, 0.2);\n    color: var(--text-primary, #e6edf3);\n  }\n\n  .message-text :global(p) {\n    margin: 0 0 0.5rem 0;\n  }\n\n  .message-text :global(p:last-child) {\n    margin-bottom: 0;\n  }\n\n  .message-text :global(h2) {\n    margin: 0.625rem 0 0.375rem 0;\n    font-size: 0.85rem;\n    font-weight: 600;\n    color: var(--tachi-cyan, #4ecdc4);\n  }\n\n  .message-text :global(h2:first-child) {\n    margin-top: 0;\n  }\n\n  .message-text :global(ul),\n  .message-text :global(ol) {\n    margin: 0.375rem 0;\n    padding-left: 1.125rem;\n  }\n\n  .message-text :global(li) {\n    margin-bottom: 0.125rem;\n  }\n\n  .message-text :global(strong) {\n    color: var(--text-primary, #e6edf3);\n  }\n\n  .message-text :global(hr) {\n    border: none;\n    border-top: 1px solid var(--border-color, rgba(78, 205, 196, 0.15));\n    margin: 0.625rem 0;\n  }\n\n  /* Typing Animation */\n  .typing-dots {\n    display: flex;\n    gap: 4px;\n    padding: 0.25rem 0;\n  }\n\n  .typing-dots span {\n    width: 5px;\n    height: 5px;\n    border-radius: 50%;\n    background: var(--tachi-cyan, #4ecdc4);\n    animation: dotPulse 1.2s infinite ease-in-out;\n  }\n\n  .typing-dots span:nth-child(2) { animation-delay: 0.15s; }\n  .typing-dots span:nth-child(3) { animation-delay: 0.3s; }\n\n  @keyframes dotPulse {\n    0%, 80%, 100% { opacity: 0.25; transform: scale(0.85); }\n    40% { opacity: 1; transform: scale(1); }\n  }\n\n  /* Input Area */\n  .input-area {\n    display: flex;\n    gap: 0.5rem;\n    padding: 0.75rem 1rem;\n    border-top: 1px solid var(--border-color, rgba(78, 205, 196, 0.1));\n    background: var(--bg-tertiary, #1c2128);\n  }\n\n  .chat-input {\n    flex: 1;\n    padding: 0.5rem 0.75rem;\n    background: var(--bg-secondary, #161b22);\n    border: 1px solid var(--border-color, rgba(78, 205, 196, 0.15));\n    border-radius: 6px;\n    color: var(--text-primary, #e6edf3);\n    font-size: 0.85rem;\n    transition: all 0.15s ease;\n  }\n\n  .chat-input::placeholder {\n    color: var(--text-muted, rgba(230, 237, 243, 0.35));\n  }\n\n  .chat-input:focus {\n    outline: none;\n    border-color: var(--tachi-cyan, #4ecdc4);\n    box-shadow: 0 0 0 2px rgba(78, 205, 196, 0.1);\n  }\n\n  .chat-input:disabled {\n    opacity: 0.5;\n  }\n\n  .send-btn {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    width: 36px;\n    height: 36px;\n    background: rgba(78, 205, 196, 0.1);\n    border: 1px solid rgba(78, 205, 196, 0.25);\n    border-radius: 6px;\n    color: var(--tachi-cyan, #4ecdc4);\n    cursor: pointer;\n    transition: all 0.15s ease;\n  }\n\n  .send-btn:hover:not(:disabled) {\n    background: rgba(78, 205, 196, 0.2);\n    border-color: var(--tachi-cyan, #4ecdc4);\n  }\n\n  .send-btn:disabled {\n    opacity: 0.35;\n    cursor: not-allowed;\n  }\n\n  /* Actions Bar */\n  .actions-bar {\n    display: flex;\n    gap: 0.75rem;\n    padding: 0.75rem 1rem;\n    border-top: 1px solid var(--border-color, rgba(78, 205, 196, 0.1));\n    background: linear-gradient(90deg, rgba(78, 205, 196, 0.04), transparent);\n  }\n\n  .btn-primary,\n  .btn-secondary {\n    flex: 1;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    gap: 0.375rem;\n    padding: 0.5rem 1rem;\n    border-radius: 6px;\n    font-family: var(--font-display, 'Orbitron', sans-serif);\n    font-size: 0.7rem;\n    font-weight: 600;\n    letter-spacing: 0.5px;\n    cursor: pointer;\n    transition: all 0.15s ease;\n  }\n\n  .btn-primary {\n    background: linear-gradient(135deg, var(--tachi-cyan-dark, #2d7a7a), var(--tachi-cyan, #4ecdc4));\n    color: var(--bg-primary, #0d1117);\n    border: 1px solid rgba(78, 205, 196, 0.5);\n  }\n\n  .btn-primary:hover {\n    box-shadow: 0 0 12px rgba(78, 205, 196, 0.25);\n  }\n\n  .btn-secondary {\n    background: var(--bg-tertiary, #1c2128);\n    color: var(--text-secondary, rgba(230, 237, 243, 0.7));\n    border: 1px solid var(--border-color, rgba(78, 205, 196, 0.15));\n  }\n\n  .btn-secondary:hover {\n    background: rgba(78, 205, 196, 0.08);\n    color: var(--text-primary, #e6edf3);\n  }\n</style>\n","<script lang=\"ts\">\n  import { createEventDispatcher } from 'svelte';\n  import { marked } from 'marked';\n  import GoalRefinementChat from './GoalRefinementChat.svelte';\n\n  export let value: string = '';\n  export let name: string = '';\n  export let errors: string[] = [];\n\n  const dispatch = createEventDispatcher<{\n    goalChange: string;\n    nameChange: string;\n  }>();\n\n  let showPreview = false;\n  let showRefinement = false;\n  let previewHtml = '';\n\n  function handleGoalInput(event: Event) {\n    const target = event.target as HTMLTextAreaElement;\n    const newValue = target.value;\n    value = newValue;\n    dispatch('goalChange', newValue);\n    updatePreview(newValue);\n  }\n\n  function handleNameInput(event: Event) {\n    const target = event.target as HTMLInputElement;\n    const newValue = target.value;\n    name = newValue;\n    dispatch('nameChange', newValue);\n  }\n\n  function togglePreview() {\n    showPreview = !showPreview;\n    if (showPreview) {\n      updatePreview(value);\n    }\n  }\n\n  function toggleRefinement() {\n    showRefinement = !showRefinement;\n    // Close preview when opening refinement\n    if (showRefinement && showPreview) {\n      showPreview = false;\n    }\n  }\n\n  function handleRefinementClose() {\n    showRefinement = false;\n  }\n\n  function handleApplySuggestions(event: CustomEvent<string>) {\n    const newGoal = event.detail;\n    value = newGoal;\n    dispatch('goalChange', newGoal);\n    updatePreview(newGoal);\n    showRefinement = false;\n  }\n\n  function updatePreview(content: string) {\n    if (content.trim()) {\n      previewHtml = marked(content);\n    } else {\n      previewHtml = '<p><em>No content to preview</em></p>';\n    }\n  }\n\n  // Initialize preview if value exists\n  if (value) {\n    updatePreview(value);\n  }\n</script>\n\n<div class=\"goal-input-step\" data-testid=\"goal-input-step\">\n  <div class=\"step-header\">\n    <h2>Define Session Goal</h2>\n    <p class=\"step-description\">\n      What do you want to achieve with this deliberation session? Be specific about your objectives, constraints, and success criteria.\n    </p>\n  </div>\n\n  <div class=\"form-group\">\n    <label for=\"session-name\" class=\"form-label\">\n      Session Name\n      <span class=\"required\">*</span>\n    </label>\n    <input\n      id=\"session-name\"\n      type=\"text\"\n      class=\"form-input\"\n      bind:value={name}\n      on:input={handleNameInput}\n      placeholder=\"e.g., Q4 Product Strategy Session\"\n      data-testid=\"session-name-input\"\n    />\n  </div>\n\n  <div class=\"form-group\">\n    <div class=\"goal-header\">\n      <label for=\"session-goal\" class=\"form-label\">\n        Goal Description\n        <span class=\"required\">*</span>\n      </label>\n      <div class=\"goal-controls\">\n        <button\n          type=\"button\"\n          class=\"refine-toggle\"\n          class:active={showRefinement}\n          on:click={toggleRefinement}\n          data-testid=\"refine-toggle\"\n          title=\"Guided Q&A to refine your goal\"\n        >\n          üí¨ Q&A Mode\n        </button>\n        <span class=\"char-count\" class:warning={value.length > 4500}>\n          {value.length}/5000\n        </span>\n        <button\n          type=\"button\"\n          class=\"preview-toggle\"\n          class:active={showPreview}\n          on:click={togglePreview}\n          data-testid=\"preview-toggle\"\n        >\n          {showPreview ? 'Edit' : 'Preview'}\n        </button>\n      </div>\n    </div>\n\n    <div class=\"goal-container\">\n      {#if showPreview}\n        <div \n          class=\"goal-preview\" \n          data-testid=\"goal-preview\"\n        >\n          {@html previewHtml}\n        </div>\n      {:else}\n        <textarea\n          id=\"session-goal\"\n          class=\"goal-textarea\"\n          bind:value\n          on:input={handleGoalInput}\n          placeholder=\"Describe your session goal in detail. You can use markdown formatting:\n\n**Key Questions:**\n- What decisions need to be made?\n- What constraints should we consider?\n- What are the success criteria?\n\n**Background:**\nProvide relevant context...\n\n**Expected Outcomes:**\n- Specific deliverables\n- Action items\n- Next steps\"\n          data-testid=\"goal-textarea\"\n        ></textarea>\n      {/if}\n    </div>\n\n    <div class=\"markdown-hint\">\n      <span class=\"hint-icon\">üí°</span>\n      Supports Markdown formatting: **bold**, *italic*, lists, links, etc.\n    </div>\n  </div>\n\n  {#if showRefinement}\n    <GoalRefinementChat\n      currentGoal={value}\n      on:close={handleRefinementClose}\n      on:applySuggestions={handleApplySuggestions}\n    />\n  {/if}\n\n  {#if errors.length > 0}\n    <div class=\"error-list\" role=\"alert\">\n      {#each errors as error}\n        <div class=\"error-item\">\n          <span class=\"error-icon\">‚ö†Ô∏è</span>\n          {error}\n        </div>\n      {/each}\n    </div>\n  {/if}\n\n  <div class=\"tips-section\">\n    <h3>üí° Tips for Writing Effective Goals</h3>\n    <ul class=\"tips-list\">\n      <li><strong>Be Specific:</strong> Clear, concrete objectives lead to better outcomes</li>\n      <li><strong>Include Context:</strong> Provide background information and constraints</li>\n      <li><strong>Define Success:</strong> What would a successful session look like?</li>\n      <li><strong>Set Scope:</strong> What's in scope vs. out of scope for this session?</li>\n    </ul>\n  </div>\n</div>\n\n<style>\n  .goal-input-step {\n    max-width: 100%;\n    margin: 0;\n  }\n\n  .step-header {\n    margin-bottom: 2rem;\n  }\n\n  .step-header h2 {\n    font-size: 1.5rem;\n    font-weight: 600;\n    margin-bottom: 0.75rem;\n    color: var(--text-primary);\n  }\n\n  .step-description {\n    color: var(--text-secondary);\n    line-height: 1.5;\n  }\n\n  .form-group {\n    margin-bottom: 1.5rem;\n  }\n\n  .form-label {\n    display: block;\n    font-weight: 500;\n    margin-bottom: 0.5rem;\n    color: var(--text-primary);\n  }\n\n  .required {\n    color: var(--error-color, #ef4444);\n  }\n\n  .form-input {\n    width: 100%;\n    padding: 0.875rem 1rem;\n    border: 1px solid var(--input-border);\n    border-radius: 8px;\n    font-size: 1rem;\n    background: var(--input-bg);\n    color: var(--input-text);\n    transition: all 0.2s ease;\n  }\n\n  .form-input::placeholder {\n    color: var(--text-placeholder);\n  }\n\n  .form-input:focus {\n    outline: none;\n    background: var(--input-bg-focus);\n    border-color: var(--border-focus);\n    box-shadow: 0 0 0 3px var(--primary-color-alpha);\n  }\n\n  .goal-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: end;\n    margin-bottom: 0.5rem;\n    flex-wrap: wrap;\n    gap: 0.5rem;\n  }\n\n  .goal-controls {\n    display: flex;\n    align-items: center;\n    gap: 0.75rem;\n    flex-wrap: wrap;\n  }\n\n  .refine-toggle {\n    padding: 0.375rem 0.75rem;\n    border: 1px solid var(--border-color, rgba(78, 205, 196, 0.15));\n    border-radius: 6px;\n    background: var(--bg-tertiary, #1c2128);\n    color: var(--text-secondary, rgba(230, 237, 243, 0.7));\n    font-family: var(--font-display, 'Orbitron', sans-serif);\n    font-size: 0.65rem;\n    font-weight: 600;\n    letter-spacing: 0.5px;\n    cursor: pointer;\n    transition: all 0.15s ease;\n  }\n\n  .refine-toggle:hover {\n    background: rgba(78, 205, 196, 0.08);\n    border-color: var(--tachi-cyan, #4ecdc4);\n    color: var(--text-primary, #e6edf3);\n  }\n\n  .refine-toggle.active {\n    background: rgba(78, 205, 196, 0.12);\n    border-color: var(--tachi-cyan, #4ecdc4);\n    color: var(--tachi-cyan, #4ecdc4);\n  }\n\n  .char-count {\n    font-size: 0.75rem;\n    color: var(--text-muted);\n    font-family: monospace;\n  }\n\n  .char-count.warning {\n    color: var(--warning-color, #f59e0b);\n  }\n\n  .preview-toggle {\n    padding: 0.25rem 0.75rem;\n    border: 1px solid var(--border-color);\n    border-radius: 4px;\n    background: var(--secondary-bg);\n    color: var(--text-secondary);\n    font-size: 0.875rem;\n    cursor: pointer;\n    transition: all 0.15s ease;\n  }\n\n  .preview-toggle:hover {\n    background: var(--hover-bg);\n    color: var(--text-primary);\n  }\n\n  .preview-toggle.active {\n    background: var(--primary-color);\n    color: white;\n    border-color: var(--primary-color);\n  }\n\n  .goal-container {\n    position: relative;\n    border: 1px solid var(--border-color);\n    border-radius: 6px;\n    overflow: hidden;\n  }\n\n  .goal-textarea {\n    width: 100%;\n    min-height: 300px;\n    padding: 1.25rem;\n    border: none;\n    background: var(--input-bg);\n    color: var(--input-text);\n    font-family: inherit;\n    font-size: 0.95rem;\n    line-height: 1.6;\n    resize: vertical;\n  }\n\n  .goal-textarea::placeholder {\n    color: var(--text-placeholder);\n  }\n\n  .goal-textarea:focus {\n    outline: none;\n    background: var(--input-bg-focus);\n  }\n\n  .goal-preview {\n    min-height: 300px;\n    padding: 1rem;\n    background: var(--secondary-bg);\n    color: var(--text-primary);\n    font-size: 0.9rem;\n    line-height: 1.5;\n    overflow-y: auto;\n  }\n\n  :global(.goal-preview h1),\n  :global(.goal-preview h2),\n  :global(.goal-preview h3) {\n    margin-top: 1.5rem;\n    margin-bottom: 0.75rem;\n  }\n\n  :global(.goal-preview h1:first-child),\n  :global(.goal-preview h2:first-child),\n  :global(.goal-preview h3:first-child) {\n    margin-top: 0;\n  }\n\n  :global(.goal-preview ul),\n  :global(.goal-preview ol) {\n    margin: 1rem 0;\n    padding-left: 2rem;\n  }\n\n  :global(.goal-preview p) {\n    margin: 1rem 0;\n  }\n\n  :global(.goal-preview p:first-child) {\n    margin-top: 0;\n  }\n\n  :global(.goal-preview p:last-child) {\n    margin-bottom: 0;\n  }\n\n  :global(.goal-preview code) {\n    background: var(--code-bg, #f3f4f6);\n    padding: 0.125rem 0.25rem;\n    border-radius: 3px;\n    font-size: 0.875rem;\n  }\n\n  :global(.goal-preview pre) {\n    background: var(--code-bg, #f3f4f6);\n    padding: 1rem;\n    border-radius: 6px;\n    overflow-x: auto;\n    margin: 1rem 0;\n  }\n\n  .markdown-hint {\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n    margin-top: 0.5rem;\n    font-size: 0.75rem;\n    color: var(--text-muted);\n  }\n\n  .hint-icon {\n    font-size: 1rem;\n  }\n\n  .error-list {\n    margin-top: 0.5rem;\n  }\n\n  .error-item {\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n    padding: 0.5rem 0.75rem;\n    background: var(--error-bg, #fef2f2);\n    color: var(--error-color, #dc2626);\n    border-radius: 4px;\n    margin-bottom: 0.5rem;\n    font-size: 0.875rem;\n  }\n\n  .error-icon {\n    flex-shrink: 0;\n  }\n\n  .tips-section {\n    margin-top: 2rem;\n    padding: 1.25rem 1.5rem;\n    background: var(--info-bg);\n    border-radius: 10px;\n    border: 1px solid rgba(14, 165, 233, 0.15);\n    border-left: 3px solid var(--info-color);\n  }\n\n  .tips-section h3 {\n    margin: 0 0 1rem 0;\n    font-size: 0.95rem;\n    font-weight: 600;\n    color: var(--text-primary);\n  }\n\n  .tips-list {\n    margin: 0;\n    padding-left: 1.25rem;\n    list-style-type: none;\n  }\n\n  .tips-list li {\n    margin-bottom: 0.6rem;\n    color: var(--text-secondary);\n    line-height: 1.4;\n    position: relative;\n    font-size: 0.875rem;\n  }\n\n  .tips-list li::before {\n    content: '‚Üí';\n    position: absolute;\n    left: -1.25rem;\n    color: var(--info-color);\n    font-weight: bold;\n  }\n\n  .tips-list li strong {\n    color: var(--text-primary);\n  }\n\n  /* Goal container border color */\n  .goal-container {\n    border-color: var(--input-border);\n  }\n\n  .goal-container:focus-within {\n    border-color: var(--border-focus);\n    box-shadow: 0 0 0 3px var(--primary-color-alpha);\n  }\n\n  /* Code blocks in preview */\n  :global(.goal-preview code) {\n    background: var(--code-bg);\n    color: #e879f9;\n  }\n\n  :global(.goal-preview pre) {\n    background: var(--code-bg);\n    border: 1px solid var(--border-color);\n  }\n</style>\n","<script lang=\"ts\">\n  import { createEventDispatcher } from 'svelte';\n  import type { Participant } from '$lib/types/forge';\n\n  export let selected: Participant[] = [];\n  export let errors: string[] = [];\n\n  const dispatch = createEventDispatcher<{\n    change: Participant[];\n  }>();\n\n  const brokenAvatarIds = new Set<string>();\n\n  function parseAvatar(avatar?: string): { src?: string; emoji?: string } {\n    if (!avatar) return {};\n    if (avatar.startsWith('asset:')) {\n      const raw = avatar.slice('asset:'.length);\n      const [src, emoji] = raw.split('|');\n      return { src, emoji };\n    }\n    if (avatar.startsWith('/') || avatar.startsWith('http')) {\n      return { src: avatar };\n    }\n    return { emoji: avatar };\n  }\n\n  function markAvatarBroken(id: string) {\n    brokenAvatarIds.add(id);\n  }\n\n  // Mock available participants - in real implementation would come from API\n  // Theme: Ghost in the Shell / Public Security Section 9\n  // Icons from web/static/icons/ (Iconfactory GitS set)\n  const modelOptions: Array<{ id: string; label: string }> = [\n    { id: 'claude-sonnet-4-20250514', label: 'Claude Sonnet 4' },\n    { id: 'claude-3-5-sonnet-20241022', label: 'Claude 3.5 Sonnet' },\n    { id: 'gpt-4-turbo', label: 'GPT-4 Turbo' },\n    { id: 'ollama/llama3:latest', label: 'Ollama Llama 3' },\n  ];\n\n  const availableParticipants: Participant[] = [\n    {\n      id: 'human-kusanagi',\n      name: 'Major Motoko Kusanagi',\n      type: 'human',\n      role: 'Visionary / Systems Architect',\n      status: 'active',\n      avatar: 'asset:/icons/Iconfactory-Ghost-In-The-Shell-Motoko-Kusanagi.32.png|üï∂Ô∏è',\n      estimatedCostPerRound: 0\n    },\n    {\n      id: 'human-batou',\n      name: 'Batou',\n      type: 'human',\n      role: 'Deployment Specialist / Reliability',\n      status: 'active',\n      avatar: 'asset:/icons/Iconfactory-Ghost-In-The-Shell-Bateau.32.png|ü¶æ',\n      estimatedCostPerRound: 0\n    },\n    {\n      id: 'human-togusa',\n      name: 'Togusa',\n      type: 'human',\n      role: 'QA Lead / Product Critic',\n      status: 'active',\n      avatar: 'asset:/icons/Iconfactory-Ghost-In-The-Shell-Togusa.32.png|üïµÔ∏è',\n      estimatedCostPerRound: 0\n    },\n    {\n      id: 'human-aramaki',\n      name: 'Daisuke Aramaki',\n      type: 'human',\n      role: 'Stakeholder / Strategy & Risk',\n      status: 'active',\n      avatar: 'üéñÔ∏è',\n      estimatedCostPerRound: 0\n    },\n    {\n      id: 'human-ishikawa',\n      name: 'Ishikawa',\n      type: 'human',\n      role: 'Observability / Telemetry',\n      status: 'active',\n      avatar: 'asset:/icons/Iconfactory-Ghost-In-The-Shell-Ishikawa.32.png|üì°',\n      estimatedCostPerRound: 0\n    },\n    {\n      id: 'human-saito',\n      name: 'Saito',\n      type: 'human',\n      role: 'Security / Threat Modeling',\n      status: 'active',\n      avatar: 'üéØ',\n      estimatedCostPerRound: 0\n    },\n\n    // AI participants (multi-agent think tanks)\n    {\n      id: 'ai-fuchikoma-blue',\n      name: 'Fuchikoma Blue',\n      type: 'ai',\n      role: 'Implementation Agent',\n      status: 'active',\n      modelId: 'claude-sonnet-4-20250514',\n      avatar: 'asset:/icons/Iconfactory-Ghost-In-The-Shell-Fuchikoma-Blue.32.png|üï∑Ô∏è',\n      estimatedCostPerRound: 0.03\n    },\n    {\n      id: 'ai-fuchikoma-red',\n      name: 'Fuchikoma Red',\n      type: 'ai',\n      role: 'Testing & Validation Agent',\n      status: 'active',\n      modelId: 'gpt-4-turbo',\n      avatar: 'asset:/icons/Iconfactory-Ghost-In-The-Shell-Fuchikoma-Red.32.png|üî¥',\n      estimatedCostPerRound: 0.03\n    },\n    {\n      id: 'ai-fuchikoma-purple',\n      name: 'Fuchikoma Purple',\n      type: 'ai',\n      role: 'Research & Analysis Agent',\n      status: 'active',\n      modelId: 'ollama/llama3:latest',\n      avatar: 'asset:/icons/Iconfactory-Ghost-In-The-Shell-Fuchikoma-Purple.32.png|üü£',\n      estimatedCostPerRound: 0.03\n    },\n    {\n      id: 'ai-arakone',\n      name: 'Arakone Unit',\n      type: 'ai',\n      role: 'Heavy Processing / Synthesis',\n      status: 'active',\n      modelId: 'claude-3-5-sonnet-20241022',\n      avatar: 'asset:/icons/Iconfactory-Ghost-In-The-Shell-Arakone-Unit.32.png|ü¶Ç',\n      estimatedCostPerRound: 0.06\n    },\n    {\n      id: 'ai-laughing-man',\n      name: 'Laughing Man',\n      type: 'ai',\n      role: 'Adversarial Reviewer',\n      status: 'active',\n      modelId: 'gpt-4-turbo',\n      avatar: 'üåÄ',\n      estimatedCostPerRound: 0.06\n    },\n    {\n      id: 'ai-puppet-master',\n      name: 'Puppet Master',\n      type: 'ai',\n      role: 'Orchestration & Arbitration',\n      status: 'active',\n      modelId: 'claude-sonnet-4-20250514',\n      avatar: 'üß¨',\n      estimatedCostPerRound: 0.08\n    }\n  ];\n\n  let searchQuery = '';\n  let filterType: 'all' | 'human' | 'ai' = 'all';\n\n  $: filteredParticipants = availableParticipants.filter(p => {\n    const matchesSearch = p.name.toLowerCase().includes(searchQuery.toLowerCase()) ||\n                         p.role.toLowerCase().includes(searchQuery.toLowerCase());\n    const matchesFilter = filterType === 'all' || p.type === filterType;\n    return matchesSearch && matchesFilter;\n  });\n\n  $: selectedIds = new Set(selected.map(p => p.id));\n\n  function toggleParticipant(participant: Participant) {\n    let newSelected: Participant[];\n    \n    if (selectedIds.has(participant.id)) {\n      newSelected = selected.filter(p => p.id !== participant.id);\n    } else {\n      newSelected = [...selected, participant];\n    }\n    \n    dispatch('change', newSelected);\n  }\n\n  function removeParticipant(participantId: string) {\n    const newSelected = selected.filter(p => p.id !== participantId);\n    dispatch('change', newSelected);\n  }\n\n  function setParticipantModel(participantId: string, modelId: string) {\n    const newSelected = selected.map(p => (p.id === participantId ? { ...p, modelId } : p));\n    dispatch('change', newSelected);\n  }\n\n  function clearSearch() {\n    searchQuery = '';\n  }\n\n  $: totalCost = selected.reduce((sum, p) => sum + (p.estimatedCostPerRound || 0), 0);\n</script>\n\n<div class=\"participant-select-step\" data-testid=\"participant-select-step\">\n  <div class=\"step-header\">\n    <h2>Select Participants</h2>\n    <p class=\"step-description\">\n      Choose who will participate in this deliberation session. You need at least 2 participants for meaningful discussion.\n    </p>\n  </div>\n\n  <div class=\"selected-section\">\n    <h3>Selected Participants ({selected.length})</h3>\n    {#if selected.length > 0}\n      <div class=\"selected-list\">\n        {#each selected as participant (participant.id)}\n          {@const a = parseAvatar(participant.avatar)}\n          <div class=\"selected-item\" data-testid=\"selected-participant-{participant.id}\">\n            <div class=\"participant-avatar\">\n              {#if a.src && !brokenAvatarIds.has(participant.id)}\n                <img\n                  src={a.src}\n                  alt=\"\"\n                  on:error={() => markAvatarBroken(participant.id)}\n                />\n              {:else}\n                <span class=\"avatar-emoji\" aria-hidden=\"true\">{a.emoji || 'üë§'}</span>\n              {/if}\n            </div>\n            <div class=\"participant-info\">\n              <div class=\"participant-name\">{participant.name}</div>\n              <div class=\"participant-role\">{participant.role}</div>\n            </div>\n            <div class=\"participant-meta\">\n              <span class=\"participant-type\" class:human={participant.type === 'human'} class:ai={participant.type === 'ai'}>\n                {participant.type.toUpperCase()}\n              </span>\n              {#if participant.type === 'ai'}\n                <select\n                  class=\"model-select\"\n                  value={participant.modelId || 'claude-sonnet-4-20250514'}\n                  on:change={(e) => setParticipantModel(participant.id, e.currentTarget.value)}\n                  aria-label=\"Model for {participant.name}\"\n                >\n                  {#each modelOptions as opt}\n                    <option value={opt.id}>{opt.label}</option>\n                  {/each}\n                </select>\n              {/if}\n              {#if participant.estimatedCostPerRound}\n                <span class=\"participant-cost\">${participant.estimatedCostPerRound.toFixed(3)}/round</span>\n              {/if}\n            </div>\n            <button\n              type=\"button\"\n              class=\"remove-btn\"\n              on:click={() => removeParticipant(participant.id)}\n              aria-label=\"Remove {participant.name}\"\n            >\n              √ó\n            </button>\n          </div>\n        {/each}\n        \n        {#if totalCost > 0}\n          <div class=\"cost-summary\">\n            <span class=\"cost-label\">Total estimated cost per round:</span>\n            <span class=\"cost-value\">${totalCost.toFixed(3)}</span>\n          </div>\n        {/if}\n      </div>\n    {:else}\n      <div class=\"empty-state\">\n        <div class=\"empty-icon\">üë•</div>\n        <p>No participants selected yet</p>\n        <p class=\"empty-hint\">Choose from the available participants below</p>\n      </div>\n    {/if}\n  </div>\n\n  <div class=\"search-section\">\n    <div class=\"search-controls\">\n      <div class=\"search-input-container\">\n        <input\n          type=\"text\"\n          class=\"search-input\"\n          placeholder=\"Search participants by name or role...\"\n          bind:value={searchQuery}\n          data-testid=\"participant-search\"\n        />\n        {#if searchQuery}\n          <button \n            type=\"button\" \n            class=\"search-clear\"\n            on:click={clearSearch}\n            aria-label=\"Clear search\"\n          >\n            √ó\n          </button>\n        {/if}\n      </div>\n\n      <div class=\"filter-controls\">\n        <button\n          type=\"button\"\n          class=\"filter-btn\"\n          class:active={filterType === 'all'}\n          on:click={() => filterType = 'all'}\n        >\n          All\n        </button>\n        <button\n          type=\"button\"\n          class=\"filter-btn\"\n          class:active={filterType === 'human'}\n          on:click={() => filterType = 'human'}\n        >\n          Human\n        </button>\n        <button\n          type=\"button\"\n          class=\"filter-btn\"\n          class:active={filterType === 'ai'}\n          on:click={() => filterType = 'ai'}\n        >\n          AI\n        </button>\n      </div>\n    </div>\n  </div>\n\n  <div class=\"available-section\">\n    <h3>Available Participants</h3>\n    {#if filteredParticipants.length > 0}\n      <div class=\"participant-grid\">\n        {#each filteredParticipants as participant (participant.id)}\n          {@const a = parseAvatar(participant.avatar)}\n          <button\n            type=\"button\"\n            class=\"participant-card\"\n            class:selected={selectedIds.has(participant.id)}\n            on:click={() => toggleParticipant(participant)}\n            data-testid=\"participant-{participant.id}\"\n          >\n            <div class=\"card-header\">\n              <div class=\"participant-avatar\">\n                {#if a.src && !brokenAvatarIds.has(participant.id)}\n                  <img\n                    src={a.src}\n                    alt=\"\"\n                    on:error={() => markAvatarBroken(participant.id)}\n                  />\n                {:else}\n                  <span class=\"avatar-emoji\" aria-hidden=\"true\">{a.emoji || 'üë§'}</span>\n                {/if}\n              </div>\n              <div class=\"participant-type\" class:human={participant.type === 'human'} class:ai={participant.type === 'ai'}>\n                {participant.type.toUpperCase()}\n              </div>\n            </div>\n            <div class=\"card-body\">\n              <div class=\"participant-name\">{participant.name}</div>\n              <div class=\"participant-role\">{participant.role}</div>\n              {#if participant.estimatedCostPerRound}\n                <div class=\"participant-cost\">${participant.estimatedCostPerRound.toFixed(3)}/round</div>\n              {/if}\n            </div>\n            {#if selectedIds.has(participant.id)}\n              <div class=\"selected-indicator\">‚úì</div>\n            {/if}\n          </button>\n        {/each}\n      </div>\n    {:else}\n      <div class=\"no-results\">\n        <div class=\"no-results-icon\">üîç</div>\n        <p>No participants found</p>\n        <p class=\"no-results-hint\">Try adjusting your search or filter</p>\n      </div>\n    {/if}\n  </div>\n\n  {#if errors.length > 0}\n    <div class=\"error-list\" role=\"alert\">\n      {#each errors as error}\n        <div class=\"error-item\">\n          <span class=\"error-icon\">‚ö†Ô∏è</span>\n          {error}\n        </div>\n      {/each}\n    </div>\n  {/if}\n</div>\n\n<style>\n  .participant-select-step {\n    max-width: 960px;\n    margin: 0 auto;\n  }\n\n  .step-header {\n    margin-bottom: 2rem;\n  }\n\n  .step-header h2 {\n    font-size: 1.5rem;\n    font-weight: 600;\n    margin-bottom: 0.75rem;\n    color: var(--text-primary, #e6edf3);\n    letter-spacing: 1px;\n    text-transform: uppercase;\n  }\n\n  .step-description {\n    color: var(--text-secondary, rgba(230, 237, 243, 0.7));\n    line-height: 1.5;\n  }\n\n  .selected-section,\n  .available-section {\n    margin-bottom: 2rem;\n  }\n\n  .selected-section h3,\n  .available-section h3 {\n    font-size: 1.25rem;\n    font-weight: 600;\n    margin-bottom: 1rem;\n    color: var(--text-primary, #e6edf3);\n  }\n\n  .selected-list {\n    border: 1px dashed rgba(78, 205, 196, 0.28);\n    border-radius: 14px;\n    padding: 1rem;\n    background: rgba(13, 17, 23, 0.22);\n    -webkit-backdrop-filter: blur(12px) saturate(1.15);\n    backdrop-filter: blur(12px) saturate(1.15);\n  }\n\n  .selected-item {\n    display: flex;\n    align-items: center;\n    gap: 1rem;\n    padding: 0.75rem;\n    background: rgba(22, 27, 34, 0.45);\n    border: 1px solid rgba(78, 205, 196, 0.14);\n    border-radius: 12px;\n    margin-bottom: 0.5rem;\n    box-shadow: 0 0 0 1px rgba(0, 0, 0, 0.25) inset;\n  }\n\n  .selected-item:last-child {\n    margin-bottom: 0;\n  }\n\n  .participant-avatar {\n    font-size: 1.5rem;\n    width: 2.5rem;\n    height: 2.5rem;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    background: rgba(13, 17, 23, 0.55);\n    border: 1px solid rgba(78, 205, 196, 0.14);\n    border-radius: 50%;\n    color: var(--text-primary, #e6edf3);\n    overflow: hidden;\n  }\n\n  .participant-avatar img {\n    width: 100%;\n    height: 100%;\n    object-fit: cover;\n    border-radius: 50%;\n    filter: saturate(1.05) contrast(1.05);\n  }\n\n  .avatar-emoji {\n    line-height: 1;\n  }\n\n  .participant-info {\n    flex: 1;\n  }\n\n  .participant-name {\n    font-weight: 500;\n    color: var(--text-primary, #e6edf3);\n    margin-bottom: 0.25rem;\n  }\n\n  .participant-role {\n    font-size: 0.875rem;\n    color: var(--text-secondary, rgba(230, 237, 243, 0.7));\n  }\n\n  .participant-meta {\n    display: flex;\n    flex-direction: column;\n    align-items: end;\n    gap: 0.25rem;\n  }\n\n  .model-select {\n    width: 100%;\n    max-width: 200px;\n    padding: 0.35rem 0.5rem;\n    border-radius: 10px;\n    border: 1px solid rgba(78, 205, 196, 0.18);\n    background: rgba(13, 17, 23, 0.45);\n    color: rgba(230, 237, 243, 0.85);\n    font-size: 0.75rem;\n    cursor: pointer;\n  }\n\n  .model-select:focus {\n    outline: none;\n    border-color: rgba(78, 205, 196, 0.5);\n    box-shadow: 0 0 0 2px rgba(78, 205, 196, 0.1);\n  }\n\n  .participant-type {\n    font-size: 0.75rem;\n    font-weight: 500;\n    padding: 0.125rem 0.5rem;\n    border-radius: 12px;\n    text-transform: uppercase;\n    letter-spacing: 1px;\n    font-family: var(--font-display, 'Orbitron', sans-serif);\n    border: 1px solid rgba(78, 205, 196, 0.18);\n    background: rgba(13, 17, 23, 0.35);\n  }\n\n  .participant-type.human {\n    background: rgba(63, 185, 80, 0.12);\n    color: rgba(63, 185, 80, 0.95);\n    border-color: rgba(63, 185, 80, 0.35);\n  }\n\n  .participant-type.ai {\n    background: rgba(88, 166, 255, 0.12);\n    color: rgba(88, 166, 255, 0.95);\n    border-color: rgba(88, 166, 255, 0.35);\n  }\n\n  .participant-cost {\n    font-size: 0.75rem;\n    color: var(--text-muted, rgba(230, 237, 243, 0.5));\n    font-family: 'JetBrains Mono', ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace;\n  }\n\n  .remove-btn {\n    width: 1.5rem;\n    height: 1.5rem;\n    border: none;\n    background: rgba(255, 107, 107, 0.12);\n    color: rgba(255, 107, 107, 0.95);\n    border-radius: 50%;\n    cursor: pointer;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    font-size: 1rem;\n    transition: background-color 0.15s ease;\n  }\n\n  .remove-btn:hover {\n    background: rgba(255, 107, 107, 0.25);\n    color: rgba(255, 255, 255, 0.9);\n  }\n\n  .cost-summary {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-top: 0.75rem;\n    padding-top: 0.75rem;\n    border-top: 1px solid rgba(78, 205, 196, 0.14);\n    font-weight: 500;\n  }\n\n  .cost-label {\n    color: var(--text-secondary, rgba(230, 237, 243, 0.7));\n  }\n\n  .cost-value {\n    color: var(--text-primary, #e6edf3);\n    font-family: 'JetBrains Mono', ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace;\n  }\n\n  .empty-state,\n  .no-results {\n    text-align: center;\n    padding: 2rem;\n    color: var(--text-muted, rgba(230, 237, 243, 0.45));\n  }\n\n  .empty-icon,\n  .no-results-icon {\n    font-size: 2rem;\n    margin-bottom: 1rem;\n  }\n\n  .empty-hint,\n  .no-results-hint {\n    font-size: 0.875rem;\n    margin-top: 0.5rem;\n  }\n\n  .search-section {\n    margin-bottom: 1.5rem;\n  }\n\n  .search-controls {\n    display: flex;\n    gap: 1rem;\n    align-items: center;\n    flex-wrap: wrap;\n  }\n\n  .search-input-container {\n    position: relative;\n    flex: 1;\n    min-width: 250px;\n  }\n\n  .search-input {\n    width: 100%;\n    padding: 0.75rem 1rem;\n    border-radius: 12px;\n    font-size: 0.875rem;\n    background: rgba(13, 17, 23, 0.35);\n    border: 1px solid rgba(78, 205, 196, 0.14);\n    color: var(--text-primary, #e6edf3);\n  }\n\n  .search-input:focus {\n    outline: none;\n    border-color: rgba(78, 205, 196, 0.55);\n    box-shadow: 0 0 0 3px rgba(78, 205, 196, 0.12);\n  }\n\n  .search-clear {\n    position: absolute;\n    right: 0.5rem;\n    top: 50%;\n    transform: translateY(-50%);\n    width: 1.5rem;\n    height: 1.5rem;\n    border: none;\n    background: rgba(13, 17, 23, 0.45);\n    border: 1px solid rgba(78, 205, 196, 0.14);\n    border-radius: 50%;\n    cursor: pointer;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    font-size: 1rem;\n    color: var(--text-muted, rgba(230, 237, 243, 0.5));\n  }\n\n  .search-clear:hover {\n    background: rgba(78, 205, 196, 0.12);\n    color: rgba(230, 237, 243, 0.85);\n  }\n\n  .filter-controls {\n    display: flex;\n    gap: 0.25rem;\n  }\n\n  .filter-btn {\n    padding: 0.5rem 1rem;\n    border: 1px solid rgba(78, 205, 196, 0.14);\n    background: rgba(13, 17, 23, 0.25);\n    color: var(--text-secondary, rgba(230, 237, 243, 0.7));\n    border-radius: 12px;\n    cursor: pointer;\n    font-size: 0.875rem;\n    transition: all 0.15s ease;\n  }\n\n  .filter-btn:hover {\n    background: var(--hover-bg);\n    color: var(--text-primary, #e6edf3);\n    border-color: rgba(78, 205, 196, 0.28);\n  }\n\n  .filter-btn.active {\n    background: linear-gradient(135deg, rgba(45, 122, 122, 0.9), rgba(78, 205, 196, 0.9));\n    color: rgba(13, 17, 23, 0.95);\n    border-color: rgba(78, 205, 196, 0.65);\n    box-shadow: 0 0 18px rgba(78, 205, 196, 0.2);\n  }\n\n  .participant-grid {\n    display: grid;\n    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));\n    gap: 1rem;\n  }\n\n  .participant-card {\n    position: relative;\n    padding: 1rem;\n    border: 1px solid rgba(78, 205, 196, 0.14);\n    border-radius: 14px;\n    background:\n      linear-gradient(135deg, rgba(255, 255, 255, 0.05), rgba(255, 255, 255, 0.01)),\n      rgba(13, 17, 23, 0.35);\n    cursor: pointer;\n    transition: all 0.15s ease;\n    text-align: left;\n    box-shadow:\n      0 0 0 1px rgba(0, 0, 0, 0.25) inset,\n      0 12px 35px rgba(0, 0, 0, 0.25);\n    -webkit-backdrop-filter: blur(12px) saturate(1.1);\n    backdrop-filter: blur(12px) saturate(1.1);\n  }\n\n  .participant-card:hover {\n    border-color: rgba(78, 205, 196, 0.5);\n    transform: translateY(-1px);\n    box-shadow:\n      0 0 0 1px rgba(0, 0, 0, 0.25) inset,\n      0 18px 50px rgba(0, 0, 0, 0.3),\n      0 0 22px rgba(78, 205, 196, 0.12);\n  }\n\n  .participant-card.selected {\n    border-color: rgba(78, 205, 196, 0.75);\n    box-shadow:\n      0 0 0 3px rgba(78, 205, 196, 0.14),\n      0 18px 55px rgba(0, 0, 0, 0.35);\n  }\n\n  .card-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 0.75rem;\n  }\n\n  .card-body .participant-name {\n    font-size: 1rem;\n    font-weight: 600;\n    margin-bottom: 0.25rem;\n  }\n\n  .card-body .participant-role {\n    font-size: 0.875rem;\n    margin-bottom: 0.5rem;\n  }\n\n  .card-body .participant-cost {\n    font-size: 0.75rem;\n    font-family: monospace;\n  }\n\n  .selected-indicator {\n    position: absolute;\n    top: 0.5rem;\n    right: 0.5rem;\n    width: 1.5rem;\n    height: 1.5rem;\n    background: rgba(78, 205, 196, 0.9);\n    color: rgba(13, 17, 23, 0.95);\n    border-radius: 50%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    font-size: 0.75rem;\n    font-weight: bold;\n    box-shadow: 0 0 16px rgba(78, 205, 196, 0.25);\n  }\n\n  .error-list {\n    margin-top: 1rem;\n  }\n\n  .error-item {\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n    padding: 0.75rem;\n    background: rgba(255, 107, 107, 0.08);\n    color: rgba(230, 237, 243, 0.85);\n    border-radius: 12px;\n    border: 1px solid rgba(255, 107, 107, 0.25);\n    margin-bottom: 0.5rem;\n    font-size: 0.875rem;\n  }\n\n  .participant-card:focus-visible,\n  .filter-btn:focus-visible,\n  .remove-btn:focus-visible,\n  .search-clear:focus-visible {\n    outline: 2px solid rgba(78, 205, 196, 0.85);\n    outline-offset: 2px;\n  }\n\n  .error-icon {\n    flex-shrink: 0;\n  }\n\n  @media (max-width: 768px) {\n    .search-controls {\n      flex-direction: column;\n      align-items: stretch;\n    }\n\n    .participant-grid {\n      grid-template-columns: 1fr;\n    }\n\n    .selected-item {\n      flex-wrap: wrap;\n      gap: 0.5rem;\n    }\n\n    .participant-meta {\n      flex-direction: row;\n      align-items: center;\n    }\n  }\n</style>","<script lang=\"ts\">\n  import { createEventDispatcher } from 'svelte';\n  import { slide } from 'svelte/transition';\n  import Icon from '$lib/components/common/Icon.svelte';\n  import type { Oracle, Participant, SessionConfig } from '$lib/types/forge';\n\n  export let selectedOracle: Oracle | null = null;\n  export let participants: Participant[] = [];\n  export let config: SessionConfig;\n  export let errors: string[] = [];\n\n  const dispatch = createEventDispatcher<{\n    oracleChange: Oracle | null;\n    configChange: SessionConfig;\n  }>();\n\n  let showAdvanced = false;\n\n  // Mock oracle data - in a real app this would come from a store\n  const availableOracles: Oracle[] = [\n    {\n      id: 'consensus-oracle-1',\n      name: 'Consensus Oracle',\n      type: 'consensus',\n      config: { threshold: 0.8, method: 'weighted_voting' },\n      estimatedCostPerRound: 0.005\n    },\n    {\n      id: 'gpt4-oracle-1',\n      name: 'LLM Oracle (Analyst)',\n      type: 'llm',\n      config: { model: 'gpt-4', temperature: 0.3 },\n      estimatedCostPerRound: 0.02\n    },\n    {\n      id: 'claude-oracle-1',\n      name: 'LLM Oracle (Architect)',\n      type: 'llm',\n      config: { model: 'claude-3-sonnet', temperature: 0.2 },\n      estimatedCostPerRound: 0.015\n    },\n    {\n      id: 'hybrid-oracle-1',\n      name: 'Hybrid Oracle',\n      type: 'hybrid',\n      config: { llm_weight: 0.6, consensus_weight: 0.4 },\n      estimatedCostPerRound: 0.012\n    }\n  ];\n\n  // Oracle temperature slider\n  let oracleTemperature = 0.3;\n  \n  // Convergence threshold presets\n  const convergencePresets = [\n    { value: 0.7, label: '70%' },\n    { value: 0.8, label: '80%' },\n    { value: 0.9, label: '90%' }\n  ];\n\n  // Max rounds options\n  const maxRoundsOptions = [3, 5, 7, 10, 15, 20];\n  \n  // Timeout options (in minutes)\n  const timeoutOptions = [\n    { value: 15, label: '15 min' },\n    { value: 30, label: '30 min' },\n    { value: 60, label: '1 hr' },\n    { value: 120, label: '2 hr' },\n    { value: 240, label: '4 hr' },\n    { value: 480, label: '8 hr' }\n  ];\n\n  // Auto-save options\n  const autoSaveOptions = [\n    { value: 15000, label: '15s' },\n    { value: 30000, label: '30s' },\n    { value: 60000, label: '1m' },\n    { value: 300000, label: '5m' },\n    { value: 0, label: 'Off' }\n  ];\n\n  function handleOracleSelect(oracle: Oracle) {\n    selectedOracle = oracle;\n    // Update temperature from oracle config if available\n    if (oracle.config.temperature !== undefined) {\n      oracleTemperature = oracle.config.temperature;\n    }\n    dispatch('oracleChange', oracle);\n  }\n\n  function handleTemperatureChange(value: number) {\n    oracleTemperature = value;\n    if (selectedOracle) {\n      const updatedOracle = {\n        ...selectedOracle,\n        config: { ...selectedOracle.config, temperature: value }\n      };\n      selectedOracle = updatedOracle;\n      dispatch('oracleChange', updatedOracle);\n    }\n  }\n\n  function updateConfig(field: keyof SessionConfig, value: unknown) {\n    const updatedConfig = { ...config, [field]: value };\n    config = updatedConfig;\n    dispatch('configChange', updatedConfig);\n  }\n\n  function getCompatibilityScore(oracle: Oracle): number {\n    const aiParticipants = participants.filter(p => p.type === 'ai').length;\n    const humanParticipants = participants.filter(p => p.type === 'human').length;\n    \n    switch (oracle.type) {\n      case 'consensus':\n        return Math.min(0.9, 0.6 + (participants.length * 0.05));\n      case 'llm':\n        return Math.min(0.95, 0.7 + (aiParticipants * 0.1));\n      case 'hybrid':\n        return Math.min(0.9, 0.8 + (Math.min(aiParticipants, humanParticipants) * 0.05));\n      default:\n        return 0.5;\n    }\n  }\n\n  function getOracleIcon(type: string): string {\n    switch (type) {\n      case 'llm': return 'brain';\n      case 'consensus': return 'check-circle';\n      case 'hybrid': return 'refresh-cw';\n      default: return 'cpu';\n    }\n  }\n\n  function getOracleAccent(type: string): string {\n    switch (type) {\n      case 'llm': return 'rgba(88, 166, 255, 0.9)';\n      case 'consensus': return 'rgba(63, 185, 80, 0.9)';\n      case 'hybrid': return 'rgba(78, 205, 196, 0.9)';\n      default: return 'rgba(139, 92, 246, 0.9)';\n    }\n  }\n\n  $: sortedOracles = availableOracles\n    .map(oracle => ({\n      ...oracle,\n      compatibility: getCompatibilityScore(oracle)\n    }))\n    .sort((a, b) => b.compatibility - a.compatibility);\n\n  $: temperatureLabel = oracleTemperature <= 0.3 ? 'Precise' : oracleTemperature >= 0.7 ? 'Creative' : 'Balanced';\n</script>\n\n<div class=\"oracle-config-panel\" data-testid=\"oracle-config-panel\">\n  <div class=\"panel-header\">\n    <div class=\"header-icon\">\n      <Icon name=\"sliders\" size={18} glow />\n    </div>\n    <div class=\"header-text\">\n      <h2>Oracle & Session Configuration</h2>\n      <p>Configure the AI orchestrator and session parameters</p>\n    </div>\n  </div>\n\n  {#if errors.length > 0}\n    <div class=\"error-banner\" role=\"alert\">\n      <Icon name=\"alert-triangle\" size={16} />\n      {#each errors as error}\n        <span>{error}</span>\n      {/each}\n    </div>\n  {/if}\n\n  <div class=\"two-column-layout\">\n    <!-- Left Column: Oracle Selection -->\n    <div class=\"column oracle-column\">\n      <div class=\"section-header\">\n        <Icon name=\"brain\" size={16} glow />\n        <span>Oracle</span>\n      </div>\n\n      <!-- Oracle Selection Dropdown -->\n      <div class=\"compact-group\">\n        <label class=\"compact-label\">Model</label>\n        <select\n          class=\"compact-select\"\n          value={selectedOracle?.id || ''}\n          on:change={(e) => {\n            const oracle = sortedOracles.find(o => o.id === e.currentTarget.value);\n            if (oracle) handleOracleSelect(oracle);\n          }}\n        >\n          <option value=\"\" disabled>Select an oracle...</option>\n          {#each sortedOracles as oracle}\n            <option value={oracle.id}>\n              {oracle.name} ({oracle.type})\n            </option>\n          {/each}\n        </select>\n      </div>\n\n      <!-- Temperature Slider (only for LLM oracles) -->\n      {#if selectedOracle && (selectedOracle.type === 'llm' || selectedOracle.type === 'hybrid')}\n        <div class=\"compact-group\">\n          <label class=\"compact-label\">Temperature</label>\n          <div class=\"temperature-control\">\n            <input\n              type=\"range\"\n              min=\"0\"\n              max=\"1\"\n              step=\"0.1\"\n              value={oracleTemperature}\n              on:input={(e) => handleTemperatureChange(parseFloat(e.currentTarget.value))}\n              class=\"vertical-slider\"\n            />\n            <div class=\"temperature-info\">\n              <span class=\"temp-value\">{oracleTemperature.toFixed(1)}</span>\n              <span class=\"temp-label\">{temperatureLabel}</span>\n            </div>\n          </div>\n          <div class=\"slider-labels\">\n            <span>Precise</span>\n            <span>Creative</span>\n          </div>\n        </div>\n      {/if}\n\n      <!-- Cost Estimate -->\n      {#if selectedOracle}\n        <div class=\"cost-display\">\n          <Icon name=\"dollar-sign\" size={14} />\n          <span>~${selectedOracle.estimatedCostPerRound?.toFixed(3) || '0.00'}/round</span>\n        </div>\n      {/if}\n\n      <!-- Oracle Type Cards (compact radio buttons) -->\n      <div class=\"oracle-types\">\n        {#each sortedOracles as oracle}\n          <button\n            type=\"button\"\n            class=\"oracle-chip\"\n            class:selected={selectedOracle?.id === oracle.id}\n            style=\"--oracle-accent: {getOracleAccent(oracle.type)}\"\n            on:click={() => handleOracleSelect(oracle)}\n          >\n            <Icon name={getOracleIcon(oracle.type)} size={14} />\n            <span class=\"chip-label\">{oracle.type}</span>\n          </button>\n        {/each}\n      </div>\n    </div>\n\n    <!-- Right Column: Session Parameters -->\n    <div class=\"column config-column\">\n      <div class=\"section-header\">\n        <Icon name=\"settings\" size={16} glow />\n        <span>Session Parameters</span>\n      </div>\n\n      <!-- Max Rounds -->\n      <div class=\"compact-group inline-group\">\n        <label class=\"compact-label\">Max Rounds</label>\n        <select\n          class=\"compact-select small\"\n          value={config.maxRounds}\n          on:change={(e) => updateConfig('maxRounds', parseInt(e.currentTarget.value))}\n        >\n          {#each maxRoundsOptions as opt}\n            <option value={opt}>{opt}</option>\n          {/each}\n        </select>\n      </div>\n\n      <!-- Convergence Threshold with Presets -->\n      <div class=\"compact-group\">\n        <label class=\"compact-label\">Convergence</label>\n        <div class=\"preset-buttons\">\n          {#each convergencePresets as preset}\n            <button\n              type=\"button\"\n              class=\"preset-btn\"\n              class:active={config.convergenceThreshold === preset.value}\n              on:click={() => updateConfig('convergenceThreshold', preset.value)}\n            >\n              {preset.label}\n            </button>\n          {/each}\n        </div>\n      </div>\n\n      <!-- Timeout -->\n      <div class=\"compact-group inline-group\">\n        <label class=\"compact-label\">Timeout</label>\n        <select\n          class=\"compact-select small\"\n          value={config.timeoutMinutes}\n          on:change={(e) => updateConfig('timeoutMinutes', parseInt(e.currentTarget.value))}\n        >\n          {#each timeoutOptions as opt}\n            <option value={opt.value}>{opt.label}</option>\n          {/each}\n        </select>\n      </div>\n\n      <!-- Advanced Options Toggle -->\n      <button\n        type=\"button\"\n        class=\"advanced-toggle\"\n        on:click={() => showAdvanced = !showAdvanced}\n        aria-expanded={showAdvanced}\n      >\n        <Icon name={showAdvanced ? 'chevron-down' : 'chevron-right'} size={14} />\n        <span>Advanced Options</span>\n      </button>\n\n      {#if showAdvanced}\n        <div class=\"advanced-options\" transition:slide={{ duration: 200 }}>\n          <!-- Human Intervention -->\n          <label class=\"checkbox-group\">\n            <input\n              type=\"checkbox\"\n              checked={config.allowHumanIntervention}\n              on:change={(e) => updateConfig('allowHumanIntervention', e.currentTarget.checked)}\n            />\n            <span class=\"checkbox-label\">Human Intervention</span>\n          </label>\n\n          <!-- Auto-save Interval -->\n          <div class=\"compact-group inline-group\">\n            <label class=\"compact-label\">Auto-save</label>\n            <select\n              class=\"compact-select small\"\n              value={config.autoSaveInterval}\n              on:change={(e) => updateConfig('autoSaveInterval', parseInt(e.currentTarget.value))}\n            >\n              {#each autoSaveOptions as opt}\n                <option value={opt.value}>{opt.label}</option>\n              {/each}\n            </select>\n          </div>\n        </div>\n      {/if}\n    </div>\n  </div>\n\n  <!-- Selection Summary (compact) -->\n  {#if selectedOracle}\n    <div class=\"summary-bar\">\n      <div class=\"summary-item\">\n        <Icon name=\"brain\" size={14} />\n        <span>{selectedOracle.name}</span>\n      </div>\n      <div class=\"summary-divider\">‚Ä¢</div>\n      <div class=\"summary-item\">\n        <span>{config.maxRounds} rounds</span>\n      </div>\n      <div class=\"summary-divider\">‚Ä¢</div>\n      <div class=\"summary-item\">\n        <span>{Math.round(config.convergenceThreshold * 100)}% threshold</span>\n      </div>\n      <div class=\"summary-divider\">‚Ä¢</div>\n      <div class=\"summary-item\">\n        <span>{config.timeoutMinutes}m timeout</span>\n      </div>\n    </div>\n  {/if}\n</div>\n\n<style>\n  .oracle-config-panel {\n    max-width: 900px;\n    margin: 0 auto;\n  }\n\n  .panel-header {\n    display: flex;\n    align-items: flex-start;\n    gap: 0.75rem;\n    margin-bottom: 1.5rem;\n  }\n\n  .header-icon {\n    width: 40px;\n    height: 40px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    border-radius: 10px;\n    background: linear-gradient(135deg, rgba(78, 205, 196, 0.18), rgba(78, 205, 196, 0.05));\n    border: 1px solid rgba(78, 205, 196, 0.22);\n    color: var(--tachi-cyan, #4ecdc4);\n    flex-shrink: 0;\n  }\n\n  .header-text h2 {\n    font-size: 1.25rem;\n    font-weight: 600;\n    margin: 0 0 0.25rem 0;\n    color: var(--text-primary, #e6edf3);\n    letter-spacing: 0.5px;\n    text-transform: uppercase;\n  }\n\n  .header-text p {\n    margin: 0;\n    color: rgba(230, 237, 243, 0.6);\n    font-size: 0.875rem;\n  }\n\n  .error-banner {\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n    padding: 0.65rem 0.85rem;\n    margin-bottom: 1.25rem;\n    border-radius: 10px;\n    background: rgba(255, 107, 107, 0.08);\n    border: 1px solid rgba(255, 107, 107, 0.22);\n    color: rgba(255, 107, 107, 0.95);\n    font-size: 0.875rem;\n  }\n\n  .two-column-layout {\n    display: grid;\n    grid-template-columns: 1fr 1fr;\n    gap: 2rem;\n  }\n\n  .column {\n    display: flex;\n    flex-direction: column;\n    gap: 1rem;\n  }\n\n  .section-header {\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n    font-family: var(--font-display, 'Orbitron', sans-serif);\n    font-size: 0.7rem;\n    font-weight: 600;\n    letter-spacing: 1.5px;\n    text-transform: uppercase;\n    color: rgba(78, 205, 196, 0.9);\n    padding-bottom: 0.5rem;\n    border-bottom: 1px solid rgba(78, 205, 196, 0.14);\n    margin-bottom: 0.5rem;\n  }\n\n  .compact-group {\n    display: flex;\n    flex-direction: column;\n    gap: 0.35rem;\n  }\n\n  .inline-group {\n    flex-direction: row;\n    align-items: center;\n    justify-content: space-between;\n  }\n\n  .compact-label {\n    font-size: 0.7rem;\n    font-weight: 500;\n    letter-spacing: 0.8px;\n    text-transform: uppercase;\n    color: rgba(230, 237, 243, 0.6);\n  }\n\n  .compact-select {\n    width: 100%;\n    padding: 0.5rem 0.75rem;\n    padding-right: 2rem;\n    border: 1px solid rgba(78, 205, 196, 0.18);\n    border-radius: 8px;\n    background: rgba(13, 17, 23, 0.5);\n    color: var(--text-primary, #e6edf3);\n    font-size: 0.875rem;\n    cursor: pointer;\n    appearance: none;\n    background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='%234ecdc4' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E\");\n    background-repeat: no-repeat;\n    background-position: right 0.75rem center;\n  }\n\n  .compact-select.small {\n    width: auto;\n    min-width: 80px;\n  }\n\n  .compact-select:focus {\n    outline: none;\n    border-color: rgba(78, 205, 196, 0.5);\n    box-shadow: 0 0 0 2px rgba(78, 205, 196, 0.1);\n  }\n\n  .temperature-control {\n    display: flex;\n    align-items: center;\n    gap: 0.75rem;\n  }\n\n  .vertical-slider {\n    flex: 1;\n    height: 6px;\n    -webkit-appearance: none;\n    appearance: none;\n    background: linear-gradient(90deg, rgba(88, 166, 255, 0.3), rgba(255, 107, 107, 0.3));\n    border-radius: 999px;\n    border: 1px solid rgba(78, 205, 196, 0.12);\n    cursor: pointer;\n  }\n\n  .vertical-slider::-webkit-slider-thumb {\n    -webkit-appearance: none;\n    appearance: none;\n    width: 16px;\n    height: 16px;\n    background: var(--tachi-cyan, #4ecdc4);\n    border-radius: 50%;\n    cursor: pointer;\n    box-shadow: 0 0 10px rgba(78, 205, 196, 0.5);\n  }\n\n  .vertical-slider::-moz-range-thumb {\n    width: 16px;\n    height: 16px;\n    background: var(--tachi-cyan, #4ecdc4);\n    border-radius: 50%;\n    cursor: pointer;\n    border: none;\n    box-shadow: 0 0 10px rgba(78, 205, 196, 0.5);\n  }\n\n  .temperature-info {\n    display: flex;\n    flex-direction: column;\n    align-items: flex-end;\n    min-width: 60px;\n  }\n\n  .temp-value {\n    font-family: 'JetBrains Mono', monospace;\n    font-size: 0.875rem;\n    font-weight: 600;\n    color: var(--text-primary, #e6edf3);\n  }\n\n  .temp-label {\n    font-size: 0.65rem;\n    color: rgba(230, 237, 243, 0.5);\n    text-transform: uppercase;\n    letter-spacing: 0.5px;\n  }\n\n  .slider-labels {\n    display: flex;\n    justify-content: space-between;\n    font-size: 0.65rem;\n    color: rgba(230, 237, 243, 0.4);\n    margin-top: -0.25rem;\n  }\n\n  .cost-display {\n    display: inline-flex;\n    align-items: center;\n    gap: 0.35rem;\n    padding: 0.35rem 0.6rem;\n    border-radius: 999px;\n    background: rgba(63, 185, 80, 0.08);\n    border: 1px solid rgba(63, 185, 80, 0.18);\n    color: rgba(63, 185, 80, 0.95);\n    font-size: 0.75rem;\n    font-weight: 500;\n    width: fit-content;\n  }\n\n  .oracle-types {\n    display: flex;\n    flex-wrap: wrap;\n    gap: 0.5rem;\n    margin-top: 0.5rem;\n  }\n\n  .oracle-chip {\n    display: inline-flex;\n    align-items: center;\n    gap: 0.35rem;\n    padding: 0.35rem 0.65rem;\n    border-radius: 999px;\n    background: rgba(13, 17, 23, 0.5);\n    border: 1px solid rgba(78, 205, 196, 0.14);\n    color: rgba(230, 237, 243, 0.65);\n    font-size: 0.7rem;\n    font-weight: 500;\n    text-transform: capitalize;\n    cursor: pointer;\n    transition: all 0.15s ease;\n  }\n\n  .oracle-chip:hover {\n    border-color: var(--oracle-accent, rgba(78, 205, 196, 0.5));\n    color: rgba(230, 237, 243, 0.85);\n  }\n\n  .oracle-chip.selected {\n    background: rgba(78, 205, 196, 0.12);\n    border-color: var(--oracle-accent, rgba(78, 205, 196, 0.5));\n    color: var(--oracle-accent, rgba(78, 205, 196, 0.95));\n  }\n\n  .preset-buttons {\n    display: flex;\n    gap: 0.35rem;\n  }\n\n  .preset-btn {\n    flex: 1;\n    padding: 0.45rem 0.75rem;\n    border-radius: 8px;\n    background: rgba(13, 17, 23, 0.5);\n    border: 1px solid rgba(78, 205, 196, 0.14);\n    color: rgba(230, 237, 243, 0.65);\n    font-size: 0.8rem;\n    font-weight: 500;\n    cursor: pointer;\n    transition: all 0.15s ease;\n  }\n\n  .preset-btn:hover {\n    border-color: rgba(78, 205, 196, 0.35);\n    color: rgba(230, 237, 243, 0.85);\n  }\n\n  .preset-btn.active {\n    background: rgba(78, 205, 196, 0.15);\n    border-color: rgba(78, 205, 196, 0.5);\n    color: rgba(78, 205, 196, 0.95);\n  }\n\n  .advanced-toggle {\n    display: inline-flex;\n    align-items: center;\n    gap: 0.35rem;\n    padding: 0.45rem 0.65rem;\n    margin-top: 0.5rem;\n    border-radius: 8px;\n    background: transparent;\n    border: 1px solid rgba(78, 205, 196, 0.1);\n    color: rgba(230, 237, 243, 0.55);\n    font-size: 0.75rem;\n    font-weight: 500;\n    cursor: pointer;\n    transition: all 0.15s ease;\n    width: fit-content;\n  }\n\n  .advanced-toggle:hover {\n    border-color: rgba(78, 205, 196, 0.22);\n    color: rgba(230, 237, 243, 0.75);\n  }\n\n  .advanced-options {\n    display: flex;\n    flex-direction: column;\n    gap: 0.75rem;\n    padding: 0.75rem;\n    background: rgba(13, 17, 23, 0.3);\n    border-radius: 10px;\n    border: 1px solid rgba(78, 205, 196, 0.08);\n  }\n\n  .checkbox-group {\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n    cursor: pointer;\n  }\n\n  .checkbox-group input[type=\"checkbox\"] {\n    width: 16px;\n    height: 16px;\n    accent-color: var(--tachi-cyan, #4ecdc4);\n    cursor: pointer;\n  }\n\n  .checkbox-label {\n    font-size: 0.8rem;\n    color: rgba(230, 237, 243, 0.75);\n  }\n\n  .summary-bar {\n    display: flex;\n    align-items: center;\n    gap: 0.65rem;\n    margin-top: 1.5rem;\n    padding: 0.65rem 0.85rem;\n    border-radius: 10px;\n    background: rgba(13, 17, 23, 0.35);\n    border: 1px solid rgba(78, 205, 196, 0.14);\n  }\n\n  .summary-item {\n    display: flex;\n    align-items: center;\n    gap: 0.35rem;\n    font-size: 0.8rem;\n    color: rgba(230, 237, 243, 0.75);\n  }\n\n  .summary-divider {\n    color: rgba(78, 205, 196, 0.4);\n  }\n\n  /* Mobile: stack columns vertically */\n  @media (max-width: 768px) {\n    .two-column-layout {\n      grid-template-columns: 1fr;\n      gap: 1.5rem;\n    }\n\n    .summary-bar {\n      flex-wrap: wrap;\n      justify-content: center;\n    }\n\n    .preset-buttons {\n      flex-wrap: wrap;\n    }\n  }\n</style>\n","<script lang=\"ts\">\n  import { marked } from 'marked';\n  import type { SessionDraft, CostEstimate } from '$lib/types/forge';\n  import Icon from '$lib/components/common/Icon.svelte';\n\n  export let draft: SessionDraft;\n  export let costEstimate: CostEstimate;\n  export let errors: Map<string, string[]>;\n\n  $: goalHtml = marked(draft.goal || '');\n  $: hasErrors = errors.size > 0;\n  $: allErrors = Array.from(errors.values()).flat();\n\n  let brokenAvatarIds = new Set<string>();\n\n  function parseAvatar(avatar?: string): { src?: string; emoji?: string } {\n    if (!avatar) return {};\n    if (avatar.startsWith('asset:')) {\n      const raw = avatar.slice('asset:'.length);\n      const [src, emoji] = raw.split('|');\n      return { src, emoji };\n    }\n    if (avatar.startsWith('/') || avatar.startsWith('http')) {\n      return { src: avatar };\n    }\n    return { emoji: avatar };\n  }\n\n  function markAvatarBroken(id: string) {\n    brokenAvatarIds = new Set([...brokenAvatarIds, id]);\n  }\n</script>\n\n<div class=\"session-review\" data-testid=\"session-review\">\n  <div class=\"review-header\">\n    <h2>Review & Start Session</h2>\n    <p class=\"review-description\">\n      Review your session configuration before starting the deliberation. Make sure all details are correct.\n    </p>\n  </div>\n\n  {#if hasErrors}\n    <div class=\"error-summary\" role=\"alert\">\n      <div class=\"error-header\">\n        <Icon name=\"alert-triangle\" size={20} />\n        <h3>Issues Found</h3>\n      </div>\n      <p>Please resolve the following issues before starting your session:</p>\n      <ul class=\"error-list\">\n        {#each allErrors as error}\n          <li>{error}</li>\n        {/each}\n      </ul>\n    </div>\n  {/if}\n\n  <div class=\"review-sections\">\n    <!-- Session Details -->\n    <section class=\"review-section\">\n      <div class=\"section-header\">\n        <div class=\"section-title\">\n          <span class=\"section-icon\">üìã</span>\n          <h3>Session Details</h3>\n        </div>\n      </div>\n      <div class=\"section-content\">\n        <div class=\"detail-row\">\n          <span class=\"detail-label\">Session Name</span>\n          <span class=\"detail-value\">{draft.name || 'Untitled Session'}</span>\n        </div>\n        <div class=\"detail-row goal-row\">\n          <span class=\"detail-label\">Goal</span>\n          <div class=\"goal-preview\">\n            {@html goalHtml}\n          </div>\n        </div>\n      </div>\n    </section>\n\n    <!-- Participants -->\n    <section class=\"review-section\">\n      <div class=\"section-header\">\n        <div class=\"section-title\">\n          <span class=\"section-icon\">üë•</span>\n          <h3>Participants ({draft.participants.length})</h3>\n        </div>\n      </div>\n      <div class=\"section-content\">\n        <div class=\"participant-grid\">\n          {#each draft.participants as participant}\n            {@const avatar = parseAvatar(participant.avatar)}\n            <div class=\"participant-card\" data-testid=\"participant-{participant.id}\">\n              <div class=\"participant-avatar\" class:ai={participant.type === 'ai'}>\n                {#if avatar.src && !brokenAvatarIds.has(participant.id)}\n                  <img\n                    src={avatar.src}\n                    alt=\"\"\n                    on:error={() => markAvatarBroken(participant.id)}\n                  />\n                {:else if avatar.emoji}\n                  <span class=\"avatar-emoji\">{avatar.emoji}</span>\n                {:else}\n                  <span class=\"avatar-letter\">{participant.name.charAt(0).toUpperCase()}</span>\n                {/if}\n              </div>\n              <div class=\"participant-info\">\n                <div class=\"participant-name\">{participant.name}</div>\n                <div class=\"participant-role\">{participant.role}</div>\n                <div class=\"participant-meta\">\n                  <span class=\"type-badge\" class:ai={participant.type === 'ai'}>\n                    {participant.type.toUpperCase()}\n                  </span>\n                  {#if participant.estimatedCostPerRound}\n                    <span class=\"cost-badge\">${participant.estimatedCostPerRound.toFixed(4)}/round</span>\n                  {/if}\n                </div>\n              </div>\n            </div>\n          {/each}\n        </div>\n      </div>\n    </section>\n\n    <!-- Oracle -->\n    <section class=\"review-section\">\n      <div class=\"section-header\">\n        <div class=\"section-title\">\n          <span class=\"section-icon\">üß†</span>\n          <h3>Oracle</h3>\n        </div>\n      </div>\n      <div class=\"section-content\">\n        {#if draft.oracle}\n          <div class=\"oracle-card\">\n            <div class=\"oracle-main\">\n              <div class=\"oracle-name\">{draft.oracle.name}</div>\n              <div class=\"oracle-type\">{draft.oracle.type}</div>\n              {#if draft.oracle.estimatedCostPerRound}\n                <div class=\"oracle-cost\">${draft.oracle.estimatedCostPerRound.toFixed(4)}/round</div>\n              {/if}\n            </div>\n            {#if draft.oracle.config && Object.keys(draft.oracle.config).length > 0}\n              <details class=\"oracle-config\">\n                <summary class=\"config-toggle\">Configuration</summary>\n                <pre class=\"config-code\">{JSON.stringify(draft.oracle.config, null, 2)}</pre>\n              </details>\n            {/if}\n          </div>\n        {:else}\n          <div class=\"empty-state\">No oracle selected</div>\n        {/if}\n      </div>\n    </section>\n\n    <!-- Session Configuration -->\n    <section class=\"review-section\">\n      <div class=\"section-header\">\n        <div class=\"section-title\">\n          <span class=\"section-icon\">‚öôÔ∏è</span>\n          <h3>Session Configuration</h3>\n        </div>\n      </div>\n      <div class=\"section-content\">\n        <div class=\"config-grid\">\n          <div class=\"config-item\">\n            <span class=\"config-label\">Maximum Rounds:</span>\n            <span class=\"config-value\">{draft.config.maxRounds}</span>\n          </div>\n          <div class=\"config-item\">\n            <span class=\"config-label\">Convergence Threshold:</span>\n            <span class=\"config-value\">{(draft.config.convergenceThreshold * 100).toFixed(0)}%</span>\n          </div>\n          <div class=\"config-item\">\n            <span class=\"config-label\">Human Intervention:</span>\n            <span class=\"config-value\">{draft.config.allowHumanIntervention ? 'Allowed' : 'Disabled'}</span>\n          </div>\n          <div class=\"config-item\">\n            <span class=\"config-label\">Auto-save Interval:</span>\n            <span class=\"config-value\">{draft.config.autoSaveInterval / 1000}s</span>\n          </div>\n          <div class=\"config-item\">\n            <span class=\"config-label\">Timeout:</span>\n            <span class=\"config-value\">{draft.config.timeoutMinutes} minutes</span>\n          </div>\n        </div>\n      </div>\n    </section>\n\n    <!-- Cost Estimate -->\n    <section class=\"review-section cost-section\">\n      <div class=\"section-header\">\n        <div class=\"section-title\">\n          <span class=\"section-icon\">üí∞</span>\n          <h3>Cost Estimate</h3>\n        </div>\n      </div>\n      <div class=\"section-content\">\n        <div class=\"cost-breakdown\">\n          <div class=\"cost-row primary\">\n            <span class=\"cost-label\">Estimated Total Cost:</span>\n            <span class=\"cost-amount\">${costEstimate.estimated.toFixed(4)}</span>\n          </div>\n          <div class=\"cost-row\">\n            <span class=\"cost-label\">Cost per Round:</span>\n            <span class=\"cost-amount\">${costEstimate.perRound.toFixed(4)}</span>\n          </div>\n          <div class=\"cost-row\">\n            <span class=\"cost-label\">Maximum Possible Cost:</span>\n            <span class=\"cost-amount\">${costEstimate.maximum.toFixed(4)}</span>\n          </div>\n        </div>\n        <div class=\"cost-note\">\n          <span class=\"note-icon\">üí°</span>\n          <span>Estimated cost assumes ~70% of maximum rounds. Actual cost may vary based on convergence.</span>\n        </div>\n      </div>\n    </section>\n  </div>\n</div>\n\n<style>\n  .session-review {\n    max-width: 900px;\n    margin: 0 auto;\n  }\n\n  .review-header {\n    margin-bottom: 2rem;\n  }\n\n  .review-header h2 {\n    font-size: 1.5rem;\n    font-weight: 600;\n    margin-bottom: 0.75rem;\n    color: var(--text-primary, #e6edf3);\n    letter-spacing: 0.5px;\n  }\n\n  .review-description {\n    color: rgba(230, 237, 243, 0.7);\n    line-height: 1.5;\n    margin: 0;\n  }\n\n  /* Error Summary */\n  .error-summary {\n    background: rgba(255, 107, 107, 0.08);\n    border: 1px solid rgba(255, 107, 107, 0.35);\n    border-radius: 14px;\n    padding: 1.25rem;\n    margin-bottom: 2rem;\n  }\n\n  .error-header {\n    display: flex;\n    align-items: center;\n    gap: 0.6rem;\n    color: rgba(255, 107, 107, 0.95);\n    margin-bottom: 0.75rem;\n  }\n\n  .error-header h3 {\n    margin: 0;\n    font-size: 1rem;\n    font-weight: 600;\n  }\n\n  .error-summary p {\n    color: rgba(230, 237, 243, 0.7);\n    margin: 0 0 1rem 0;\n    font-size: 0.9rem;\n  }\n\n  .error-list {\n    list-style: none;\n    padding: 0;\n    margin: 0;\n    display: flex;\n    flex-direction: column;\n    gap: 0.5rem;\n  }\n\n  .error-list li {\n    padding: 0.6rem 0.9rem;\n    background: rgba(255, 107, 107, 0.1);\n    border-radius: 8px;\n    color: rgba(255, 107, 107, 0.95);\n    font-size: 0.85rem;\n  }\n\n  /* Review Sections */\n  .review-sections {\n    display: flex;\n    flex-direction: column;\n    gap: 1.5rem;\n  }\n\n  .review-section {\n    background: rgba(13, 17, 23, 0.45);\n    border: 1px solid rgba(78, 205, 196, 0.14);\n    border-radius: 16px;\n    overflow: hidden;\n  }\n\n  .section-header {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    padding: 1rem 1.25rem;\n    background: rgba(78, 205, 196, 0.06);\n    border-bottom: 1px solid rgba(78, 205, 196, 0.12);\n  }\n\n  .section-title {\n    display: flex;\n    align-items: center;\n    gap: 0.65rem;\n  }\n\n  .section-icon {\n    font-size: 1.15rem;\n  }\n\n  .section-title h3 {\n    margin: 0;\n    font-size: 1rem;\n    font-weight: 600;\n    color: var(--text-primary, #e6edf3);\n  }\n\n  .section-content {\n    padding: 1.25rem;\n  }\n\n  /* Session Details */\n  .detail-row {\n    display: flex;\n    gap: 1rem;\n    margin-bottom: 1rem;\n  }\n\n  .detail-row:last-child {\n    margin-bottom: 0;\n  }\n\n  .detail-label {\n    font-size: 0.8rem;\n    font-weight: 500;\n    color: rgba(78, 205, 196, 0.9);\n    text-transform: uppercase;\n    letter-spacing: 0.5px;\n    min-width: 100px;\n    flex-shrink: 0;\n  }\n\n  .detail-value {\n    color: var(--text-primary, #e6edf3);\n    font-weight: 500;\n  }\n\n  .goal-row {\n    flex-direction: column;\n  }\n\n  .goal-preview {\n    background: rgba(13, 17, 23, 0.55);\n    border: 1px solid rgba(78, 205, 196, 0.12);\n    border-radius: 10px;\n    padding: 1rem 1.25rem;\n    color: rgba(230, 237, 243, 0.9);\n    font-size: 0.95rem;\n    line-height: 1.65;\n  }\n\n  :global(.goal-preview p) {\n    margin: 0 0 0.75rem 0;\n  }\n\n  :global(.goal-preview p:last-child) {\n    margin-bottom: 0;\n  }\n\n  :global(.goal-preview ul),\n  :global(.goal-preview ol) {\n    margin: 0.75rem 0;\n    padding-left: 1.5rem;\n  }\n\n  :global(.goal-preview code) {\n    background: rgba(78, 205, 196, 0.12);\n    padding: 0.15rem 0.35rem;\n    border-radius: 4px;\n    font-size: 0.85rem;\n    color: var(--tachi-cyan, #4ecdc4);\n  }\n\n  /* Participants */\n  .participant-grid {\n    display: grid;\n    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));\n    gap: 1rem;\n  }\n\n  .participant-card {\n    display: flex;\n    align-items: center;\n    gap: 1rem;\n    padding: 1rem;\n    background: rgba(22, 27, 34, 0.5);\n    border: 1px solid rgba(78, 205, 196, 0.1);\n    border-radius: 12px;\n  }\n\n  .participant-avatar {\n    width: 48px;\n    height: 48px;\n    border-radius: 50%;\n    overflow: hidden;\n    flex-shrink: 0;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    background: linear-gradient(135deg, rgba(63, 185, 80, 0.25), rgba(63, 185, 80, 0.08));\n    border: 2px solid rgba(63, 185, 80, 0.35);\n    color: rgba(63, 185, 80, 0.95);\n    font-size: 1.1rem;\n  }\n\n  .participant-avatar.ai {\n    background: linear-gradient(135deg, rgba(88, 166, 255, 0.25), rgba(88, 166, 255, 0.08));\n    border-color: rgba(88, 166, 255, 0.35);\n    color: rgba(88, 166, 255, 0.95);\n  }\n\n  .participant-avatar img {\n    width: 100%;\n    height: 100%;\n    object-fit: cover;\n  }\n\n  .avatar-emoji {\n    font-size: 1.4rem;\n    line-height: 1;\n  }\n\n  .avatar-letter {\n    font-weight: 700;\n    font-size: 1.1rem;\n  }\n\n  .participant-info {\n    flex: 1;\n    min-width: 0;\n  }\n\n  .participant-name {\n    font-weight: 600;\n    color: var(--text-primary, #e6edf3);\n    margin-bottom: 0.2rem;\n  }\n\n  .participant-role {\n    font-size: 0.85rem;\n    color: rgba(230, 237, 243, 0.6);\n    margin-bottom: 0.5rem;\n  }\n\n  .participant-meta {\n    display: flex;\n    align-items: center;\n    gap: 0.6rem;\n  }\n\n  .type-badge {\n    font-size: 0.65rem;\n    font-weight: 600;\n    letter-spacing: 0.5px;\n    padding: 0.2rem 0.5rem;\n    border-radius: 6px;\n    background: rgba(63, 185, 80, 0.12);\n    color: rgba(63, 185, 80, 0.95);\n  }\n\n  .type-badge.ai {\n    background: rgba(88, 166, 255, 0.12);\n    color: rgba(88, 166, 255, 0.95);\n  }\n\n  .cost-badge {\n    font-size: 0.75rem;\n    color: rgba(230, 237, 243, 0.5);\n    font-family: 'JetBrains Mono', monospace;\n  }\n\n  /* Oracle */\n  .oracle-card {\n    background: rgba(22, 27, 34, 0.5);\n    border: 1px solid rgba(78, 205, 196, 0.12);\n    border-radius: 12px;\n    overflow: hidden;\n  }\n\n  .oracle-main {\n    padding: 1rem 1.25rem;\n  }\n\n  .oracle-name {\n    font-size: 1.1rem;\n    font-weight: 600;\n    color: var(--text-primary, #e6edf3);\n    margin-bottom: 0.25rem;\n  }\n\n  .oracle-type {\n    font-size: 0.85rem;\n    color: var(--tachi-cyan, #4ecdc4);\n    text-transform: uppercase;\n    letter-spacing: 0.5px;\n    margin-bottom: 0.5rem;\n  }\n\n  .oracle-cost {\n    font-size: 0.85rem;\n    color: rgba(230, 237, 243, 0.5);\n    font-family: 'JetBrains Mono', monospace;\n  }\n\n  .oracle-config {\n    border-top: 1px solid rgba(78, 205, 196, 0.1);\n  }\n\n  .config-toggle {\n    display: block;\n    padding: 0.75rem 1.25rem;\n    background: rgba(78, 205, 196, 0.04);\n    cursor: pointer;\n    font-weight: 500;\n    color: rgba(230, 237, 243, 0.8);\n    font-size: 0.85rem;\n  }\n\n  .config-toggle:hover {\n    background: rgba(78, 205, 196, 0.08);\n  }\n\n  .config-code {\n    margin: 0;\n    padding: 1rem 1.25rem;\n    background: rgba(13, 17, 23, 0.5);\n    font-size: 0.8rem;\n    color: rgba(230, 237, 243, 0.7);\n    font-family: 'JetBrains Mono', monospace;\n    overflow-x: auto;\n  }\n\n  .empty-state {\n    text-align: center;\n    padding: 2rem;\n    color: rgba(230, 237, 243, 0.4);\n    font-style: italic;\n  }\n\n  /* Session Configuration */\n  .config-grid {\n    display: flex;\n    flex-wrap: wrap;\n    gap: 0.75rem;\n  }\n\n  .config-item {\n    display: flex;\n    align-items: center;\n    gap: 0.75rem;\n    padding: 0.65rem 1rem;\n    background: rgba(22, 27, 34, 0.5);\n    border: 1px solid rgba(78, 205, 196, 0.1);\n    border-radius: 10px;\n    flex: 1 1 auto;\n    min-width: fit-content;\n  }\n\n  .config-label {\n    font-size: 0.8rem;\n    color: rgba(230, 237, 243, 0.6);\n  }\n\n  .config-value {\n    font-weight: 600;\n    color: var(--text-primary, #e6edf3);\n  }\n\n  /* Cost Section */\n  .cost-section {\n    border-color: rgba(78, 205, 196, 0.25);\n  }\n\n  .cost-section .section-header {\n    background: rgba(78, 205, 196, 0.1);\n  }\n\n  .cost-breakdown {\n    display: flex;\n    flex-direction: column;\n    gap: 0.6rem;\n    margin-bottom: 1rem;\n  }\n\n  .cost-row {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding: 0.75rem 1rem;\n    background: rgba(22, 27, 34, 0.5);\n    border: 1px solid rgba(78, 205, 196, 0.1);\n    border-radius: 10px;\n  }\n\n  .cost-row.primary {\n    background: linear-gradient(135deg, rgba(78, 205, 196, 0.25), rgba(78, 205, 196, 0.12));\n    border-color: rgba(78, 205, 196, 0.35);\n  }\n\n  .cost-label {\n    font-size: 0.85rem;\n    color: rgba(230, 237, 243, 0.7);\n  }\n\n  .cost-row.primary .cost-label {\n    color: rgba(230, 237, 243, 0.9);\n    font-weight: 500;\n  }\n\n  .cost-amount {\n    font-family: 'JetBrains Mono', monospace;\n    font-weight: 600;\n    font-size: 1rem;\n    color: rgba(230, 237, 243, 0.8);\n  }\n\n  .cost-row.primary .cost-amount {\n    font-size: 1.25rem;\n    color: var(--tachi-cyan, #4ecdc4);\n  }\n\n  .cost-note {\n    display: flex;\n    align-items: flex-start;\n    gap: 0.6rem;\n    padding: 0.85rem 1rem;\n    background: rgba(78, 205, 196, 0.06);\n    border: 1px solid rgba(78, 205, 196, 0.12);\n    border-radius: 10px;\n    font-size: 0.85rem;\n    color: rgba(230, 237, 243, 0.65);\n    line-height: 1.4;\n  }\n\n  .note-icon {\n    flex-shrink: 0;\n    font-size: 1rem;\n  }\n\n  /* Responsive */\n  @media (max-width: 768px) {\n    .participant-grid {\n      grid-template-columns: 1fr;\n    }\n\n    .config-grid {\n      flex-direction: column;\n    }\n\n    .config-item {\n      width: 100%;\n      justify-content: space-between;\n    }\n  }\n</style>\n","<script lang=\"ts\">\n  import { createEventDispatcher } from 'svelte';\n  import Icon from '$lib/components/common/Icon.svelte';\n  import type { WizardStep } from '$lib/types/forge';\n\n  export let steps: WizardStep[] = [];\n  export let currentStep: number = 0;\n\n  const dispatch = createEventDispatcher<{\n    stepClick: number;\n  }>();\n\n  function handleStepClick(index: number) {\n    // Only allow clicking on completed or current steps\n    if (index <= currentStep) {\n      dispatch('stepClick', index);\n    }\n  }\n\n  function getStepStatus(index: number): 'completed' | 'current' | 'upcoming' {\n    if (index < currentStep) return 'completed';\n    if (index === currentStep) return 'current';\n    return 'upcoming';\n  }\n\n  function getStepIcon(step: WizardStep, index: number): string {\n    const status = getStepStatus(index);\n    if (status === 'completed') return 'check';\n    return step.icon;\n  }\n</script>\n\n<nav class=\"step-indicator\" aria-label=\"Progress through wizard steps\">\n  <ol class=\"step-list\">\n    {#each steps as step, index}\n      <li class=\"step-item\" class:completed={getStepStatus(index) === 'completed'} \n          class:current={getStepStatus(index) === 'current'}\n          class:upcoming={getStepStatus(index) === 'upcoming'}>\n        <button\n          type=\"button\"\n          class=\"step-button\"\n          disabled={index > currentStep}\n          aria-current={index === currentStep ? 'step' : false}\n          on:click={() => handleStepClick(index)}\n          data-testid=\"step-{index}\"\n        >\n          <span class=\"step-icon\" aria-hidden=\"true\">\n            <Icon\n              name={getStepIcon(step, index)}\n              size={18}\n              glow={getStepStatus(index) !== 'upcoming'}\n            />\n          </span>\n          <span class=\"step-label\">{step.label}</span>\n        </button>\n        {#if index < steps.length - 1}\n          <div class=\"step-connector\" aria-hidden=\"true\"></div>\n        {/if}\n      </li>\n    {/each}\n  </ol>\n</nav>\n\n<style>\n  .step-indicator {\n    width: 100%;\n    margin-bottom: 2rem;\n  }\n\n  .step-list {\n    display: flex;\n    list-style: none;\n    margin: 0;\n    padding: 0;\n    align-items: center;\n  }\n\n  .step-item {\n    display: flex;\n    align-items: center;\n    flex: 1;\n    position: relative;\n  }\n\n  .step-button {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    gap: 0.5rem;\n    padding: 0.75rem 0.9rem;\n    background: transparent;\n    border: 1px solid transparent;\n    cursor: pointer;\n    transition: all 0.2s ease;\n    border-radius: 8px;\n    text-align: center;\n    min-width: 120px;\n  }\n\n  .step-button:disabled {\n    cursor: not-allowed;\n  }\n\n  .step-button:hover:not(:disabled) {\n    background: var(--hover-bg, rgba(78, 205, 196, 0.08));\n    border-color: rgba(78, 205, 196, 0.18);\n  }\n\n  .step-icon {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    width: 2.5rem;\n    height: 2.5rem;\n    border-radius: 50%;\n    font-size: 1.25rem;\n    transition: all 0.2s ease;\n    background: rgba(13, 17, 23, 0.55);\n    border: 1px solid rgba(78, 205, 196, 0.15);\n    color: var(--tachi-cyan, #4ecdc4);\n  }\n\n  .step-label {\n    font-size: 0.875rem;\n    font-weight: 500;\n    transition: color 0.2s ease;\n    color: var(--text-secondary, rgba(230, 237, 243, 0.7));\n  }\n\n  .step-connector {\n    flex: 1;\n    height: 2px;\n    margin: 0 0.5rem;\n    transition: background-color 0.2s ease;\n    background: rgba(78, 205, 196, 0.12);\n  }\n\n  /* Completed state */\n  .step-item.completed .step-icon {\n    background: rgba(63, 185, 80, 0.12);\n    border-color: rgba(63, 185, 80, 0.5);\n    color: var(--success-color, #3fb950);\n    box-shadow: 0 0 0 3px rgba(63, 185, 80, 0.12);\n  }\n\n  .step-item.completed .step-label {\n    color: var(--success-color, #3fb950);\n  }\n\n  .step-item.completed .step-connector {\n    background: rgba(63, 185, 80, 0.6);\n  }\n\n  /* Current state */\n  .step-item.current .step-icon {\n    background: rgba(78, 205, 196, 0.14);\n    border-color: rgba(78, 205, 196, 0.65);\n    color: var(--tachi-cyan, #4ecdc4);\n    box-shadow: 0 0 0 3px rgba(78, 205, 196, 0.16);\n  }\n\n  .step-item.current .step-label {\n    color: var(--tachi-cyan, #4ecdc4);\n    font-weight: 600;\n  }\n\n  .step-item.current .step-connector {\n    background: rgba(78, 205, 196, 0.18);\n  }\n\n  /* Upcoming state */\n  .step-item.upcoming .step-icon {\n    background: rgba(13, 17, 23, 0.35);\n    color: var(--text-muted, rgba(230, 237, 243, 0.35));\n    border: 1px solid rgba(78, 205, 196, 0.1);\n    opacity: 0.6;\n  }\n\n  .step-item.upcoming .step-label {\n    color: var(--text-muted, rgba(230, 237, 243, 0.45));\n  }\n\n  .step-item.upcoming .step-connector {\n    background: rgba(78, 205, 196, 0.08);\n  }\n\n  /* Remove connector from last item */\n  .step-item:last-child .step-connector {\n    display: none;\n  }\n\n  /* Responsive design */\n  @media (max-width: 768px) {\n    .step-button {\n      min-width: 80px;\n      padding: 0.75rem 0.5rem;\n    }\n\n    .step-icon {\n      width: 2rem;\n      height: 2rem;\n      font-size: 1rem;\n    }\n\n    .step-label {\n      font-size: 0.75rem;\n    }\n  }\n</style>","import type { SessionDraft, ValidationResult } from '$lib/types/forge';\n\nexport async function validateSessionConfig(\n  draft: SessionDraft,\n  stepId?: string\n): Promise<ValidationResult> {\n  const errors: string[] = [];\n  const warnings: string[] = [];\n\n  if (!stepId || stepId === 'goal') {\n    if (!draft.name || draft.name.trim().length < 3) {\n      errors.push('Session name must be at least 3 characters');\n    }\n    if (!draft.goal || draft.goal.trim().length < 10) {\n      errors.push('Goal description must be at least 10 characters');\n    }\n    if (draft.goal && draft.goal.length > 5000) {\n      errors.push('Goal description exceeds maximum length of 5000 characters');\n    }\n  }\n\n  if (!stepId || stepId === 'participants') {\n    if (draft.participants.length < 2) {\n      errors.push('At least 2 participants are required');\n    }\n    if (draft.participants.length > 10) {\n      warnings.push('Having more than 10 participants may increase costs significantly');\n    }\n\n    const uniqueIds = new Set(draft.participants.map(p => p.id));\n    if (uniqueIds.size !== draft.participants.length) {\n      errors.push('Duplicate participants are not allowed');\n    }\n  }\n\n  // Handle both legacy step IDs and new combined oracle-config step\n  if (!stepId || stepId === 'oracle' || stepId === 'oracle-config') {\n    if (!draft.oracle) {\n      errors.push('An oracle must be selected');\n    }\n\n    if (draft.oracle && draft.participants.some(p => p.id === draft.oracle?.id)) {\n      warnings.push('Oracle is also a participant - this may affect deliberation dynamics');\n    }\n  }\n\n  if (!stepId || stepId === 'config' || stepId === 'oracle-config') {\n    if (draft.config.maxRounds < 1 || draft.config.maxRounds > 20) {\n      errors.push('Maximum rounds must be between 1 and 20');\n    }\n    if (draft.config.convergenceThreshold < 0.5 || draft.config.convergenceThreshold > 1) {\n      errors.push('Convergence threshold must be between 0.5 and 1.0');\n    }\n    if (draft.config.timeoutMinutes < 5 || draft.config.timeoutMinutes > 480) {\n      errors.push('Timeout must be between 5 minutes and 8 hours');\n    }\n  }\n\n  return {\n    valid: errors.length === 0,\n    errors,\n    warnings\n  };\n}","<script lang=\"ts\">\n  import { createEventDispatcher } from 'svelte';\n  import { writable, derived, get } from 'svelte/store';\n  import Icon from '$lib/components/common/Icon.svelte';\n  import GoalInput from './GoalInput.svelte';\n  import ParticipantSelect from './ParticipantSelect.svelte';\n  import OracleConfigPanel from './OracleConfigPanel.svelte';\n  import SessionReview from './SessionReview.svelte';\n  import StepIndicator from '$lib/components/ui/StepIndicator.svelte';\n  import { forgeSessionStore } from '$lib/stores/forgeSession';\n  import { sessionLoading, sessionError } from '$lib/stores/forgeSession';\n  import Spinner from '$lib/components/ui/Spinner/Spinner.svelte';\n  import GlassPanel from '$lib/components/ui/GlassPanel.svelte';\n  import { validateSessionConfig } from '$lib/utils/sessionValidation';\n  import type {\n    SessionDraft,\n    SessionTemplate,\n    WizardStep\n  } from '$lib/types/forge';\n\n  export let template: SessionTemplate | null = null;\n  export let editSessionId: string | null = null;\n\n  const dispatch = createEventDispatcher<{\n    created: { sessionId: string };\n    cancelled: void;\n    saved: { draftId: string };\n  }>();\n\n  const steps: WizardStep[] = [\n    { id: 'goal', label: 'Define Goal', icon: 'target' },\n    { id: 'participants', label: 'Select Participants', icon: 'users' },\n    { id: 'oracle-config', label: 'Oracle & Config', icon: 'sliders' },\n    { id: 'review', label: 'Review & Start', icon: 'check' }\n  ];\n\n  let currentStep = writable<number>(0);\n  let sessionDraft = writable<SessionDraft>(initializeDraft(template, editSessionId));\n  let validationErrors = writable<Map<string, string[]>>(new Map());\n  let isSubmitting = writable<boolean>(false);\n  let isEditMode = editSessionId !== null;\n\n  function initializeDraft(tmpl: SessionTemplate | null, sessionIdToEdit: string | null): SessionDraft {\n    // Edit mode: load from existing session\n    if (sessionIdToEdit) {\n      const state = get(forgeSessionStore);\n      const existingSession = state.sessions.find(s => s.id === sessionIdToEdit);\n      if (existingSession) {\n        return {\n          name: existingSession.name,\n          goal: existingSession.goal,\n          participants: [...existingSession.participants],\n          oracle: existingSession.oracle,\n          config: existingSession.config || {\n            maxRounds: 5,\n            convergenceThreshold: 0.8,\n            allowHumanIntervention: true,\n            autoSaveInterval: 30000,\n            timeoutMinutes: 60\n          },\n          metadata: {\n            createdAt: existingSession.createdAt,\n            lastModified: new Date()\n          }\n        };\n      }\n    }\n\n    // Template mode\n    if (tmpl) {\n      return {\n        name: `${tmpl.name} - ${new Date().toLocaleDateString()}`,\n        goal: tmpl.defaultGoal || '',\n        participants: [...tmpl.defaultParticipants],\n        oracle: tmpl.defaultOracle,\n        config: { ...tmpl.defaultConfig },\n        metadata: {\n          templateId: tmpl.id,\n          createdAt: new Date(),\n          lastModified: new Date()\n        }\n      };\n    }\n\n    // New session\n    return {\n      name: '',\n      goal: '',\n      participants: [],\n      oracle: null,\n      config: {\n        maxRounds: 5,\n        convergenceThreshold: 0.8,\n        allowHumanIntervention: true,\n        autoSaveInterval: 30000,\n        timeoutMinutes: 60\n      },\n      metadata: {\n        createdAt: new Date(),\n        lastModified: new Date()\n      }\n    };\n  }\n\n  const canProceed = derived(\n    [currentStep, sessionDraft, validationErrors],\n    ([$step, $draft, $errors]) => {\n      const stepId = steps[$step].id;\n      const stepErrors = $errors.get(stepId) || [];\n\n      switch (stepId) {\n        case 'goal':\n          return $draft.goal.trim().length >= 10 && stepErrors.length === 0;\n        case 'participants':\n          return $draft.participants.length >= 2 && stepErrors.length === 0;\n        case 'oracle-config':\n          return $draft.oracle !== null && stepErrors.length === 0;\n        case 'review':\n          return $errors.size === 0;\n        default:\n          return false;\n      }\n    }\n  );\n\n  const costEstimate = derived(sessionDraft, ($draft) => {\n    const participantCost = $draft.participants.reduce((sum, p) => {\n      return sum + (p.estimatedCostPerRound || 0);\n    }, 0);\n    const oracleCost = $draft.oracle?.estimatedCostPerRound || 0;\n    const roundCost = participantCost + oracleCost;\n    const maxCost = roundCost * ($draft.config.maxRounds || 5);\n\n    return {\n      perRound: roundCost,\n      estimated: maxCost * 0.7, // Assume average 70% of max rounds\n      maximum: maxCost\n    };\n  });\n\n  async function validateStep(stepIndex: number): Promise<boolean> {\n    const stepId = steps[stepIndex].id;\n    const result = await validateSessionConfig($sessionDraft, stepId);\n\n    validationErrors.update(errors => {\n      if (result.errors.length > 0) {\n        errors.set(stepId, result.errors);\n      } else {\n        errors.delete(stepId);\n      }\n      return errors;\n    });\n\n    return result.valid;\n  }\n\n  async function nextStep() {\n    const isValid = await validateStep($currentStep);\n    if (isValid && $currentStep < steps.length - 1) {\n      currentStep.update(n => n + 1);\n    }\n  }\n\n  function prevStep() {\n    if ($currentStep > 0) {\n      currentStep.update(n => n - 1);\n    }\n  }\n\n  function goToStep(index: number) {\n    if (index <= $currentStep) {\n      currentStep.set(index);\n    }\n  }\n\n  async function saveDraft() {\n    try {\n      const draftId = await forgeSessionStore.saveDraft($sessionDraft);\n      dispatch('saved', { draftId });\n    } catch (error) {\n      console.error('Failed to save draft:', error);\n    }\n  }\n\n  async function createSession() {\n    isSubmitting.set(true);\n\n    try {\n      // Validate all steps\n      for (let i = 0; i < steps.length; i++) {\n        const isValid = await validateStep(i);\n        if (!isValid) {\n          currentStep.set(i);\n          isSubmitting.set(false);\n          return;\n        }\n      }\n\n      let sessionId: string;\n      if (isEditMode && editSessionId) {\n        // Update existing session\n        sessionId = await forgeSessionStore.updateSession(editSessionId, $sessionDraft);\n      } else {\n        // Create new session\n        sessionId = await forgeSessionStore.createSession($sessionDraft);\n      }\n      dispatch('created', { sessionId });\n    } catch (error) {\n      console.error('Failed to save session:', error);\n      validationErrors.update(errors => {\n        errors.set('submit', [(error as Error).message]);\n        return errors;\n      });\n    } finally {\n      isSubmitting.set(false);\n    }\n  }\n\n  function handleCancel() {\n    dispatch('cancelled');\n  }\n\n  function updateDraft(field: keyof SessionDraft, value: unknown) {\n    sessionDraft.update(draft => ({\n      ...draft,\n      [field]: value,\n      metadata: { ...draft.metadata, lastModified: new Date() }\n    }));\n  }\n\n  $: submitErrors = $validationErrors.get('submit') || [];\n</script>\n\n<GlassPanel\n  as=\"section\"\n  className=\"session-wizard\"\n  accent=\"cyan\"\n  subtle\n  data-testid=\"session-creation-wizard\"\n  aria-busy={$isSubmitting || $sessionLoading}\n>\n  <header class=\"wizard-header\">\n    <div class=\"wizard-title\">\n      <div class=\"title-left\">\n        <div class=\"title-icon\">\n          <Icon name=\"brain\" size={20} glow />\n        </div>\n        <div class=\"title-text\">\n          <div class=\"title-tag\">SPEC FORGE // ÂÖ¨ÂÆâ9Ë™≤</div>\n          <h1>{isEditMode ? 'Edit Session' : 'Create Forge Session'}</h1>\n        </div>\n      </div>\n      <div class=\"title-right\">\n        {#if $sessionLoading}\n          <div class=\"title-loading\" aria-label=\"Working\">\n            <Spinner size={16} color=\"var(--tachi-cyan, #4ecdc4)\" />\n            <span>Working‚Ä¶</span>\n          </div>\n        {/if}\n      </div>\n    </div>\n    <StepIndicator\n      {steps}\n      currentStep={$currentStep}\n      on:stepClick={(e) => goToStep(e.detail)}\n    />\n  </header>\n\n  {#if submitErrors.length > 0 || $sessionError}\n    <div class=\"submit-banner\" role=\"alert\" aria-live=\"polite\">\n      <Icon name=\"alert-triangle\" size={18} />\n      <div class=\"submit-text\">\n        <div class=\"submit-title\">Session creation failed</div>\n        <div class=\"submit-subtitle\">{submitErrors[0] ?? $sessionError}</div>\n      </div>\n      <button type=\"button\" class=\"btn btn-secondary\" on:click={() => forgeSessionStore.clearError()}>\n        Dismiss\n      </button>\n    </div>\n  {/if}\n\n  <div class=\"wizard-content\">\n    {#if $currentStep === 0}\n      <GoalInput\n        value={$sessionDraft.goal}\n        name={$sessionDraft.name}\n        errors={$validationErrors.get('goal') || []}\n        on:goalChange={(e) => updateDraft('goal', e.detail)}\n        on:nameChange={(e) => updateDraft('name', e.detail)}\n      />\n    {:else if $currentStep === 1}\n      <ParticipantSelect\n        selected={$sessionDraft.participants}\n        errors={$validationErrors.get('participants') || []}\n        on:change={(e) => updateDraft('participants', e.detail)}\n      />\n    {:else if $currentStep === 2}\n      <OracleConfigPanel\n        selectedOracle={$sessionDraft.oracle}\n        participants={$sessionDraft.participants}\n        config={$sessionDraft.config}\n        errors={$validationErrors.get('oracle-config') || []}\n        on:oracleChange={(e) => updateDraft('oracle', e.detail)}\n        on:configChange={(e) => updateDraft('config', e.detail)}\n      />\n    {:else if $currentStep === 3}\n      <SessionReview\n        draft={$sessionDraft}\n        costEstimate={$costEstimate}\n        errors={$validationErrors}\n      />\n    {/if}\n  </div>\n\n  <footer class=\"wizard-footer\">\n    <div class=\"footer-left\">\n      <button\n        type=\"button\"\n        class=\"btn btn-ghost\"\n        on:click={handleCancel}\n      >\n        Cancel\n      </button>\n      <button\n        type=\"button\"\n        class=\"btn btn-secondary\"\n        on:click={saveDraft}\n      >\n        Save Draft\n      </button>\n    </div>\n\n    <div class=\"cost-estimate\" aria-live=\"polite\">\n      <span class=\"cost-label\">Estimated Cost:</span>\n      <span class=\"cost-value\">${$costEstimate.estimated.toFixed(4)}</span>\n      <span class=\"cost-max\">(max: ${$costEstimate.maximum.toFixed(4)})</span>\n    </div>\n\n    <div class=\"footer-right\">\n      {#if $currentStep > 0}\n        <button\n          type=\"button\"\n          class=\"btn btn-secondary\"\n          on:click={prevStep}\n        >\n          Previous\n        </button>\n      {/if}\n\n      {#if $currentStep < steps.length - 1}\n        <button\n          type=\"button\"\n          class=\"btn btn-primary\"\n          disabled={!$canProceed}\n          on:click={nextStep}\n        >\n          Next\n        </button>\n      {:else}\n        <button\n          type=\"button\"\n          class=\"btn btn-success\"\n          disabled={!$canProceed || $isSubmitting}\n          on:click={createSession}\n        >\n          {#if $isSubmitting}\n            {isEditMode ? 'Saving...' : 'Creating...'}\n          {:else}\n            {isEditMode ? 'Save Changes' : 'Start Session'}\n          {/if}\n        </button>\n      {/if}\n    </div>\n  </footer>\n</GlassPanel>\n\n<style>\n  .session-wizard {\n    display: flex;\n    flex-direction: column;\n    height: 100%;\n    max-width: 1200px;\n    margin: 0 auto;\n    padding: 2rem 2.5rem;\n  }\n\n  .wizard-header {\n    margin-bottom: 2rem;\n  }\n\n  .wizard-title {\n    display: flex;\n    align-items: flex-start;\n    justify-content: space-between;\n    gap: 1rem;\n    margin-bottom: 1.25rem;\n  }\n\n  .title-left {\n    display: flex;\n    align-items: flex-start;\n    gap: 0.9rem;\n  }\n\n  .title-icon {\n    width: 44px;\n    height: 44px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    border-radius: 12px;\n    background: linear-gradient(135deg, rgba(78, 205, 196, 0.18), rgba(78, 205, 196, 0.05));\n    border: 1px solid rgba(78, 205, 196, 0.28);\n    color: var(--tachi-cyan, #4ecdc4);\n    flex-shrink: 0;\n  }\n\n  .title-text {\n    display: flex;\n    flex-direction: column;\n    gap: 0.25rem;\n  }\n\n  .title-tag {\n    font-family: var(--font-display, 'Orbitron', sans-serif);\n    font-size: 0.65rem;\n    letter-spacing: 2.5px;\n    text-transform: uppercase;\n    color: rgba(78, 205, 196, 0.9);\n  }\n\n  .wizard-header h1 {\n    font-size: 1.6rem;\n    font-weight: 700;\n    margin: 0;\n    color: var(--text-primary, #e6edf3);\n    letter-spacing: 1.25px;\n    text-transform: uppercase;\n    text-shadow: 0 0 18px rgba(78, 205, 196, 0.25);\n  }\n\n  .title-loading {\n    display: inline-flex;\n    align-items: center;\n    gap: 0.5rem;\n    padding: 0.45rem 0.65rem;\n    border-radius: 999px;\n    background: rgba(13, 17, 23, 0.35);\n    border: 1px solid rgba(78, 205, 196, 0.14);\n    color: rgba(230, 237, 243, 0.65);\n    font-size: 0.85rem;\n  }\n\n  .wizard-content {\n    flex: 1;\n    overflow-y: auto;\n    padding: 1rem 0;\n  }\n\n  .submit-banner {\n    display: flex;\n    align-items: center;\n    gap: 0.75rem;\n    padding: 0.75rem 0.9rem;\n    border-radius: 12px;\n    background: rgba(255, 107, 107, 0.08);\n    border: 1px solid rgba(255, 107, 107, 0.25);\n    color: rgba(230, 237, 243, 0.85);\n    margin: 0 0 1rem;\n  }\n\n  .submit-text {\n    flex: 1;\n    display: flex;\n    flex-direction: column;\n    gap: 0.2rem;\n    min-width: 0;\n  }\n\n  .submit-title {\n    font-family: var(--font-display, 'Orbitron', sans-serif);\n    letter-spacing: 1px;\n    text-transform: uppercase;\n    font-size: 0.75rem;\n    color: rgba(230, 237, 243, 0.9);\n  }\n\n  .submit-subtitle {\n    font-size: 0.9rem;\n    color: rgba(230, 237, 243, 0.65);\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n  }\n\n  .wizard-footer {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding-top: 1.5rem;\n    border-top: 1px solid rgba(78, 205, 196, 0.14);\n    margin-top: 1.5rem;\n  }\n\n  .footer-left,\n  .footer-right {\n    display: flex;\n    gap: 0.75rem;\n  }\n\n  .cost-estimate {\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n    font-size: 0.875rem;\n  }\n\n  .cost-label {\n    color: var(--text-secondary);\n  }\n\n  .cost-value {\n    font-weight: 600;\n    color: var(--text-primary);\n  }\n\n  .cost-max {\n    color: var(--text-muted);\n    font-size: 0.75rem;\n  }\n\n  .btn {\n    padding: 0.625rem 1.25rem;\n    border-radius: 10px;\n    font-weight: 500;\n    cursor: pointer;\n    transition: all 0.15s ease;\n  }\n\n  .btn:disabled {\n    opacity: 0.5;\n    cursor: not-allowed;\n  }\n\n  .btn-primary {\n    background: linear-gradient(135deg, var(--tachi-cyan-dark, #2d7a7a), var(--tachi-cyan, #4ecdc4));\n    color: var(--bg-primary, #0d1117);\n    border: 1px solid rgba(78, 205, 196, 0.5);\n  }\n\n  .btn-primary:hover:not(:disabled) {\n    background: linear-gradient(135deg, var(--tachi-cyan, #4ecdc4), var(--tachi-cyan-bright, #6ee7df));\n  }\n\n  .btn-secondary {\n    background: rgba(13, 17, 23, 0.25);\n    color: rgba(230, 237, 243, 0.85);\n    border: 1px solid rgba(78, 205, 196, 0.16);\n  }\n\n  .btn-success {\n    background: rgba(63, 185, 80, 0.2);\n    color: var(--success-color, #3fb950);\n    border: 1px solid rgba(63, 185, 80, 0.4);\n  }\n\n  .btn-ghost {\n    background: transparent;\n    color: var(--text-secondary);\n    border: none;\n  }\n\n  .btn-ghost:hover {\n    color: var(--text-primary);\n  }\n</style>"],"names":["browser","BROWSER","attr_dev","path","path_d_value","ctx","insert_hydration_dev","target","anchor","dirty","if_block","create_if_block","svg","name","$$props","size","color","glow","icons","$$invalidate","iconData","append_hydration_dev","circle0","circle1","svelte_element_class_value","svelte_element","svelte_element_data","get_spread_update","svelte_element_levels","current","svelte_element_style_value","create_dynamic_element","as","padded","subtle","accent","className","accents","accentColor","time_datetime_value","time","time_data","formatRelativeTime","date","diff","seconds","minutes","hours","days","updateInterval","relativeTime","updateTime","dateObj","onMount","interval","createPersistedStore","initialValue","options","key","storage","serialize","deserialize","validate","migrate","version","storageKey","versionKey","getStoredValue","storageApi","storedValue","storedVersion","parsed","store","writable","value","event","newValue","IpcError","message","channel","originalError","handleIpcError","error","isIpcAvailable","TachikomaIpc","__publicField","request","api","callback","ipc","initialState","createForgeService","state","messages","s","setupEventListeners","msgs","existingIndex","m","updated","_event","toSessionRequest","session","p","getModelId","defaultAvatarForParticipant","id","icon","filename","emoji","participant","modelMap","fromSessionResponse","response","sessionData","get","mockSession","sessionId","phase","result","content","participantId","messageId","humanMessage","mockMessage","mockContent","generateMockOutput","getExtension","format","forgeService","createForgeSessionStore","toStoredSession","fromStoredSession","stored","raw","subscribe","set","update","backendSessions","mockSessions","sessions","activeSession","modelId","patchSession","draft","newSession","forgeSessionStore","derived","$store","sessionLoading","sessionError","div","span","button","get_key","i","ul","p0","p1","t0_value","t2_value","t4_value","button_aria_current_value","toggle_class","li","div2","div0","span0","span1","div1","div3","span2","set_data_dev","t0","t2","t4","relativetime_changes","t7","t7_value","create_if_block_2","create_if_block_1","img","h2","handleSelect","click_handler","sortedSessions","$sessions","a","b","parseAvatar","child_ctx","t_value","t","src_url_equal","img_src_value","img_alt_value","label","select","option","t6_value","create_if_block_4","div6","div6_data_testid_value","div5","div4","t6","h4","h3","avatar","src","modelOptions","brokenAvatarIds","markAvatarBroken","setParticipantModel","e","participants","canEditModels","createDeliberationStore","runToken","forgeState","forgeMessages","converted","fm","active","mockResponses","isCancelled","token","planPhases","startPhase","messageTypeForPhase","latestCompleteOfType","type","startDeliberation","aiParticipants","phases","phaseIdx","phaseResponses","thinkingMsg","delay","lastProposal","lastCritique","streamResponse","fullResponse","_participant","finalType","words","stopDeliberation","clearMessages","ms","resolve","deliberationStore","constants_0","create_if_block_15","create_if_block_14","create_if_block_13","section0","section1","raw_value","html_tag","create_if_block_7","small","t1_value","create_if_block_12","create_if_block_8","div5_data_participant_type_value","t1","t3","t3_value","add_render_callback","option_value_value","create_if_block_21","create_if_block_20","create_if_block_17","button0","button1","button2","button2_disabled_value","button3","button3_disabled_value","div13","div12","div7","div11","div9","div8","span3","div10","textarea","messagesContainer","prompt","selectedHumanId","isSending","artifactLoading","artifactError","artifactMarkdown","latestDraft","viewMode","deliberationState","messagesStore","handleStartDeliberation","aiCount","handleStop","handleSendPrompt","getLatestDraft","refreshArtifacts","out","renderMarkdown","marked","getParticipantAvatar","byId","byName","click_handler_1","$$value","select_value","isRunning","$deliberationState","activeParticipantId","useMockMode","$messagesStore","humans","h1","h30","h31","p2","h32","p3","t5_value","t11_value","t17_value","if_block0","create_if_block_11","create_if_block_6","create_if_block_3","if_block6","if_block7","span0_data_color_value","div16","header","span4","div15","span5","span6","div14","span7","section2","section3","t5","t11","t17","formatDate","each_value","ensure_array_like_dev","create_if_block_5","dl","dt0","dd0","dt1","dd1","dt2","dd2","dt3","dd3","t16","t16_value","section","getPhaseConfig","configs","dispatch","createEventDispatcher","handleEditSession","$forgeSessionStore","goalHtml","participantCount","humanCount","phaseConfig","span_class_value","each_blocks","formatTimestamp","getContributionTypeColor","getCritiqueColor","each_value_3","each_value_2","get_key_1","pre","code","if_block2","downloadFile","mimeType","blob","url","getMimeType","severity","visible","isExporting","exportError","previewContent","previewFormat","outputFormats","handleExport","handlePreview","closePreview","hasResults","completedRounds","r","totalContributions","sum","round","totalCritiques","button0_aria_pressed_value","button1_aria_pressed_value","button2_aria_pressed_value","nav","svg0","path0","svg1","path1","svg2","path2","handleKeydown","layoutConfig","togglePanel","panel","requestNewSession","click_handler_2","t8_value","t8","if_block1","if_block3","filtered","$msgs","defaultPreferences","createLayoutPreferencesStore","layoutType","config","prefs","unsubscribe","layoutPreferencesStore","set_style","aside","aside_data_visible_value","dispose","listen_dev","participantpanel_changes","logpanel_changes","resultpanel_changes","main","maincontentarea_changes","defaultConfig","isResizing","containerRef","didAutoOpenRunPanels","panelStates","$config","$session","handleResizeStart","handleResizeMove","handleResizeEnd","resizingPanel","$isResizing","containerRect","newWidth","newHeight","saveLayoutPreferences","$layoutConfig","savedPrefs","onDestroy","togglePanel_handler","newSession_handler","editSession_handler","$panelStates","c","topicPatterns","analyzePromptForQuestions","initialGoal","text","gaps","usedQuestions","detectedTopics","pattern","topic","questions","q","synthesizeRefinedGoal","context","exchanges","markdown","question","answer","shortQ","createGoalRefinementStore","conversationContext","startRefinement","askQuestion","addAssistantMessage","addPendingMessage","streamMessage","submitAnswer","currentState","currentGap","updatedState","nextGapIndex","nextQuestion","synthesizeAndPresent","refinedGoal","msg","fullContent","getRefinedGoalMarkdown","stopRefinement","reset","goalRefinementStore","input","input_disabled_value","button1_disabled_value","currentGoal","inputValue","inputElement","refinementState","unsubMessages","scrollToBottom","unsubState","handleSubmit","handleClose","handleApplySuggestions","hasRefinedGoal","filledCount","g","totalGaps","t13_value","label0","label1","li0","strong0","li1","strong1","li2","strong2","li3","strong3","t13","errors","showPreview","showRefinement","previewHtml","handleGoalInput","updatePreview","handleNameInput","togglePreview","toggleRefinement","handleRefinementClose","newGoal","select_aria_label_value","create_if_block_9","button_aria_label_value","div5_data_testid_value","show_if","button_data_testid_value","selected","availableParticipants","searchQuery","filterType","toggleParticipant","newSelected","selectedIds","removeParticipant","clearSearch","click_handler_3","click_handler_4","filteredParticipants","matchesSearch","matchesFilter","totalCost","getOracleIcon","getOracleAccent","input_checked_value","select_option","select_value_value","div1_transition","create_bidirectional_transition","slide","t10_value","t15_value","t10","t15","select0","select1","label2","label3","select2","each_blocks_3","select1_value_value","select2_value_value","selectedOracle","showAdvanced","availableOracles","oracleTemperature","convergencePresets","maxRoundsOptions","timeoutOptions","autoSaveOptions","handleOracleSelect","oracle","handleTemperatureChange","updatedOracle","updateConfig","field","updatedConfig","getCompatibilityScore","humanParticipants","sortedOracles","o","preset","temperatureLabel","details","summary","t47_value","t62_value","t67_value","t72_value","div32","div31","h33","div22","div21","span8","div17","span9","span10","div18","span11","span12","div19","span13","span14","div20","span15","span16","section4","div24","div23","span17","h34","div30","div28","div25","span18","span19","div26","span20","span21","div27","span22","span23","div29","span24","span25","t19","t19_value","t34","t34_value","t38","t38_value","t43","t43_value","t47","t52","t52_value","t62","t67","t72","costEstimate","hasErrors","allErrors","button_disabled_value","ol","steps","currentStep","handleStepClick","index","getStepStatus","getStepIcon","step","validateSessionConfig","stepId","warnings","oracleconfigpanel_changes","participantselect_changes","goalinput_changes","footer","glasspanel_changes","template","editSessionId","sessionDraft","initializeDraft","validationErrors","isSubmitting","isEditMode","tmpl","sessionIdToEdit","existingSession","canProceed","$step","$draft","$errors","stepErrors","participantCost","oracleCost","roundCost","maxCost","validateStep","stepIndex","$sessionDraft","nextStep","$currentStep","n","prevStep","goToStep","saveDraft","draftId","createSession","handleCancel","updateDraft","stepClick_handler","goalChange_handler","nameChange_handler","change_handler","oracleChange_handler","configChange_handler","submitErrors","$validationErrors"],"mappings":"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","x_google_ignoreList":[0]}