import{b as g,c as v,a as u,e as h}from"../../chunks/ssr.js";import{d as f,w as b}from"../../chunks/index.js";import{e as C}from"../../chunks/escape.js";class E extends Error{constructor(t,e,n){super(t),this.channel=e,this.originalError=n,this.name="IpcError"}}function w(s,t){const e=t instanceof Error?t.message:String(t);return console.error(`IPC Error on channel '${s}':`,t),new E(`IPC call failed: ${e}`,s,t)}function d(){return typeof window<"u"&&!!window.tachikoma}class j{listeners=new Map;async invoke(t,e){if(!d())throw new Error("Tachikoma IPC not available");try{return window.tachikoma.invoke(t,e)}catch(n){throw w(t,n)}}on(t,e){return d()?(this.listeners.has(t)||this.listeners.set(t,new Set),this.listeners.get(t).add(e),window.tachikoma.on(t,e),()=>{this.listeners.get(t)?.delete(e),window.tachikoma.off(t,e)}):()=>{}}}const c=new j;function I(){const{subscribe:s,set:t,update:e}=b({current:null,logs:[],loading:!1,error:null});return{subscribe:s,async start(n,r,o){e(A=>({...A,loading:!0,error:null}));try{const{missionId:A}=await c.invoke("mission:start",{specPath:n,backend:r,mode:o}),i=await c.invoke("mission:status",{missionId:A});return e(l=>({...l,current:i,loading:!1})),A}catch(A){throw e(i=>({...i,loading:!1,error:String(A)})),A}},async stop(){const n=g({subscribe:s});n.current&&(await c.invoke("mission:stop",{missionId:n.current.id}),e(r=>({...r,current:null})))},addLog(n,r){e(o=>({...o,logs:[...o.logs.slice(-99),{level:n,message:r,timestamp:new Date}]}))},clear(){t({current:null,logs:[],loading:!1,error:null})}}}const p=I(),B=f(p,s=>s.current?.state==="running"),k=f(p,s=>s.current?.progress??0),M={code:"main.svelte-1cj8r9l.svelte-1cj8r9l{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:100vh;font-family:system-ui, -apple-system, sans-serif;padding:2rem}h1.svelte-1cj8r9l.svelte-1cj8r9l{font-size:3rem;margin-bottom:0.5rem}.platform.svelte-1cj8r9l.svelte-1cj8r9l{color:var(--text-muted, #666);font-size:0.875rem;margin-bottom:2rem}.test-section.svelte-1cj8r9l.svelte-1cj8r9l{width:100%;max-width:600px}.test-button.svelte-1cj8r9l.svelte-1cj8r9l{background:#3b82f6;color:white;border:none;padding:0.75rem 1.5rem;border-radius:0.5rem;cursor:pointer;font-size:1rem;margin-bottom:1rem}.test-button.svelte-1cj8r9l.svelte-1cj8r9l:hover{background:#2563eb}.test-results.svelte-1cj8r9l.svelte-1cj8r9l{background:#f3f4f6;padding:1rem;border-radius:0.5rem;margin-bottom:1rem}.test-results.svelte-1cj8r9l h2.svelte-1cj8r9l{font-size:1.25rem;margin-bottom:0.5rem}.test-result.svelte-1cj8r9l.svelte-1cj8r9l{font-family:'Monaco', 'Courier New', monospace;font-size:0.875rem;margin-bottom:0.25rem}.mission-status.svelte-1cj8r9l.svelte-1cj8r9l{background:#f9fafb;padding:1rem;border-radius:0.5rem}.mission-status.svelte-1cj8r9l h2.svelte-1cj8r9l{font-size:1.25rem;margin-bottom:0.5rem}",map:'{"version":3,"file":"+page.svelte","sources":["+page.svelte"],"sourcesContent":["<script lang=\\"ts\\">import { onMount } from \\"svelte\\";\\nimport { missionStore, isRunning, progress } from \\"$lib/stores/mission\\";\\nimport { ipc } from \\"$lib/ipc\\";\\nlet platform = \\"unknown\\";\\nlet testResults = [];\\nif (typeof window !== \\"undefined\\" && window.tachikoma) {\\n  platform = window.tachikoma.platform;\\n}\\nasync function testIpc() {\\n  testResults = [\\"Testing IPC Bridge...\\"];\\n  try {\\n    const config = await ipc.invoke(\\"config:get\\", {});\\n    testResults = [...testResults, `\\\\u2713 Config loaded: ${config.backend.brain}`];\\n    const specs = await ipc.invoke(\\"spec:list\\", {});\\n    testResults = [...testResults, `\\\\u2713 Specs listed: ${specs.length} found`];\\n    const mission = await missionStore.start(\\"/test/path\\", \\"claude\\", \\"attended\\");\\n    testResults = [...testResults, `\\\\u2713 Mission started: ${mission}`];\\n    testResults = [...testResults, \\"\\\\u2705 All IPC tests passed!\\"];\\n  } catch (error) {\\n    testResults = [...testResults, `\\\\u274C Test failed: ${error}`];\\n  }\\n}\\n<\/script>\\n\\n<main>\\n  <h1>Tachikoma</h1>\\n  <p>Your squad of tireless AI coders</p>\\n  <p class=\\"platform\\">Running on: {platform}</p>\\n  \\n  <div class=\\"test-section\\">\\n    <button \\n      on:click={testIpc}\\n      class=\\"test-button\\"\\n    >\\n      Test IPC Bridge\\n    </button>\\n    \\n    {#if testResults.length > 0}\\n      <div class=\\"test-results\\">\\n        <h2>Test Results:</h2>\\n        {#each testResults as result}\\n          <div class=\\"test-result\\">{result}</div>\\n        {/each}\\n      </div>\\n    {/if}\\n    \\n    <div class=\\"mission-status\\">\\n      <h2>Mission Status</h2>\\n      <p>Running: {$isRunning}</p>\\n      <p>Progress: {$progress}%</p>\\n    </div>\\n  </div>\\n</main>\\n\\n<style>\\n  main {\\n    display: flex;\\n    flex-direction: column;\\n    align-items: center;\\n    justify-content: center;\\n    min-height: 100vh;\\n    font-family: system-ui, -apple-system, sans-serif;\\n    padding: 2rem;\\n  }\\n\\n  h1 {\\n    font-size: 3rem;\\n    margin-bottom: 0.5rem;\\n  }\\n\\n  .platform {\\n    color: var(--text-muted, #666);\\n    font-size: 0.875rem;\\n    margin-bottom: 2rem;\\n  }\\n\\n  .test-section {\\n    width: 100%;\\n    max-width: 600px;\\n  }\\n\\n  .test-button {\\n    background: #3b82f6;\\n    color: white;\\n    border: none;\\n    padding: 0.75rem 1.5rem;\\n    border-radius: 0.5rem;\\n    cursor: pointer;\\n    font-size: 1rem;\\n    margin-bottom: 1rem;\\n  }\\n\\n  .test-button:hover {\\n    background: #2563eb;\\n  }\\n\\n  .test-results {\\n    background: #f3f4f6;\\n    padding: 1rem;\\n    border-radius: 0.5rem;\\n    margin-bottom: 1rem;\\n  }\\n\\n  .test-results h2 {\\n    font-size: 1.25rem;\\n    margin-bottom: 0.5rem;\\n  }\\n\\n  .test-result {\\n    font-family: \'Monaco\', \'Courier New\', monospace;\\n    font-size: 0.875rem;\\n    margin-bottom: 0.25rem;\\n  }\\n\\n  .mission-status {\\n    background: #f9fafb;\\n    padding: 1rem;\\n    border-radius: 0.5rem;\\n  }\\n\\n  .mission-status h2 {\\n    font-size: 1.25rem;\\n    margin-bottom: 0.5rem;\\n  }\\n</style>"],"names":[],"mappings":"AAuDE,kCAAK,CACH,OAAO,CAAE,IAAI,CACb,cAAc,CAAE,MAAM,CACtB,WAAW,CAAE,MAAM,CACnB,eAAe,CAAE,MAAM,CACvB,UAAU,CAAE,KAAK,CACjB,WAAW,CAAE,SAAS,CAAC,CAAC,aAAa,CAAC,CAAC,UAAU,CACjD,OAAO,CAAE,IACX,CAEA,gCAAG,CACD,SAAS,CAAE,IAAI,CACf,aAAa,CAAE,MACjB,CAEA,uCAAU,CACR,KAAK,CAAE,IAAI,YAAY,CAAC,KAAK,CAAC,CAC9B,SAAS,CAAE,QAAQ,CACnB,aAAa,CAAE,IACjB,CAEA,2CAAc,CACZ,KAAK,CAAE,IAAI,CACX,SAAS,CAAE,KACb,CAEA,0CAAa,CACX,UAAU,CAAE,OAAO,CACnB,KAAK,CAAE,KAAK,CACZ,MAAM,CAAE,IAAI,CACZ,OAAO,CAAE,OAAO,CAAC,MAAM,CACvB,aAAa,CAAE,MAAM,CACrB,MAAM,CAAE,OAAO,CACf,SAAS,CAAE,IAAI,CACf,aAAa,CAAE,IACjB,CAEA,0CAAY,MAAO,CACjB,UAAU,CAAE,OACd,CAEA,2CAAc,CACZ,UAAU,CAAE,OAAO,CACnB,OAAO,CAAE,IAAI,CACb,aAAa,CAAE,MAAM,CACrB,aAAa,CAAE,IACjB,CAEA,4BAAa,CAAC,iBAAG,CACf,SAAS,CAAE,OAAO,CAClB,aAAa,CAAE,MACjB,CAEA,0CAAa,CACX,WAAW,CAAE,QAAQ,CAAC,CAAC,aAAa,CAAC,CAAC,SAAS,CAC/C,SAAS,CAAE,QAAQ,CACnB,aAAa,CAAE,OACjB,CAEA,6CAAgB,CACd,UAAU,CAAE,OAAO,CACnB,OAAO,CAAE,IAAI,CACb,aAAa,CAAE,MACjB,CAEA,8BAAe,CAAC,iBAAG,CACjB,SAAS,CAAE,OAAO,CAClB,aAAa,CAAE,MACjB"}'},R=v((s,t,e,n)=>{let r,o,A,i;o=u(B,a=>r=a),i=u(k,a=>A=a);let l="unknown",m=[];return typeof window<"u"&&window.tachikoma&&(l=window.tachikoma.platform),s.css.add(M),o(),i(),`<main class="svelte-1cj8r9l"><h1 class="svelte-1cj8r9l" data-svelte-h="svelte-3a5jxj">Tachikoma</h1> <p data-svelte-h="svelte-eyy3n3">Your squad of tireless AI coders</p> <p class="platform svelte-1cj8r9l">Running on: ${C(l)}</p> <div class="test-section svelte-1cj8r9l"><button class="test-button svelte-1cj8r9l" data-svelte-h="svelte-lndkln">Test IPC Bridge</button> ${m.length>0?`<div class="test-results svelte-1cj8r9l"><h2 class="svelte-1cj8r9l" data-svelte-h="svelte-138hrta">Test Results:</h2> ${h(m,a=>`<div class="test-result svelte-1cj8r9l">${C(a)}</div>`)}</div>`:""} <div class="mission-status svelte-1cj8r9l"><h2 class="svelte-1cj8r9l" data-svelte-h="svelte-11dwjby">Mission Status</h2> <p>Running: ${C(r)}</p> <p>Progress: ${C(A)}%</p></div></div> </main>`});export{R as default};
