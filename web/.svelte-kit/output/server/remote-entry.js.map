{"version":3,"file":"remote-entry.js","sources":["../../../node_modules/@sveltejs/kit/src/runtime/app/server/remote/shared.js","../../../node_modules/@sveltejs/kit/src/runtime/app/server/remote/command.js","../../../node_modules/@sveltejs/kit/src/runtime/app/server/remote/form.js","../../../node_modules/@sveltejs/kit/src/runtime/app/server/remote/prerender.js","../../../node_modules/@sveltejs/kit/src/runtime/app/server/remote/query.js"],"sourcesContent":["/** @import { RequestEvent } from '@sveltejs/kit' */\n/** @import { ServerHooks, MaybePromise, RequestState, RemoteInfo, RequestStore } from 'types' */\nimport { parse } from 'devalue';\nimport { error } from '@sveltejs/kit';\nimport { with_request_store, get_request_store } from '@sveltejs/kit/internal/server';\nimport { stringify_remote_arg } from '../../../shared.js';\n\n/**\n * @param {any} validate_or_fn\n * @param {(arg?: any) => any} [maybe_fn]\n * @returns {(arg?: any) => MaybePromise<any>}\n */\nexport function create_validator(validate_or_fn, maybe_fn) {\n\t// prevent functions without validators being called with arguments\n\tif (!maybe_fn) {\n\t\treturn (arg) => {\n\t\t\tif (arg !== undefined) {\n\t\t\t\terror(400, 'Bad Request');\n\t\t\t}\n\t\t};\n\t}\n\n\t// if 'unchecked', pass input through without validating\n\tif (validate_or_fn === 'unchecked') {\n\t\treturn (arg) => arg;\n\t}\n\n\t// use https://standardschema.dev validator if provided\n\tif ('~standard' in validate_or_fn) {\n\t\treturn async (arg) => {\n\t\t\t// Get event before async validation to ensure it's available in server environments without AsyncLocalStorage, too\n\t\t\tconst { event, state } = get_request_store();\n\t\t\t// access property and call method in one go to preserve potential this context\n\t\t\tconst result = await validate_or_fn['~standard'].validate(arg);\n\n\t\t\t// if the `issues` field exists, the validation failed\n\t\t\tif (result.issues) {\n\t\t\t\terror(\n\t\t\t\t\t400,\n\t\t\t\t\tawait state.handleValidationError({\n\t\t\t\t\t\tissues: result.issues,\n\t\t\t\t\t\tevent\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t}\n\n\t\t\treturn result.value;\n\t\t};\n\t}\n\n\tthrow new Error(\n\t\t'Invalid validator passed to remote function. Expected \"unchecked\" or a Standard Schema (https://standardschema.dev)'\n\t);\n}\n\n/**\n * In case of a single remote function call, just returns the result.\n *\n * In case of a full page reload, returns the response for a remote function call,\n * either from the cache or by invoking the function.\n * Also saves an uneval'ed version of the result for later HTML inlining for hydration.\n *\n * @template {MaybePromise<any>} T\n * @param {RemoteInfo} info\n * @param {any} arg\n * @param {RequestState} state\n * @param {() => Promise<T>} get_result\n * @returns {Promise<T>}\n */\nexport async function get_response(info, arg, state, get_result) {\n\t// wait a beat, in case `myQuery().set(...)` or `myQuery().refresh()` is immediately called\n\t// eslint-disable-next-line @typescript-eslint/await-thenable\n\tawait 0;\n\n\tconst cache = get_cache(info, state);\n\n\treturn (cache[stringify_remote_arg(arg, state.transport)] ??= get_result());\n}\n\n/**\n * @param {any} data\n * @param {ServerHooks['transport']} transport\n */\nexport function parse_remote_response(data, transport) {\n\t/** @type {Record<string, any>} */\n\tconst revivers = {};\n\tfor (const key in transport) {\n\t\trevivers[key] = transport[key].decode;\n\t}\n\n\treturn parse(data, revivers);\n}\n\n/**\n * Like `with_event` but removes things from `event` you cannot see/call in remote functions, such as `setHeaders`.\n * @template T\n * @param {RequestEvent} event\n * @param {RequestState} state\n * @param {boolean} allow_cookies\n * @param {any} arg\n * @param {(arg: any) => any} validate\n * @param {(arg?: any) => T} fn\n */\nexport async function run_remote_function(event, state, allow_cookies, arg, validate, fn) {\n\t/** @type {RequestStore} */\n\tconst store = {\n\t\tevent: {\n\t\t\t...event,\n\t\t\tsetHeaders: () => {\n\t\t\t\tthrow new Error('setHeaders is not allowed in remote functions');\n\t\t\t},\n\t\t\tcookies: {\n\t\t\t\t...event.cookies,\n\t\t\t\tset: (name, value, opts) => {\n\t\t\t\t\tif (!allow_cookies) {\n\t\t\t\t\t\tthrow new Error('Cannot set cookies in `query` or `prerender` functions');\n\t\t\t\t\t}\n\n\t\t\t\t\tif (opts.path && !opts.path.startsWith('/')) {\n\t\t\t\t\t\tthrow new Error('Cookies set in remote functions must have an absolute path');\n\t\t\t\t\t}\n\n\t\t\t\t\treturn event.cookies.set(name, value, opts);\n\t\t\t\t},\n\t\t\t\tdelete: (name, opts) => {\n\t\t\t\t\tif (!allow_cookies) {\n\t\t\t\t\t\tthrow new Error('Cannot delete cookies in `query` or `prerender` functions');\n\t\t\t\t\t}\n\n\t\t\t\t\tif (opts.path && !opts.path.startsWith('/')) {\n\t\t\t\t\t\tthrow new Error('Cookies deleted in remote functions must have an absolute path');\n\t\t\t\t\t}\n\n\t\t\t\t\treturn event.cookies.delete(name, opts);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tstate: {\n\t\t\t...state,\n\t\t\tis_in_remote_function: true\n\t\t}\n\t};\n\n\t// In two parts, each with_event, so that runtimes without async local storage can still get the event at the start of the function\n\tconst validated = await with_request_store(store, () => validate(arg));\n\treturn with_request_store(store, () => fn(validated));\n}\n\n/**\n * @param {RemoteInfo} info\n * @param {RequestState} state\n */\nexport function get_cache(info, state = get_request_store().state) {\n\tlet cache = state.remote_data?.get(info);\n\n\tif (cache === undefined) {\n\t\tcache = {};\n\t\t(state.remote_data ??= new Map()).set(info, cache);\n\t}\n\n\treturn cache;\n}\n","/** @import { RemoteCommand } from '@sveltejs/kit' */\n/** @import { RemoteInfo, MaybePromise } from 'types' */\n/** @import { StandardSchemaV1 } from '@standard-schema/spec' */\nimport { get_request_store } from '@sveltejs/kit/internal/server';\nimport { create_validator, run_remote_function } from './shared.js';\n\n/**\n * Creates a remote command. When called from the browser, the function will be invoked on the server via a `fetch` call.\n *\n * See [Remote functions](https://svelte.dev/docs/kit/remote-functions#command) for full documentation.\n *\n * @template Output\n * @overload\n * @param {() => Output} fn\n * @returns {RemoteCommand<void, Output>}\n * @since 2.27\n */\n/**\n * Creates a remote command. When called from the browser, the function will be invoked on the server via a `fetch` call.\n *\n * See [Remote functions](https://svelte.dev/docs/kit/remote-functions#command) for full documentation.\n *\n * @template Input\n * @template Output\n * @overload\n * @param {'unchecked'} validate\n * @param {(arg: Input) => Output} fn\n * @returns {RemoteCommand<Input, Output>}\n * @since 2.27\n */\n/**\n * Creates a remote command. When called from the browser, the function will be invoked on the server via a `fetch` call.\n *\n * See [Remote functions](https://svelte.dev/docs/kit/remote-functions#command) for full documentation.\n *\n * @template {StandardSchemaV1} Schema\n * @template Output\n * @overload\n * @param {Schema} validate\n * @param {(arg: StandardSchemaV1.InferOutput<Schema>) => Output} fn\n * @returns {RemoteCommand<StandardSchemaV1.InferInput<Schema>, Output>}\n * @since 2.27\n */\n/**\n * @template Input\n * @template Output\n * @param {any} validate_or_fn\n * @param {(arg?: Input) => Output} [maybe_fn]\n * @returns {RemoteCommand<Input, Output>}\n * @since 2.27\n */\n/*@__NO_SIDE_EFFECTS__*/\nexport function command(validate_or_fn, maybe_fn) {\n\t/** @type {(arg?: Input) => Output} */\n\tconst fn = maybe_fn ?? validate_or_fn;\n\n\t/** @type {(arg?: any) => MaybePromise<Input>} */\n\tconst validate = create_validator(validate_or_fn, maybe_fn);\n\n\t/** @type {RemoteInfo} */\n\tconst __ = { type: 'command', id: '', name: '' };\n\n\t/** @type {RemoteCommand<Input, Output> & { __: RemoteInfo }} */\n\tconst wrapper = (arg) => {\n\t\tconst { event, state } = get_request_store();\n\n\t\tif (state.is_endpoint_request) {\n\t\t\tif (!['POST', 'PUT', 'PATCH', 'DELETE'].includes(event.request.method)) {\n\t\t\t\tthrow new Error(\n\t\t\t\t\t`Cannot call a command (\\`${__.name}(${maybe_fn ? '...' : ''})\\`) from a ${event.request.method} handler`\n\t\t\t\t);\n\t\t\t}\n\t\t} else if (!event.isRemoteRequest) {\n\t\t\tthrow new Error(\n\t\t\t\t`Cannot call a command (\\`${__.name}(${maybe_fn ? '...' : ''})\\`) during server-side rendering`\n\t\t\t);\n\t\t}\n\n\t\tstate.refreshes ??= {};\n\n\t\tconst promise = Promise.resolve(run_remote_function(event, state, true, arg, validate, fn));\n\n\t\t// @ts-expect-error\n\t\tpromise.updates = () => {\n\t\t\tthrow new Error(`Cannot call '${__.name}(...).updates(...)' on the server`);\n\t\t};\n\n\t\treturn /** @type {ReturnType<RemoteCommand<Input, Output>>} */ (promise);\n\t};\n\n\tObject.defineProperty(wrapper, '__', { value: __ });\n\n\t// On the server, pending is always 0\n\tObject.defineProperty(wrapper, 'pending', {\n\t\tget: () => 0\n\t});\n\n\treturn wrapper;\n}\n","/** @import { RemoteFormInput, RemoteForm, InvalidField } from '@sveltejs/kit' */\n/** @import { InternalRemoteFormIssue, MaybePromise, RemoteInfo } from 'types' */\n/** @import { StandardSchemaV1 } from '@standard-schema/spec' */\nimport { get_request_store } from '@sveltejs/kit/internal/server';\nimport { DEV } from 'esm-env';\nimport {\n\tcreate_field_proxy,\n\tset_nested_value,\n\tthrow_on_old_property_access,\n\tdeep_set,\n\tnormalize_issue,\n\tflatten_issues\n} from '../../../form-utils.js';\nimport { get_cache, run_remote_function } from './shared.js';\nimport { ValidationError } from '@sveltejs/kit/internal';\n\n/**\n * Creates a form object that can be spread onto a `<form>` element.\n *\n * See [Remote functions](https://svelte.dev/docs/kit/remote-functions#form) for full documentation.\n *\n * @template Output\n * @overload\n * @param {() => MaybePromise<Output>} fn\n * @returns {RemoteForm<void, Output>}\n * @since 2.27\n */\n/**\n * Creates a form object that can be spread onto a `<form>` element.\n *\n * See [Remote functions](https://svelte.dev/docs/kit/remote-functions#form) for full documentation.\n *\n * @template {RemoteFormInput} Input\n * @template Output\n * @overload\n * @param {'unchecked'} validate\n * @param {(data: Input, issue: InvalidField<Input>) => MaybePromise<Output>} fn\n * @returns {RemoteForm<Input, Output>}\n * @since 2.27\n */\n/**\n * Creates a form object that can be spread onto a `<form>` element.\n *\n * See [Remote functions](https://svelte.dev/docs/kit/remote-functions#form) for full documentation.\n *\n * @template {StandardSchemaV1<RemoteFormInput, Record<string, any>>} Schema\n * @template Output\n * @overload\n * @param {Schema} validate\n * @param {(data: StandardSchemaV1.InferOutput<Schema>, issue: InvalidField<StandardSchemaV1.InferInput<Schema>>) => MaybePromise<Output>} fn\n * @returns {RemoteForm<StandardSchemaV1.InferInput<Schema>, Output>}\n * @since 2.27\n */\n/**\n * @template {RemoteFormInput} Input\n * @template Output\n * @param {any} validate_or_fn\n * @param {(data_or_issue: any, issue?: any) => MaybePromise<Output>} [maybe_fn]\n * @returns {RemoteForm<Input, Output>}\n * @since 2.27\n */\n/*@__NO_SIDE_EFFECTS__*/\n// @ts-ignore we don't want to prefix `fn` with an underscore, as that will be user-visible\nexport function form(validate_or_fn, maybe_fn) {\n\t/** @type {any} */\n\tconst fn = maybe_fn ?? validate_or_fn;\n\n\t/** @type {StandardSchemaV1 | null} */\n\tconst schema =\n\t\t!maybe_fn || validate_or_fn === 'unchecked' ? null : /** @type {any} */ (validate_or_fn);\n\n\t/**\n\t * @param {string | number | boolean} [key]\n\t */\n\tfunction create_instance(key) {\n\t\t/** @type {RemoteForm<Input, Output>} */\n\t\tconst instance = {};\n\n\t\tinstance.method = 'POST';\n\n\t\tObject.defineProperty(instance, 'enhance', {\n\t\t\tvalue: () => {\n\t\t\t\treturn { action: instance.action, method: instance.method };\n\t\t\t}\n\t\t});\n\n\t\tconst button_props = {\n\t\t\ttype: 'submit',\n\t\t\tonclick: () => {}\n\t\t};\n\n\t\tObject.defineProperty(button_props, 'enhance', {\n\t\t\tvalue: () => {\n\t\t\t\treturn { type: 'submit', formaction: instance.buttonProps.formaction, onclick: () => {} };\n\t\t\t}\n\t\t});\n\n\t\tObject.defineProperty(instance, 'buttonProps', {\n\t\t\tvalue: button_props\n\t\t});\n\n\t\t/** @type {RemoteInfo} */\n\t\tconst __ = {\n\t\t\ttype: 'form',\n\t\t\tname: '',\n\t\t\tid: '',\n\t\t\tfn: async (data, meta, form_data) => {\n\t\t\t\t// TODO 3.0 remove this warning\n\t\t\t\tif (DEV && !data) {\n\t\t\t\t\tconst error = () => {\n\t\t\t\t\t\tthrow new Error(\n\t\t\t\t\t\t\t'Remote form functions no longer get passed a FormData object. ' +\n\t\t\t\t\t\t\t\t\"`form` now has the same signature as `query` or `command`, i.e. it expects to be invoked like `form(schema, callback)` or `form('unchecked', callback)`. \" +\n\t\t\t\t\t\t\t\t'The payload of the callback function is now a POJO instead of a FormData object. See https://kit.svelte.dev/docs/remote-functions#form for details.'\n\t\t\t\t\t\t);\n\t\t\t\t\t};\n\t\t\t\t\tdata = {};\n\t\t\t\t\tfor (const key of [\n\t\t\t\t\t\t'append',\n\t\t\t\t\t\t'delete',\n\t\t\t\t\t\t'entries',\n\t\t\t\t\t\t'forEach',\n\t\t\t\t\t\t'get',\n\t\t\t\t\t\t'getAll',\n\t\t\t\t\t\t'has',\n\t\t\t\t\t\t'keys',\n\t\t\t\t\t\t'set',\n\t\t\t\t\t\t'values'\n\t\t\t\t\t]) {\n\t\t\t\t\t\tObject.defineProperty(data, key, { get: error });\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t/** @type {{ submission: true, input?: Record<string, any>, issues?: InternalRemoteFormIssue[], result: Output }} */\n\t\t\t\tconst output = {};\n\n\t\t\t\t// make it possible to differentiate between user submission and programmatic `field.set(...)` updates\n\t\t\t\toutput.submission = true;\n\n\t\t\t\tconst { event, state } = get_request_store();\n\t\t\t\tconst validated = await schema?.['~standard'].validate(data);\n\n\t\t\t\tif (meta.validate_only) {\n\t\t\t\t\treturn validated?.issues?.map((issue) => normalize_issue(issue, true)) ?? [];\n\t\t\t\t}\n\n\t\t\t\tif (validated?.issues !== undefined) {\n\t\t\t\t\thandle_issues(output, validated.issues, form_data);\n\t\t\t\t} else {\n\t\t\t\t\tif (validated !== undefined) {\n\t\t\t\t\t\tdata = validated.value;\n\t\t\t\t\t}\n\n\t\t\t\t\tstate.refreshes ??= {};\n\n\t\t\t\t\tconst issue = create_issues();\n\n\t\t\t\t\ttry {\n\t\t\t\t\t\toutput.result = await run_remote_function(\n\t\t\t\t\t\t\tevent,\n\t\t\t\t\t\t\tstate,\n\t\t\t\t\t\t\ttrue,\n\t\t\t\t\t\t\tdata,\n\t\t\t\t\t\t\t(d) => d,\n\t\t\t\t\t\t\t(data) => (!maybe_fn ? fn() : fn(data, issue))\n\t\t\t\t\t\t);\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\tif (e instanceof ValidationError) {\n\t\t\t\t\t\t\thandle_issues(output, e.issues, form_data);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthrow e;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// We don't need to care about args or deduplicating calls, because uneval results are only relevant in full page reloads\n\t\t\t\t// where only one form submission is active at the same time\n\t\t\t\tif (!event.isRemoteRequest) {\n\t\t\t\t\tget_cache(__, state)[''] ??= output;\n\t\t\t\t}\n\n\t\t\t\treturn output;\n\t\t\t}\n\t\t};\n\n\t\tObject.defineProperty(instance, '__', { value: __ });\n\n\t\tObject.defineProperty(instance, 'action', {\n\t\t\tget: () => `?/remote=${__.id}`,\n\t\t\tenumerable: true\n\t\t});\n\n\t\tObject.defineProperty(button_props, 'formaction', {\n\t\t\tget: () => `?/remote=${__.id}`,\n\t\t\tenumerable: true\n\t\t});\n\n\t\tObject.defineProperty(instance, 'fields', {\n\t\t\tget() {\n\t\t\t\tconst data = get_cache(__)?.[''];\n\t\t\t\tconst issues = flatten_issues(data?.issues ?? []);\n\n\t\t\t\treturn create_field_proxy(\n\t\t\t\t\t{},\n\t\t\t\t\t() => data?.input ?? {},\n\t\t\t\t\t(path, value) => {\n\t\t\t\t\t\tif (data?.submission) {\n\t\t\t\t\t\t\t// don't override a submission\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst input =\n\t\t\t\t\t\t\tpath.length === 0 ? value : deep_set(data?.input ?? {}, path.map(String), value);\n\n\t\t\t\t\t\t(get_cache(__)[''] ??= {}).input = input;\n\t\t\t\t\t},\n\t\t\t\t\t() => issues\n\t\t\t\t);\n\t\t\t}\n\t\t});\n\n\t\t// TODO 3.0 remove\n\t\tif (DEV) {\n\t\t\tthrow_on_old_property_access(instance);\n\t\t}\n\n\t\tObject.defineProperty(instance, 'result', {\n\t\t\tget() {\n\t\t\t\ttry {\n\t\t\t\t\treturn get_cache(__)?.['']?.result;\n\t\t\t\t} catch {\n\t\t\t\t\treturn undefined;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\t// On the server, pending is always 0\n\t\tObject.defineProperty(instance, 'pending', {\n\t\t\tget: () => 0\n\t\t});\n\n\t\t// On the server, buttonProps.pending is always 0\n\t\tObject.defineProperty(button_props, 'pending', {\n\t\t\tget: () => 0\n\t\t});\n\n\t\tObject.defineProperty(instance, 'preflight', {\n\t\t\t// preflight is a noop on the server\n\t\t\tvalue: () => instance\n\t\t});\n\n\t\tObject.defineProperty(instance, 'validate', {\n\t\t\tvalue: () => {\n\t\t\t\tthrow new Error('Cannot call validate() on the server');\n\t\t\t}\n\t\t});\n\n\t\tif (key == undefined) {\n\t\t\tObject.defineProperty(instance, 'for', {\n\t\t\t\t/** @type {RemoteForm<any, any>['for']} */\n\t\t\t\tvalue: (key) => {\n\t\t\t\t\tconst { state } = get_request_store();\n\t\t\t\t\tconst cache_key = __.id + '|' + JSON.stringify(key);\n\t\t\t\t\tlet instance = (state.form_instances ??= new Map()).get(cache_key);\n\n\t\t\t\t\tif (!instance) {\n\t\t\t\t\t\tinstance = create_instance(key);\n\t\t\t\t\t\tinstance.__.id = `${__.id}/${encodeURIComponent(JSON.stringify(key))}`;\n\t\t\t\t\t\tinstance.__.name = __.name;\n\n\t\t\t\t\t\tstate.form_instances.set(cache_key, instance);\n\t\t\t\t\t}\n\n\t\t\t\t\treturn instance;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\treturn instance;\n\t}\n\n\treturn create_instance();\n}\n\n/**\n * @param {{ issues?: InternalRemoteFormIssue[], input?: Record<string, any>, result: any }} output\n * @param {readonly StandardSchemaV1.Issue[]} issues\n * @param {FormData | null} form_data - null if the form is progressively enhanced\n */\nfunction handle_issues(output, issues, form_data) {\n\toutput.issues = issues.map((issue) => normalize_issue(issue, true));\n\n\t// if it was a progressively-enhanced submission, we don't need\n\t// to return the input â€” it's already there\n\tif (form_data) {\n\t\toutput.input = {};\n\n\t\tfor (let key of form_data.keys()) {\n\t\t\t// redact sensitive fields\n\t\t\tif (/^[.\\]]?_/.test(key)) continue;\n\n\t\t\tconst is_array = key.endsWith('[]');\n\t\t\tconst values = form_data.getAll(key).filter((value) => typeof value === 'string');\n\n\t\t\tif (is_array) key = key.slice(0, -2);\n\n\t\t\tset_nested_value(\n\t\t\t\t/** @type {Record<string, any>} */ (output.input),\n\t\t\t\tkey,\n\t\t\t\tis_array ? values : values[0]\n\t\t\t);\n\t\t}\n\t}\n}\n\n/**\n * Creates an invalid function that can be used to imperatively mark form fields as invalid\n * @returns {InvalidField<any>}\n */\nfunction create_issues() {\n\treturn /** @type {InvalidField<any>} */ (\n\t\tnew Proxy(\n\t\t\t/** @param {string} message */\n\t\t\t(message) => {\n\t\t\t\t// TODO 3.0 remove\n\t\t\t\tif (typeof message !== 'string') {\n\t\t\t\t\tthrow new Error(\n\t\t\t\t\t\t'`invalid` should now be imported from `@sveltejs/kit` to throw validation issues. ' +\n\t\t\t\t\t\t\t\"The second parameter provided to the form function (renamed to `issue`) is still used to construct issues, e.g. `invalid(issue.field('message'))`. \" +\n\t\t\t\t\t\t\t'For more info see https://github.com/sveltejs/kit/pulls/14768'\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\treturn create_issue(message);\n\t\t\t},\n\t\t\t{\n\t\t\t\tget(target, prop) {\n\t\t\t\t\tif (typeof prop === 'symbol') return /** @type {any} */ (target)[prop];\n\n\t\t\t\t\treturn create_issue_proxy(prop, []);\n\t\t\t\t}\n\t\t\t}\n\t\t)\n\t);\n\n\t/**\n\t * @param {string} message\n\t * @param {(string | number)[]} path\n\t * @returns {StandardSchemaV1.Issue}\n\t */\n\tfunction create_issue(message, path = []) {\n\t\treturn {\n\t\t\tmessage,\n\t\t\tpath\n\t\t};\n\t}\n\n\t/**\n\t * Creates a proxy that builds up a path and returns a function to create an issue\n\t * @param {string | number} key\n\t * @param {(string | number)[]} path\n\t */\n\tfunction create_issue_proxy(key, path) {\n\t\tconst new_path = [...path, key];\n\n\t\t/**\n\t\t * @param {string} message\n\t\t * @returns {StandardSchemaV1.Issue}\n\t\t */\n\t\tconst issue_func = (message) => create_issue(message, new_path);\n\n\t\treturn new Proxy(issue_func, {\n\t\t\tget(target, prop) {\n\t\t\t\tif (typeof prop === 'symbol') return /** @type {any} */ (target)[prop];\n\n\t\t\t\t// Handle array access like invalid.items[0]\n\t\t\t\tif (/^\\d+$/.test(prop)) {\n\t\t\t\t\treturn create_issue_proxy(parseInt(prop, 10), new_path);\n\t\t\t\t}\n\n\t\t\t\t// Handle property access like invalid.field.nested\n\t\t\t\treturn create_issue_proxy(prop, new_path);\n\t\t\t}\n\t\t});\n\t}\n}\n","/** @import { RemoteResource, RemotePrerenderFunction } from '@sveltejs/kit' */\n/** @import { RemotePrerenderInputsGenerator, RemoteInfo, MaybePromise } from 'types' */\n/** @import { StandardSchemaV1 } from '@standard-schema/spec' */\nimport { error, json } from '@sveltejs/kit';\nimport { DEV } from 'esm-env';\nimport { get_request_store } from '@sveltejs/kit/internal/server';\nimport { stringify, stringify_remote_arg } from '../../../shared.js';\nimport { app_dir, base } from '$app/paths/internal/server';\nimport {\n\tcreate_validator,\n\tget_cache,\n\tget_response,\n\tparse_remote_response,\n\trun_remote_function\n} from './shared.js';\n\n/**\n * Creates a remote prerender function. When called from the browser, the function will be invoked on the server via a `fetch` call.\n *\n * See [Remote functions](https://svelte.dev/docs/kit/remote-functions#prerender) for full documentation.\n *\n * @template Output\n * @overload\n * @param {() => MaybePromise<Output>} fn\n * @param {{ inputs?: RemotePrerenderInputsGenerator<void>, dynamic?: boolean }} [options]\n * @returns {RemotePrerenderFunction<void, Output>}\n * @since 2.27\n */\n/**\n * Creates a remote prerender function. When called from the browser, the function will be invoked on the server via a `fetch` call.\n *\n * See [Remote functions](https://svelte.dev/docs/kit/remote-functions#prerender) for full documentation.\n *\n * @template Input\n * @template Output\n * @overload\n * @param {'unchecked'} validate\n * @param {(arg: Input) => MaybePromise<Output>} fn\n * @param {{ inputs?: RemotePrerenderInputsGenerator<Input>, dynamic?: boolean }} [options]\n * @returns {RemotePrerenderFunction<Input, Output>}\n * @since 2.27\n */\n/**\n * Creates a remote prerender function. When called from the browser, the function will be invoked on the server via a `fetch` call.\n *\n * See [Remote functions](https://svelte.dev/docs/kit/remote-functions#prerender) for full documentation.\n *\n * @template {StandardSchemaV1} Schema\n * @template Output\n * @overload\n * @param {Schema} schema\n * @param {(arg: StandardSchemaV1.InferOutput<Schema>) => MaybePromise<Output>} fn\n * @param {{ inputs?: RemotePrerenderInputsGenerator<StandardSchemaV1.InferInput<Schema>>, dynamic?: boolean }} [options]\n * @returns {RemotePrerenderFunction<StandardSchemaV1.InferInput<Schema>, Output>}\n * @since 2.27\n */\n/**\n * @template Input\n * @template Output\n * @param {any} validate_or_fn\n * @param {any} [fn_or_options]\n * @param {{ inputs?: RemotePrerenderInputsGenerator<Input>, dynamic?: boolean }} [maybe_options]\n * @returns {RemotePrerenderFunction<Input, Output>}\n * @since 2.27\n */\n/*@__NO_SIDE_EFFECTS__*/\nexport function prerender(validate_or_fn, fn_or_options, maybe_options) {\n\tconst maybe_fn = typeof fn_or_options === 'function' ? fn_or_options : undefined;\n\n\t/** @type {typeof maybe_options} */\n\tconst options = maybe_options ?? (maybe_fn ? undefined : fn_or_options);\n\n\t/** @type {(arg?: Input) => MaybePromise<Output>} */\n\tconst fn = maybe_fn ?? validate_or_fn;\n\n\t/** @type {(arg?: any) => MaybePromise<Input>} */\n\tconst validate = create_validator(validate_or_fn, maybe_fn);\n\n\t/** @type {RemoteInfo} */\n\tconst __ = {\n\t\ttype: 'prerender',\n\t\tid: '',\n\t\tname: '',\n\t\thas_arg: !!maybe_fn,\n\t\tinputs: options?.inputs,\n\t\tdynamic: options?.dynamic\n\t};\n\n\t/** @type {RemotePrerenderFunction<Input, Output> & { __: RemoteInfo }} */\n\tconst wrapper = (arg) => {\n\t\t/** @type {Promise<Output> & Partial<RemoteResource<Output>>} */\n\t\tconst promise = (async () => {\n\t\t\tconst { event, state } = get_request_store();\n\t\t\tconst payload = stringify_remote_arg(arg, state.transport);\n\t\t\tconst id = __.id;\n\t\t\tconst url = `${base}/${app_dir}/remote/${id}${payload ? `/${payload}` : ''}`;\n\n\t\t\tif (!state.prerendering && !DEV && !event.isRemoteRequest) {\n\t\t\t\ttry {\n\t\t\t\t\treturn await get_response(__, arg, state, async () => {\n\t\t\t\t\t\tconst key = stringify_remote_arg(arg, state.transport);\n\t\t\t\t\t\tconst cache = get_cache(__, state);\n\n\t\t\t\t\t\t// TODO adapters can provide prerendered data more efficiently than\n\t\t\t\t\t\t// fetching from the public internet\n\t\t\t\t\t\tconst promise = (cache[key] ??= fetch(new URL(url, event.url.origin).href).then(\n\t\t\t\t\t\t\tasync (response) => {\n\t\t\t\t\t\t\t\tif (!response.ok) {\n\t\t\t\t\t\t\t\t\tthrow new Error('Prerendered response not found');\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tconst prerendered = await response.json();\n\n\t\t\t\t\t\t\t\tif (prerendered.type === 'error') {\n\t\t\t\t\t\t\t\t\terror(prerendered.status, prerendered.error);\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\treturn prerendered.result;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t));\n\n\t\t\t\t\t\treturn parse_remote_response(await promise, state.transport);\n\t\t\t\t\t});\n\t\t\t\t} catch {\n\t\t\t\t\t// not available prerendered, fallback to normal function\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (state.prerendering?.remote_responses.has(url)) {\n\t\t\t\treturn /** @type {Promise<any>} */ (state.prerendering.remote_responses.get(url));\n\t\t\t}\n\n\t\t\tconst promise = get_response(__, arg, state, () =>\n\t\t\t\trun_remote_function(event, state, false, arg, validate, fn)\n\t\t\t);\n\n\t\t\tif (state.prerendering) {\n\t\t\t\tstate.prerendering.remote_responses.set(url, promise);\n\t\t\t}\n\n\t\t\tconst result = await promise;\n\n\t\t\tif (state.prerendering) {\n\t\t\t\tconst body = { type: 'result', result: stringify(result, state.transport) };\n\t\t\t\tstate.prerendering.dependencies.set(url, {\n\t\t\t\t\tbody: JSON.stringify(body),\n\t\t\t\t\tresponse: json(body)\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t// TODO this is missing error/loading/current/status\n\t\t\treturn result;\n\t\t})();\n\n\t\tpromise.catch(() => {});\n\n\t\treturn /** @type {RemoteResource<Output>} */ (promise);\n\t};\n\n\tObject.defineProperty(wrapper, '__', { value: __ });\n\n\treturn wrapper;\n}\n","/** @import { RemoteQuery, RemoteQueryFunction } from '@sveltejs/kit' */\n/** @import { RemoteInfo, MaybePromise } from 'types' */\n/** @import { StandardSchemaV1 } from '@standard-schema/spec' */\nimport { get_request_store } from '@sveltejs/kit/internal/server';\nimport { create_remote_key, stringify_remote_arg } from '../../../shared.js';\nimport { prerendering } from '__sveltekit/environment';\nimport { create_validator, get_cache, get_response, run_remote_function } from './shared.js';\n\n/**\n * Creates a remote query. When called from the browser, the function will be invoked on the server via a `fetch` call.\n *\n * See [Remote functions](https://svelte.dev/docs/kit/remote-functions#query) for full documentation.\n *\n * @template Output\n * @overload\n * @param {() => MaybePromise<Output>} fn\n * @returns {RemoteQueryFunction<void, Output>}\n * @since 2.27\n */\n/**\n * Creates a remote query. When called from the browser, the function will be invoked on the server via a `fetch` call.\n *\n * See [Remote functions](https://svelte.dev/docs/kit/remote-functions#query) for full documentation.\n *\n * @template Input\n * @template Output\n * @overload\n * @param {'unchecked'} validate\n * @param {(arg: Input) => MaybePromise<Output>} fn\n * @returns {RemoteQueryFunction<Input, Output>}\n * @since 2.27\n */\n/**\n * Creates a remote query. When called from the browser, the function will be invoked on the server via a `fetch` call.\n *\n * See [Remote functions](https://svelte.dev/docs/kit/remote-functions#query) for full documentation.\n *\n * @template {StandardSchemaV1} Schema\n * @template Output\n * @overload\n * @param {Schema} schema\n * @param {(arg: StandardSchemaV1.InferOutput<Schema>) => MaybePromise<Output>} fn\n * @returns {RemoteQueryFunction<StandardSchemaV1.InferInput<Schema>, Output>}\n * @since 2.27\n */\n/**\n * @template Input\n * @template Output\n * @param {any} validate_or_fn\n * @param {(args?: Input) => MaybePromise<Output>} [maybe_fn]\n * @returns {RemoteQueryFunction<Input, Output>}\n * @since 2.27\n */\n/*@__NO_SIDE_EFFECTS__*/\nexport function query(validate_or_fn, maybe_fn) {\n\t/** @type {(arg?: Input) => Output} */\n\tconst fn = maybe_fn ?? validate_or_fn;\n\n\t/** @type {(arg?: any) => MaybePromise<Input>} */\n\tconst validate = create_validator(validate_or_fn, maybe_fn);\n\n\t/** @type {RemoteInfo} */\n\tconst __ = { type: 'query', id: '', name: '' };\n\n\t/** @type {RemoteQueryFunction<Input, Output> & { __: RemoteInfo }} */\n\tconst wrapper = (arg) => {\n\t\tif (prerendering) {\n\t\t\tthrow new Error(\n\t\t\t\t`Cannot call query '${__.name}' while prerendering, as prerendered pages need static data. Use 'prerender' from $app/server instead`\n\t\t\t);\n\t\t}\n\n\t\tconst { event, state } = get_request_store();\n\n\t\tconst get_remote_function_result = () =>\n\t\t\trun_remote_function(event, state, false, arg, validate, fn);\n\n\t\t/** @type {Promise<any> & Partial<RemoteQuery<any>>} */\n\t\tconst promise = get_response(__, arg, state, get_remote_function_result);\n\n\t\tpromise.catch(() => {});\n\n\t\tpromise.set = (value) => update_refresh_value(get_refresh_context(__, 'set', arg), value);\n\n\t\tpromise.refresh = () => {\n\t\t\tconst refresh_context = get_refresh_context(__, 'refresh', arg);\n\t\t\tconst is_immediate_refresh = !refresh_context.cache[refresh_context.cache_key];\n\t\t\tconst value = is_immediate_refresh ? promise : get_remote_function_result();\n\t\t\treturn update_refresh_value(refresh_context, value, is_immediate_refresh);\n\t\t};\n\n\t\tpromise.withOverride = () => {\n\t\t\tthrow new Error(`Cannot call '${__.name}.withOverride()' on the server`);\n\t\t};\n\n\t\treturn /** @type {RemoteQuery<Output>} */ (promise);\n\t};\n\n\tObject.defineProperty(wrapper, '__', { value: __ });\n\n\treturn wrapper;\n}\n\n/**\n * Creates a batch query function that collects multiple calls and executes them in a single request\n *\n * See [Remote functions](https://svelte.dev/docs/kit/remote-functions#query.batch) for full documentation.\n *\n * @template Input\n * @template Output\n * @overload\n * @param {'unchecked'} validate\n * @param {(args: Input[]) => MaybePromise<(arg: Input, idx: number) => Output>} fn\n * @returns {RemoteQueryFunction<Input, Output>}\n * @since 2.35\n */\n/**\n * Creates a batch query function that collects multiple calls and executes them in a single request\n *\n * See [Remote functions](https://svelte.dev/docs/kit/remote-functions#query.batch) for full documentation.\n *\n * @template {StandardSchemaV1} Schema\n * @template Output\n * @overload\n * @param {Schema} schema\n * @param {(args: StandardSchemaV1.InferOutput<Schema>[]) => MaybePromise<(arg: StandardSchemaV1.InferOutput<Schema>, idx: number) => Output>} fn\n * @returns {RemoteQueryFunction<StandardSchemaV1.InferInput<Schema>, Output>}\n * @since 2.35\n */\n/**\n * @template Input\n * @template Output\n * @param {any} validate_or_fn\n * @param {(args?: Input[]) => MaybePromise<(arg: Input, idx: number) => Output>} [maybe_fn]\n * @returns {RemoteQueryFunction<Input, Output>}\n * @since 2.35\n */\n/*@__NO_SIDE_EFFECTS__*/\nfunction batch(validate_or_fn, maybe_fn) {\n\t/** @type {(args?: Input[]) => (arg: Input, idx: number) => Output} */\n\tconst fn = maybe_fn ?? validate_or_fn;\n\n\t/** @type {(arg?: any) => MaybePromise<Input>} */\n\tconst validate = create_validator(validate_or_fn, maybe_fn);\n\n\t/** @type {RemoteInfo & { type: 'query_batch' }} */\n\tconst __ = {\n\t\ttype: 'query_batch',\n\t\tid: '',\n\t\tname: '',\n\t\trun: (args) => {\n\t\t\tconst { event, state } = get_request_store();\n\n\t\t\treturn run_remote_function(\n\t\t\t\tevent,\n\t\t\t\tstate,\n\t\t\t\tfalse,\n\t\t\t\targs,\n\t\t\t\t(array) => Promise.all(array.map(validate)),\n\t\t\t\tfn\n\t\t\t);\n\t\t}\n\t};\n\n\t/** @type {{ args: any[], resolvers: Array<{resolve: (value: any) => void, reject: (error: any) => void}> }} */\n\tlet batching = { args: [], resolvers: [] };\n\n\t/** @type {RemoteQueryFunction<Input, Output> & { __: RemoteInfo }} */\n\tconst wrapper = (arg) => {\n\t\tif (prerendering) {\n\t\t\tthrow new Error(\n\t\t\t\t`Cannot call query.batch '${__.name}' while prerendering, as prerendered pages need static data. Use 'prerender' from $app/server instead`\n\t\t\t);\n\t\t}\n\n\t\tconst { event, state } = get_request_store();\n\n\t\tconst get_remote_function_result = () => {\n\t\t\t// Collect all the calls to the same query in the same macrotask,\n\t\t\t// then execute them as one backend request.\n\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t// We don't need to deduplicate args here, because get_response already caches/reuses identical calls\n\t\t\t\tbatching.args.push(arg);\n\t\t\t\tbatching.resolvers.push({ resolve, reject });\n\n\t\t\t\tif (batching.args.length > 1) return;\n\n\t\t\t\tsetTimeout(async () => {\n\t\t\t\t\tconst batched = batching;\n\t\t\t\t\tbatching = { args: [], resolvers: [] };\n\n\t\t\t\t\ttry {\n\t\t\t\t\t\tconst get_result = await run_remote_function(\n\t\t\t\t\t\t\tevent,\n\t\t\t\t\t\t\tstate,\n\t\t\t\t\t\t\tfalse,\n\t\t\t\t\t\t\tbatched.args,\n\t\t\t\t\t\t\t(array) => Promise.all(array.map(validate)),\n\t\t\t\t\t\t\tfn\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tfor (let i = 0; i < batched.resolvers.length; i++) {\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\tbatched.resolvers[i].resolve(get_result(batched.args[i], i));\n\t\t\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\t\t\tbatched.resolvers[i].reject(error);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\tfor (const resolver of batched.resolvers) {\n\t\t\t\t\t\t\tresolver.reject(error);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}, 0);\n\t\t\t});\n\t\t};\n\n\t\t/** @type {Promise<any> & Partial<RemoteQuery<any>>} */\n\t\tconst promise = get_response(__, arg, state, get_remote_function_result);\n\n\t\tpromise.catch(() => {});\n\n\t\tpromise.set = (value) => update_refresh_value(get_refresh_context(__, 'set', arg), value);\n\n\t\tpromise.refresh = () => {\n\t\t\tconst refresh_context = get_refresh_context(__, 'refresh', arg);\n\t\t\tconst is_immediate_refresh = !refresh_context.cache[refresh_context.cache_key];\n\t\t\tconst value = is_immediate_refresh ? promise : get_remote_function_result();\n\t\t\treturn update_refresh_value(refresh_context, value, is_immediate_refresh);\n\t\t};\n\n\t\tpromise.withOverride = () => {\n\t\t\tthrow new Error(`Cannot call '${__.name}.withOverride()' on the server`);\n\t\t};\n\n\t\treturn /** @type {RemoteQuery<Output>} */ (promise);\n\t};\n\n\tObject.defineProperty(wrapper, '__', { value: __ });\n\n\treturn wrapper;\n}\n\n// Add batch as a property to the query function\nObject.defineProperty(query, 'batch', { value: batch, enumerable: true });\n\n/**\n * @param {RemoteInfo} __\n * @param {'set' | 'refresh'} action\n * @param {any} [arg]\n * @returns {{ __: RemoteInfo; state: any; refreshes: Record<string, Promise<any>>; cache: Record<string, Promise<any>>; refreshes_key: string; cache_key: string }}\n */\nfunction get_refresh_context(__, action, arg) {\n\tconst { state } = get_request_store();\n\tconst { refreshes } = state;\n\n\tif (!refreshes) {\n\t\tconst name = __.type === 'query_batch' ? `query.batch '${__.name}'` : `query '${__.name}'`;\n\t\tthrow new Error(\n\t\t\t`Cannot call ${action} on ${name} because it is not executed in the context of a command/form remote function`\n\t\t);\n\t}\n\n\tconst cache = get_cache(__, state);\n\tconst cache_key = stringify_remote_arg(arg, state.transport);\n\tconst refreshes_key = create_remote_key(__.id, cache_key);\n\n\treturn { __, state, refreshes, refreshes_key, cache, cache_key };\n}\n\n/**\n * @param {{ __: RemoteInfo; refreshes: Record<string, Promise<any>>; cache: Record<string, Promise<any>>; refreshes_key: string; cache_key: string }} context\n * @param {any} value\n * @param {boolean} [is_immediate_refresh=false]\n * @returns {Promise<void>}\n */\nfunction update_refresh_value(\n\t{ __, refreshes, refreshes_key, cache, cache_key },\n\tvalue,\n\tis_immediate_refresh = false\n) {\n\tconst promise = Promise.resolve(value);\n\n\tif (!is_immediate_refresh) {\n\t\tcache[cache_key] = promise;\n\t}\n\n\tif (__.id) {\n\t\trefreshes[refreshes_key] = promise;\n\t}\n\n\treturn promise.then(() => {});\n}\n"],"names":["create_validator","validate_or_fn","maybe_fn","arg","error","event","state","get_request_store","result","get_response","info","get_result","cache","get_cache","stringify_remote_arg","parse_remote_response","data","transport","revivers","key","parse","run_remote_function","allow_cookies","validate","fn","store","name","value","opts","validated","with_request_store","command","__","wrapper","promise","form","schema","create_instance","instance","button_props","meta","form_data","output","issue","normalize_issue","handle_issues","create_issues","d","e","ValidationError","issues","flatten_issues","create_field_proxy","path","input","deep_set","cache_key","is_array","values","set_nested_value","message","create_issue","target","prop","create_issue_proxy","new_path","issue_func","prerender","fn_or_options","maybe_options","options","payload","id","url","base","app_dir","DEV","response","prerendered","body","stringify","json","query","prerendering","get_remote_function_result","update_refresh_value","get_refresh_context","refresh_context","is_immediate_refresh","batch","args","array","batching","resolve","reject","batched","i","resolver","action","refreshes","refreshes_key","create_remote_key"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4]}