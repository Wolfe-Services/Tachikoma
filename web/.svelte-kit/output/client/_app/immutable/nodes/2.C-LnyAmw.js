import{M as it,S as ct,b as ut,s as dt,n as tt,d as v,c as N,e as K,f as c,N as ft,y as w,g as h,h as y,O as M,k as I,j as E,l as p,m as b,t as j,o as et,Q as st,R as ht}from"../chunks/Bt7hakvE.js";import"../chunks/CjDKn7ff.js";import{d as at,w as pt}from"../chunks/fMzpNvnw.js";class gt extends Error{constructor(t,e,o){super(t),this.channel=e,this.originalError=o,this.name="IpcError"}}function mt(n,t){const e=t instanceof Error?t.message:String(t);return console.error(`IPC Error on channel '${n}':`,t),new gt(`IPC call failed: ${e}`,n,t)}function nt(){return typeof window<"u"&&!!window.tachikoma}class vt{listeners=new Map;async invoke(t,e){if(!nt())throw new Error("Tachikoma IPC not available");try{return window.tachikoma.invoke(t,e)}catch(o){throw mt(t,o)}}on(t,e){return nt()?(this.listeners.has(t)||this.listeners.set(t,new Set),this.listeners.get(t).add(e),window.tachikoma.on(t,e),()=>{this.listeners.get(t)?.delete(e),window.tachikoma.off(t,e)}):()=>{}}}const D=new vt;function _t(){const{subscribe:n,set:t,update:e}=pt({current:null,logs:[],loading:!1,error:null});return{subscribe:n,async start(o,u,l){e(s=>({...s,loading:!0,error:null}));try{const{missionId:s}=await D.invoke("mission:start",{specPath:o,backend:u,mode:l}),r=await D.invoke("mission:status",{missionId:s});return e(a=>({...a,current:r,loading:!1})),s}catch(s){throw e(r=>({...r,loading:!1,error:String(s)})),s}},async stop(){const o=it({subscribe:n});o.current&&(await D.invoke("mission:stop",{missionId:o.current.id}),e(u=>({...u,current:null})))},addLog(o,u){e(l=>({...l,logs:[...l.logs.slice(-99),{level:o,message:u,timestamp:new Date}]}))},clear(){t({current:null,logs:[],loading:!1,error:null})}}}const W=_t(),wt=at(W,n=>n.current?.state==="running"),Ct=at(W,n=>n.current?.progress??0);function lt(n,t,e){const o=n.slice();return o[5]=t[e],o}function rt(n){let t,e,o="Test Results:",u,l=st(n[1]),s=[];for(let r=0;r<l.length;r+=1)s[r]=ot(lt(n,l,r));return{c(){t=p("div"),e=p("h2"),e.textContent=o,u=b();for(let r=0;r<s.length;r+=1)s[r].c();this.h()},l(r){t=h(r,"DIV",{class:!0});var a=y(t);e=h(a,"H2",{class:!0,"data-svelte-h":!0}),M(e)!=="svelte-138hrta"&&(e.textContent=o),u=I(a);for(let i=0;i<s.length;i+=1)s[i].l(a);a.forEach(v),this.h()},h(){w(e,"class","svelte-1cj8r9l"),w(t,"class","test-results svelte-1cj8r9l")},m(r,a){K(r,t,a),c(t,e),c(t,u);for(let i=0;i<s.length;i+=1)s[i]&&s[i].m(t,null)},p(r,a){if(a&2){l=st(r[1]);let i;for(i=0;i<l.length;i+=1){const C=lt(r,l,i);s[i]?s[i].p(C,a):(s[i]=ot(C),s[i].c(),s[i].m(t,null))}for(;i<s.length;i+=1)s[i].d(1);s.length=l.length}},d(r){r&&v(t),ht(s,r)}}}function ot(n){let t,e=n[5]+"",o;return{c(){t=p("div"),o=j(e),this.h()},l(u){t=h(u,"DIV",{class:!0});var l=y(t);o=E(l,e),l.forEach(v),this.h()},h(){w(t,"class","test-result svelte-1cj8r9l")},m(u,l){K(u,t,l),c(t,o)},p(u,l){l&2&&e!==(e=u[5]+"")&&N(o,e)},d(u){u&&v(t)}}}function kt(n){let t,e,o="Tachikoma",u,l,s="Your squad of tireless AI coders",r,a,i,C,q,m,k,X="Test IPC Bridge",O,A,_,P,Z="Mission Status",L,R,Q,V,U,x,Y,B,z,F,$,d=n[1].length>0&&rt(n);return{c(){t=p("main"),e=p("h1"),e.textContent=o,u=b(),l=p("p"),l.textContent=s,r=b(),a=p("p"),i=j("Running on: "),C=j(n[0]),q=b(),m=p("div"),k=p("button"),k.textContent=X,O=b(),d&&d.c(),A=b(),_=p("div"),P=p("h2"),P.textContent=Z,L=b(),R=p("p"),Q=j("Running: "),V=j(n[2]),U=b(),x=p("p"),Y=j("Progress: "),B=j(n[3]),z=j("%"),this.h()},l(g){t=h(g,"MAIN",{class:!0});var f=y(t);e=h(f,"H1",{class:!0,"data-svelte-h":!0}),M(e)!=="svelte-3a5jxj"&&(e.textContent=o),u=I(f),l=h(f,"P",{"data-svelte-h":!0}),M(l)!=="svelte-eyy3n3"&&(l.textContent=s),r=I(f),a=h(f,"P",{class:!0});var G=y(a);i=E(G,"Running on: "),C=E(G,n[0]),G.forEach(v),q=I(f),m=h(f,"DIV",{class:!0});var S=y(m);k=h(S,"BUTTON",{class:!0,"data-svelte-h":!0}),M(k)!=="svelte-lndkln"&&(k.textContent=X),O=I(S),d&&d.l(S),A=I(S),_=h(S,"DIV",{class:!0});var T=y(_);P=h(T,"H2",{class:!0,"data-svelte-h":!0}),M(P)!=="svelte-11dwjby"&&(P.textContent=Z),L=I(T),R=h(T,"P",{});var J=y(R);Q=E(J,"Running: "),V=E(J,n[2]),J.forEach(v),U=I(T),x=h(T,"P",{});var H=y(x);Y=E(H,"Progress: "),B=E(H,n[3]),z=E(H,"%"),H.forEach(v),T.forEach(v),S.forEach(v),f.forEach(v),this.h()},h(){w(e,"class","svelte-1cj8r9l"),w(a,"class","platform svelte-1cj8r9l"),w(k,"class","test-button svelte-1cj8r9l"),w(P,"class","svelte-1cj8r9l"),w(_,"class","mission-status svelte-1cj8r9l"),w(m,"class","test-section svelte-1cj8r9l"),w(t,"class","svelte-1cj8r9l")},m(g,f){K(g,t,f),c(t,e),c(t,u),c(t,l),c(t,r),c(t,a),c(a,i),c(a,C),c(t,q),c(t,m),c(m,k),c(m,O),d&&d.m(m,null),c(m,A),c(m,_),c(_,P),c(_,L),c(_,R),c(R,Q),c(R,V),c(_,U),c(_,x),c(x,Y),c(x,B),c(x,z),F||($=ft(k,"click",n[4]),F=!0)},p(g,[f]){f&1&&N(C,g[0]),g[1].length>0?d?d.p(g,f):(d=rt(g),d.c(),d.m(m,A)):d&&(d.d(1),d=null),f&4&&N(V,g[2]),f&8&&N(B,g[3])},i:tt,o:tt,d(g){g&&v(t),d&&d.d(),F=!1,$()}}}function It(n,t,e){let o,u;et(n,wt,a=>e(2,o=a)),et(n,Ct,a=>e(3,u=a));let l="unknown",s=[];typeof window<"u"&&window.tachikoma&&(l=window.tachikoma.platform);async function r(){e(1,s=["Testing IPC Bridge..."]);try{const a=await D.invoke("config:get",{});e(1,s=[...s,`✓ Config loaded: ${a.backend.brain}`]);const i=await D.invoke("spec:list",{});e(1,s=[...s,`✓ Specs listed: ${i.length} found`]);const C=await W.start("/test/path","claude","attended");e(1,s=[...s,`✓ Mission started: ${C}`]),e(1,s=[...s,"✅ All IPC tests passed!"])}catch(a){e(1,s=[...s,`❌ Test failed: ${a}`])}}return[l,s,o,u,r]}class yt extends ct{constructor(t){super(),ut(this,t,It,kt,dt,{})}}export{yt as component};
//# sourceMappingURL=2.C-LnyAmw.js.map
